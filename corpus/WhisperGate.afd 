{"namespace":"flow-1","canvas":{"cameraX":1244,"cameraY":9319,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"1","type":"action","x0":1241,"y0":56,"x1":1635,"y1":360,"payload":{"name":"T1078 Valid Accounts","description":"Cisco assesses that the attackers gained initial access through stolen credentials and likely had access to the victim's network for months ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1078/\" \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"2","type":"asset","x0":1320,"y0":491,"x1":1555,"y1":578,"payload":{"state":"Credentials"}},{"id":"3","type":"action","x0":1247,"y0":722,"x1":1641,"y1":1026,"payload":{"name":"T1059.006 Command and Scripting Interpreter: Python","description":"The malware is written to the C: and executes via Impacket, a publicly available tool, set of python scripts ","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/006/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"4","type":"action","x0":1247,"y0":1440,"x1":1641,"y1":1744,"payload":{"name":"T1542.003 Pre-OS Boot: Bootkit","description":"Executable wipes the MBR and replaces it with a malicious boot loader ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1542/003/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\", \"https://attack.mitre.org/techniques/T1561/002/\" \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"85","type":"data_property","x0":1788,"y0":828,"x1":2030,"y1":915,"payload":{"target":"Impacket"}},{"id":"86","type":"asset","x0":1326,"y0":1183,"x1":1561,"y1":1270,"payload":{"state":"Master Boot Record "}},{"id":"87","type":"action","x0":1532,"y0":2124,"x1":1926,"y1":2428,"payload":{"name":"T1059.001 Command and Scripting Interpreter: Powershell","description":"WhisperGates's MBR code will not run on GPT systems. To hedge against this possibility, the malware executes additional stages. The malware executes a PowerShell command twice to make the machine sleep for 20 seconds","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1059/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"88","type":"asset","x0":1327,"y0":1897,"x1":1562,"y1":1984,"payload":{"state":"Machine"}},{"id":"90","type":"asset","x0":1612,"y0":2581,"x1":1847,"y1":2668,"payload":{"state":"Machine"}},{"id":"91","type":"action","x0":1537,"y0":2793,"x1":1931,"y1":3097,"payload":{"name":"T1497.003 Virtualization/Sandbox Evasion: Time Based Evasion","description":"In the second stage, the machine sleeps for 20 seconds, likely to evade AV detection ","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND "}},{"id":"92","type":"asset","x0":1616,"y0":3253,"x1":1851,"y1":3340,"payload":{"state":"Machine"}},{"id":"93","type":"action","x0":1543,"y0":3490,"x1":1937,"y1":3794,"payload":{"name":"T1105 Ingress Tool Transfer","description":"The malware retrieves the third stage of the attack from a Discord channel. It is a JPG file","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1105/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"94","type":"data_property","x0":2037,"y0":3597,"x1":2279,"y1":3684,"payload":{"target":"Discord Channel"}},{"id":"95","type":"asset","x0":1621,"y0":3949,"x1":1856,"y1":4036,"payload":{"state":"Machine"}},{"id":"96","type":"action","x0":1545,"y0":4193,"x1":1939,"y1":4497,"payload":{"name":"T1036 Masquerading","description":"The malware pulls down a JPG file from Discord and reverses the file bytes and loads it as a .NET assembly","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1036/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"97","type":"data_property","x0":2073,"y0":4300,"x1":2315,"y1":4387,"payload":{"target":"JPG File"}},{"id":"98","type":"asset","x0":1622,"y0":4640,"x1":1857,"y1":4727,"payload":{"state":"Machine"}},{"id":"99","type":"action","x0":1540,"y0":4868,"x1":1934,"y1":5172,"payload":{"name":"T1027 Obfuscated Files or Information","description":"WhisperGate uses Eazfuscator to obfuscate the .NET malware","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\", \"https://attack.mitre.org/techniques/T1027/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"100","type":"asset","x0":1619,"y0":5319,"x1":1854,"y1":5406,"payload":{"state":"Machine"}},{"id":"101","type":"action","x0":1540,"y0":5570,"x1":1934,"y1":5874,"payload":{"name":"T1059.005 Command and Scripting Interpreter: Visual Basic","description":"The DLL drops a VBScript into the %Temp% directory and executes it. The script modifies Windows Defender settings to exclude the C: from being scanned","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/005/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"102","type":"action","x0":1548,"y0":6167,"x1":1942,"y1":6471,"payload":{"name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"103","type":"asset","x0":1624,"y0":5965,"x1":1859,"y1":6052,"payload":{"state":"Machine"}},{"id":"104","type":"data_property","x0":2079,"y0":6195,"x1":2321,"y1":6282,"payload":{"target":"AdvancedRun"}},{"id":"105","type":"data_property","x0":2082,"y0":6324,"x1":2324,"y1":6411,"payload":{"target":"Waqybg"}},{"id":"106","type":"asset","x0":1631,"y0":6568,"x1":1866,"y1":6655,"payload":{"state":"Machine"}},{"id":"107","type":"action","x0":1562,"y0":6789,"x1":1956,"y1":7093,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"The DLL leverages AdvancedRun to disable Windows Defender. It also leverages PowerShell to delete all the Windows Defender files and directories","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1562/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"108","type":"asset","x0":1648,"y0":7227,"x1":1883,"y1":7314,"payload":{"state":"Windows Defender"}},{"id":"109","type":"data_property","x0":2047,"y0":7226,"x1":2289,"y1":7313,"payload":{"target":"Disabled"}},{"id":"110","type":"action","x0":1569,"y0":7440,"x1":1963,"y1":7744,"payload":{"name":"T1055 Process Injection","description":"The malware loads the Waqybg resource into memory and restores it as the wiper payload. The DLL then injects the payload into legitimate Windows utility InstallUtil.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1055/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"112","type":"asset","x0":1660,"y0":8441,"x1":1895,"y1":8528,"payload":{"state":"Machine"}},{"id":"113","type":"action","x0":1062,"y0":8602,"x1":1456,"y1":8906,"payload":{"name":"T1082 System Information Discovery","description":"The wiper looks for fixed logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1082/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"114","type":"asset","x0":1651,"y0":8978,"x1":1886,"y1":9065,"payload":{"state":"System Drives"}},{"id":"115","type":"action","x0":1574,"y0":9201,"x1":1968,"y1":9505,"payload":{"name":"T1485 Data Destruction","description":"For each enumeration, the malware wipes the files in the logical drive with specific file extensions, while ignoring files in the %HOMEDRIVE%/Windows directory","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1485/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"116","type":"action","x0":995,"y0":2769,"x1":1389,"y1":3073,"payload":{"name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"119","type":"asset","x0":1076,"y0":3189,"x1":1311,"y1":3276,"payload":{"state":"Data"}},{"id":"120","type":"data_property","x0":651,"y0":2828,"x1":893,"y1":2915,"payload":{"target":"Ransomware Note Displayed"}},{"id":"121","type":"data_property","x0":655,"y0":2986,"x1":897,"y1":3073,"payload":{"target":"MBR-style partition"}},{"id":"122","type":"data_property","x0":696,"y0":3190,"x1":938,"y1":3277,"payload":{"target":"Wiped"}},{"id":"123","type":"action","x0":1589,"y0":10682,"x1":1983,"y1":10986,"payload":{"name":"T1529 System Shutdown/Reboot","description":"WhisperGate attempts to stop all running processes (including itself) by calling ExitWindowsEx API","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" \"https://attack.mitre.org/techniques/T1529/\" ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"124","type":"action","x0":998,"y0":2126,"x1":1392,"y1":2430,"payload":{"name":"T1204 User Execution (Shutdown)","description":"WhisperGate does not force a reboot, likely to provide time to execute additional stages of the malware. When the user reboots the machine, the first stage of the malware is executed","timestamp":"","reference":"\"https://blogs.blackberry.com/en/2022/01/threat-thursday-whispergate-wiper\", \"https://attack.mitre.org/techniques/T1204/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"125","type":"asset","x0":1076,"y0":2548,"x1":1311,"y1":2635,"payload":{"state":"Machine"}},{"id":"126","type":"data_property","x0":2046,"y0":4975,"x1":2288,"y1":5062,"payload":{"target":"Eazfuscator"}},{"id":"127","type":"data_property","x0":2092,"y0":6897,"x1":2334,"y1":6984,"payload":{"target":"AdvancedRun"}},{"id":"128","type":"data_property","x0":2130,"y0":7543,"x1":2372,"y1":7630,"payload":{"target":"Waqybg"}},{"id":"129","type":"asset","x0":1655,"y0":9672,"x1":1890,"y1":9759,"payload":{"state":"Data"}},{"id":"130","type":"data_property","x0":2046,"y0":9672,"x1":2288,"y1":9759,"payload":{"target":"Wiped"}},{"id":"131","type":"action","x0":2096,"y0":8569,"x1":2490,"y1":8873,"payload":{"name":"T1049 System Network Connections Discovery ","description":"The wiper looks for remote logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1049/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"132","type":"asset","x0":1665,"y0":10410,"x1":1900,"y1":10497,"payload":{"state":"Machine"}},{"id":"133","type":"action","x0":1584,"y0":9918,"x1":1978,"y1":10222,"payload":{"name":"T1070.004 Indicator Removal on Host: File Deletion","description":"After the wiping process, WhisperGate deletes InstallerUtil.exe\" from the %TEMP% directory","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"134","type":"asset","x0":1650,"y0":7842,"x1":1885,"y1":7929,"payload":{"state":"Machine"}},{"id":"135","type":"action","x0":1573,"y0":8030,"x1":1967,"y1":8334,"payload":{"name":"T1218.004 System Binary Proxy Execution: InstallUtil","description":"The malware executes Waqybg through the legitimate program InstallUtil ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}}],"edges":[{"id":"1.2","sourceId":"1","targetId":"2","source":{"id":"1","type":"action","x0":1241,"y0":56,"x1":1635,"y1":360,"payload":{"name":"T1078 Valid Accounts","description":"Cisco assesses that the attackers gained initial access through stolen credentials and likely had access to the victim's network for months ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1078/\" \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"2","type":"asset","x0":1320,"y0":491,"x1":1555,"y1":578,"payload":{"state":"Credentials"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"2.3","sourceId":"2","targetId":"3","source":{"id":"2","type":"asset","x0":1320,"y0":491,"x1":1555,"y1":578,"payload":{"state":"Credentials"}},"target":{"id":"3","type":"action","x0":1247,"y0":722,"x1":1641,"y1":1026,"payload":{"name":"T1059.006 Command and Scripting Interpreter: Python","description":"The malware is written to the C: and executes via Impacket, a publicly available tool, set of python scripts ","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/006/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"3.85","sourceId":"3","targetId":"85","source":{"id":"3","type":"action","x0":1247,"y0":722,"x1":1641,"y1":1026,"payload":{"name":"T1059.006 Command and Scripting Interpreter: Python","description":"The malware is written to the C: and executes via Impacket, a publicly available tool, set of python scripts ","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/006/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"85","type":"data_property","x0":1788,"y0":828,"x1":2030,"y1":915,"payload":{"target":"Impacket"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"3.86","sourceId":"3","targetId":"86","source":{"id":"3","type":"action","x0":1247,"y0":722,"x1":1641,"y1":1026,"payload":{"name":"T1059.006 Command and Scripting Interpreter: Python","description":"The malware is written to the C: and executes via Impacket, a publicly available tool, set of python scripts ","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/006/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"86","type":"asset","x0":1326,"y0":1183,"x1":1561,"y1":1270,"payload":{"state":"Master Boot Record "}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"86.4","sourceId":"86","targetId":"4","source":{"id":"86","type":"asset","x0":1326,"y0":1183,"x1":1561,"y1":1270,"payload":{"state":"Master Boot Record "}},"target":{"id":"4","type":"action","x0":1247,"y0":1440,"x1":1641,"y1":1744,"payload":{"name":"T1542.003 Pre-OS Boot: Bootkit","description":"Executable wipes the MBR and replaces it with a malicious boot loader ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1542/003/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\", \"https://attack.mitre.org/techniques/T1561/002/\" \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"4.88","sourceId":"4","targetId":"88","source":{"id":"4","type":"action","x0":1247,"y0":1440,"x1":1641,"y1":1744,"payload":{"name":"T1542.003 Pre-OS Boot: Bootkit","description":"Executable wipes the MBR and replaces it with a malicious boot loader ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1542/003/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\", \"https://attack.mitre.org/techniques/T1561/002/\" \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"88","type":"asset","x0":1327,"y0":1897,"x1":1562,"y1":1984,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"87.90","sourceId":"87","targetId":"90","source":{"id":"87","type":"action","x0":1532,"y0":2124,"x1":1926,"y1":2428,"payload":{"name":"T1059.001 Command and Scripting Interpreter: Powershell","description":"WhisperGates's MBR code will not run on GPT systems. To hedge against this possibility, the malware executes additional stages. The malware executes a PowerShell command twice to make the machine sleep for 20 seconds","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1059/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"90","type":"asset","x0":1612,"y0":2581,"x1":1847,"y1":2668,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"90.91","sourceId":"90","targetId":"91","source":{"id":"90","type":"asset","x0":1612,"y0":2581,"x1":1847,"y1":2668,"payload":{"state":"Machine"}},"target":{"id":"91","type":"action","x0":1537,"y0":2793,"x1":1931,"y1":3097,"payload":{"name":"T1497.003 Virtualization/Sandbox Evasion: Time Based Evasion","description":"In the second stage, the machine sleeps for 20 seconds, likely to evade AV detection ","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND "}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"91.92","sourceId":"91","targetId":"92","source":{"id":"91","type":"action","x0":1537,"y0":2793,"x1":1931,"y1":3097,"payload":{"name":"T1497.003 Virtualization/Sandbox Evasion: Time Based Evasion","description":"In the second stage, the machine sleeps for 20 seconds, likely to evade AV detection ","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND "}},"target":{"id":"92","type":"asset","x0":1616,"y0":3253,"x1":1851,"y1":3340,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"92.93","sourceId":"92","targetId":"93","source":{"id":"92","type":"asset","x0":1616,"y0":3253,"x1":1851,"y1":3340,"payload":{"state":"Machine"}},"target":{"id":"93","type":"action","x0":1543,"y0":3490,"x1":1937,"y1":3794,"payload":{"name":"T1105 Ingress Tool Transfer","description":"The malware retrieves the third stage of the attack from a Discord channel. It is a JPG file","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1105/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"93.94","sourceId":"93","targetId":"94","source":{"id":"93","type":"action","x0":1543,"y0":3490,"x1":1937,"y1":3794,"payload":{"name":"T1105 Ingress Tool Transfer","description":"The malware retrieves the third stage of the attack from a Discord channel. It is a JPG file","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1105/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"94","type":"data_property","x0":2037,"y0":3597,"x1":2279,"y1":3684,"payload":{"target":"Discord Channel"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"93.95","sourceId":"93","targetId":"95","source":{"id":"93","type":"action","x0":1543,"y0":3490,"x1":1937,"y1":3794,"payload":{"name":"T1105 Ingress Tool Transfer","description":"The malware retrieves the third stage of the attack from a Discord channel. It is a JPG file","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1105/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"95","type":"asset","x0":1621,"y0":3949,"x1":1856,"y1":4036,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"95.96","sourceId":"95","targetId":"96","source":{"id":"95","type":"asset","x0":1621,"y0":3949,"x1":1856,"y1":4036,"payload":{"state":"Machine"}},"target":{"id":"96","type":"action","x0":1545,"y0":4193,"x1":1939,"y1":4497,"payload":{"name":"T1036 Masquerading","description":"The malware pulls down a JPG file from Discord and reverses the file bytes and loads it as a .NET assembly","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1036/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"96.97","sourceId":"96","targetId":"97","source":{"id":"96","type":"action","x0":1545,"y0":4193,"x1":1939,"y1":4497,"payload":{"name":"T1036 Masquerading","description":"The malware pulls down a JPG file from Discord and reverses the file bytes and loads it as a .NET assembly","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1036/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"97","type":"data_property","x0":2073,"y0":4300,"x1":2315,"y1":4387,"payload":{"target":"JPG File"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"96.98","sourceId":"96","targetId":"98","source":{"id":"96","type":"action","x0":1545,"y0":4193,"x1":1939,"y1":4497,"payload":{"name":"T1036 Masquerading","description":"The malware pulls down a JPG file from Discord and reverses the file bytes and loads it as a .NET assembly","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1036/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"98","type":"asset","x0":1622,"y0":4640,"x1":1857,"y1":4727,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"98.99","sourceId":"98","targetId":"99","source":{"id":"98","type":"asset","x0":1622,"y0":4640,"x1":1857,"y1":4727,"payload":{"state":"Machine"}},"target":{"id":"99","type":"action","x0":1540,"y0":4868,"x1":1934,"y1":5172,"payload":{"name":"T1027 Obfuscated Files or Information","description":"WhisperGate uses Eazfuscator to obfuscate the .NET malware","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\", \"https://attack.mitre.org/techniques/T1027/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"99.100","sourceId":"99","targetId":"100","source":{"id":"99","type":"action","x0":1540,"y0":4868,"x1":1934,"y1":5172,"payload":{"name":"T1027 Obfuscated Files or Information","description":"WhisperGate uses Eazfuscator to obfuscate the .NET malware","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\", \"https://attack.mitre.org/techniques/T1027/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"100","type":"asset","x0":1619,"y0":5319,"x1":1854,"y1":5406,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"100.101","sourceId":"100","targetId":"101","source":{"id":"100","type":"asset","x0":1619,"y0":5319,"x1":1854,"y1":5406,"payload":{"state":"Machine"}},"target":{"id":"101","type":"action","x0":1540,"y0":5570,"x1":1934,"y1":5874,"payload":{"name":"T1059.005 Command and Scripting Interpreter: Visual Basic","description":"The DLL drops a VBScript into the %Temp% directory and executes it. The script modifies Windows Defender settings to exclude the C: from being scanned","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/005/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"101.103","sourceId":"101","targetId":"103","source":{"id":"101","type":"action","x0":1540,"y0":5570,"x1":1934,"y1":5874,"payload":{"name":"T1059.005 Command and Scripting Interpreter: Visual Basic","description":"The DLL drops a VBScript into the %Temp% directory and executes it. The script modifies Windows Defender settings to exclude the C: from being scanned","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/005/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"103","type":"asset","x0":1624,"y0":5965,"x1":1859,"y1":6052,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"103.102","sourceId":"103","targetId":"102","source":{"id":"103","type":"asset","x0":1624,"y0":5965,"x1":1859,"y1":6052,"payload":{"state":"Machine"}},"target":{"id":"102","type":"action","x0":1548,"y0":6167,"x1":1942,"y1":6471,"payload":{"name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"102.104","sourceId":"102","targetId":"104","source":{"id":"102","type":"action","x0":1548,"y0":6167,"x1":1942,"y1":6471,"payload":{"name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"104","type":"data_property","x0":2079,"y0":6195,"x1":2321,"y1":6282,"payload":{"target":"AdvancedRun"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"102.105","sourceId":"102","targetId":"105","source":{"id":"102","type":"action","x0":1548,"y0":6167,"x1":1942,"y1":6471,"payload":{"name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"105","type":"data_property","x0":2082,"y0":6324,"x1":2324,"y1":6411,"payload":{"target":"Waqybg"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"102.106","sourceId":"102","targetId":"106","source":{"id":"102","type":"action","x0":1548,"y0":6167,"x1":1942,"y1":6471,"payload":{"name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"106","type":"asset","x0":1631,"y0":6568,"x1":1866,"y1":6655,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"106.107","sourceId":"106","targetId":"107","source":{"id":"106","type":"asset","x0":1631,"y0":6568,"x1":1866,"y1":6655,"payload":{"state":"Machine"}},"target":{"id":"107","type":"action","x0":1562,"y0":6789,"x1":1956,"y1":7093,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"The DLL leverages AdvancedRun to disable Windows Defender. It also leverages PowerShell to delete all the Windows Defender files and directories","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1562/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"107.108","sourceId":"107","targetId":"108","source":{"id":"107","type":"action","x0":1562,"y0":6789,"x1":1956,"y1":7093,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"The DLL leverages AdvancedRun to disable Windows Defender. It also leverages PowerShell to delete all the Windows Defender files and directories","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1562/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"108","type":"asset","x0":1648,"y0":7227,"x1":1883,"y1":7314,"payload":{"state":"Windows Defender"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"108.109","sourceId":"108","targetId":"109","source":{"id":"108","type":"asset","x0":1648,"y0":7227,"x1":1883,"y1":7314,"payload":{"state":"Windows Defender"}},"target":{"id":"109","type":"data_property","x0":2047,"y0":7226,"x1":2289,"y1":7313,"payload":{"target":"Disabled"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"108.110","sourceId":"108","targetId":"110","source":{"id":"108","type":"asset","x0":1648,"y0":7227,"x1":1883,"y1":7314,"payload":{"state":"Windows Defender"}},"target":{"id":"110","type":"action","x0":1569,"y0":7440,"x1":1963,"y1":7744,"payload":{"name":"T1055 Process Injection","description":"The malware loads the Waqybg resource into memory and restores it as the wiper payload. The DLL then injects the payload into legitimate Windows utility InstallUtil.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1055/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"112.113","sourceId":"112","targetId":"113","source":{"id":"112","type":"asset","x0":1660,"y0":8441,"x1":1895,"y1":8528,"payload":{"state":"Machine"}},"target":{"id":"113","type":"action","x0":1062,"y0":8602,"x1":1456,"y1":8906,"payload":{"name":"T1082 System Information Discovery","description":"The wiper looks for fixed logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1082/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"113.114","sourceId":"113","targetId":"114","source":{"id":"113","type":"action","x0":1062,"y0":8602,"x1":1456,"y1":8906,"payload":{"name":"T1082 System Information Discovery","description":"The wiper looks for fixed logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1082/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"114","type":"asset","x0":1651,"y0":8978,"x1":1886,"y1":9065,"payload":{"state":"System Drives"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"116.119","sourceId":"116","targetId":"119","source":{"id":"116","type":"action","x0":995,"y0":2769,"x1":1389,"y1":3073,"payload":{"name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"119","type":"asset","x0":1076,"y0":3189,"x1":1311,"y1":3276,"payload":{"state":"Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"88.87","sourceId":"88","targetId":"87","source":{"id":"88","type":"asset","x0":1327,"y0":1897,"x1":1562,"y1":1984,"payload":{"state":"Machine"}},"target":{"id":"87","type":"action","x0":1532,"y0":2124,"x1":1926,"y1":2428,"payload":{"name":"T1059.001 Command and Scripting Interpreter: Powershell","description":"WhisperGates's MBR code will not run on GPT systems. To hedge against this possibility, the malware executes additional stages. The malware executes a PowerShell command twice to make the machine sleep for 20 seconds","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1059/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"116.120","sourceId":"116","targetId":"120","source":{"id":"116","type":"action","x0":995,"y0":2769,"x1":1389,"y1":3073,"payload":{"name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"120","type":"data_property","x0":651,"y0":2828,"x1":893,"y1":2915,"payload":{"target":"Ransomware Note Displayed"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"116.121","sourceId":"116","targetId":"121","source":{"id":"116","type":"action","x0":995,"y0":2769,"x1":1389,"y1":3073,"payload":{"name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"121","type":"data_property","x0":655,"y0":2986,"x1":897,"y1":3073,"payload":{"target":"MBR-style partition"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"119.122","sourceId":"119","targetId":"122","source":{"id":"119","type":"asset","x0":1076,"y0":3189,"x1":1311,"y1":3276,"payload":{"state":"Data"}},"target":{"id":"122","type":"data_property","x0":696,"y0":3190,"x1":938,"y1":3277,"payload":{"target":"Wiped"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"114.115","sourceId":"114","targetId":"115","source":{"id":"114","type":"asset","x0":1651,"y0":8978,"x1":1886,"y1":9065,"payload":{"state":"System Drives"}},"target":{"id":"115","type":"action","x0":1574,"y0":9201,"x1":1968,"y1":9505,"payload":{"name":"T1485 Data Destruction","description":"For each enumeration, the malware wipes the files in the logical drive with specific file extensions, while ignoring files in the %HOMEDRIVE%/Windows directory","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1485/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"125.116","sourceId":"125","targetId":"116","source":{"id":"125","type":"asset","x0":1076,"y0":2548,"x1":1311,"y1":2635,"payload":{"state":"Machine"}},"target":{"id":"116","type":"action","x0":995,"y0":2769,"x1":1389,"y1":3073,"payload":{"name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"124.125","sourceId":"124","targetId":"125","source":{"id":"124","type":"action","x0":998,"y0":2126,"x1":1392,"y1":2430,"payload":{"name":"T1204 User Execution (Shutdown)","description":"WhisperGate does not force a reboot, likely to provide time to execute additional stages of the malware. When the user reboots the machine, the first stage of the malware is executed","timestamp":"","reference":"\"https://blogs.blackberry.com/en/2022/01/threat-thursday-whispergate-wiper\", \"https://attack.mitre.org/techniques/T1204/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"125","type":"asset","x0":1076,"y0":2548,"x1":1311,"y1":2635,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"88.124","sourceId":"88","targetId":"124","source":{"id":"88","type":"asset","x0":1327,"y0":1897,"x1":1562,"y1":1984,"payload":{"state":"Machine"}},"target":{"id":"124","type":"action","x0":998,"y0":2126,"x1":1392,"y1":2430,"payload":{"name":"T1204 User Execution (Shutdown)","description":"WhisperGate does not force a reboot, likely to provide time to execute additional stages of the malware. When the user reboots the machine, the first stage of the malware is executed","timestamp":"","reference":"\"https://blogs.blackberry.com/en/2022/01/threat-thursday-whispergate-wiper\", \"https://attack.mitre.org/techniques/T1204/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"99.126","sourceId":"99","targetId":"126","source":{"id":"99","type":"action","x0":1540,"y0":4868,"x1":1934,"y1":5172,"payload":{"name":"T1027 Obfuscated Files or Information","description":"WhisperGate uses Eazfuscator to obfuscate the .NET malware","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\", \"https://attack.mitre.org/techniques/T1027/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"126","type":"data_property","x0":2046,"y0":4975,"x1":2288,"y1":5062,"payload":{"target":"Eazfuscator"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"107.127","sourceId":"107","targetId":"127","source":{"id":"107","type":"action","x0":1562,"y0":6789,"x1":1956,"y1":7093,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"The DLL leverages AdvancedRun to disable Windows Defender. It also leverages PowerShell to delete all the Windows Defender files and directories","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1562/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"127","type":"data_property","x0":2092,"y0":6897,"x1":2334,"y1":6984,"payload":{"target":"AdvancedRun"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"110.128","sourceId":"110","targetId":"128","source":{"id":"110","type":"action","x0":1569,"y0":7440,"x1":1963,"y1":7744,"payload":{"name":"T1055 Process Injection","description":"The malware loads the Waqybg resource into memory and restores it as the wiper payload. The DLL then injects the payload into legitimate Windows utility InstallUtil.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1055/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"128","type":"data_property","x0":2130,"y0":7543,"x1":2372,"y1":7630,"payload":{"target":"Waqybg"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"129.130","sourceId":"129","targetId":"130","source":{"id":"129","type":"asset","x0":1655,"y0":9672,"x1":1890,"y1":9759,"payload":{"state":"Data"}},"target":{"id":"130","type":"data_property","x0":2046,"y0":9672,"x1":2288,"y1":9759,"payload":{"target":"Wiped"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"112.131","sourceId":"112","targetId":"131","source":{"id":"112","type":"asset","x0":1660,"y0":8441,"x1":1895,"y1":8528,"payload":{"state":"Machine"}},"target":{"id":"131","type":"action","x0":2096,"y0":8569,"x1":2490,"y1":8873,"payload":{"name":"T1049 System Network Connections Discovery ","description":"The wiper looks for remote logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1049/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"131.114","sourceId":"131","targetId":"114","source":{"id":"131","type":"action","x0":2096,"y0":8569,"x1":2490,"y1":8873,"payload":{"name":"T1049 System Network Connections Discovery ","description":"The wiper looks for remote logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1049/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"114","type":"asset","x0":1651,"y0":8978,"x1":1886,"y1":9065,"payload":{"state":"System Drives"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"115.129","sourceId":"115","targetId":"129","source":{"id":"115","type":"action","x0":1574,"y0":9201,"x1":1968,"y1":9505,"payload":{"name":"T1485 Data Destruction","description":"For each enumeration, the malware wipes the files in the logical drive with specific file extensions, while ignoring files in the %HOMEDRIVE%/Windows directory","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1485/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"129","type":"asset","x0":1655,"y0":9672,"x1":1890,"y1":9759,"payload":{"state":"Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"129.133","sourceId":"129","targetId":"133","source":{"id":"129","type":"asset","x0":1655,"y0":9672,"x1":1890,"y1":9759,"payload":{"state":"Data"}},"target":{"id":"133","type":"action","x0":1584,"y0":9918,"x1":1978,"y1":10222,"payload":{"name":"T1070.004 Indicator Removal on Host: File Deletion","description":"After the wiping process, WhisperGate deletes InstallerUtil.exe\" from the %TEMP% directory","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"133.132","sourceId":"133","targetId":"132","source":{"id":"133","type":"action","x0":1584,"y0":9918,"x1":1978,"y1":10222,"payload":{"name":"T1070.004 Indicator Removal on Host: File Deletion","description":"After the wiping process, WhisperGate deletes InstallerUtil.exe\" from the %TEMP% directory","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"132","type":"asset","x0":1665,"y0":10410,"x1":1900,"y1":10497,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"132.123","sourceId":"132","targetId":"123","source":{"id":"132","type":"asset","x0":1665,"y0":10410,"x1":1900,"y1":10497,"payload":{"state":"Machine"}},"target":{"id":"123","type":"action","x0":1589,"y0":10682,"x1":1983,"y1":10986,"payload":{"name":"T1529 System Shutdown/Reboot","description":"WhisperGate attempts to stop all running processes (including itself) by calling ExitWindowsEx API","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" \"https://attack.mitre.org/techniques/T1529/\" ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"110.134","sourceId":"110","targetId":"134","source":{"id":"110","type":"action","x0":1569,"y0":7440,"x1":1963,"y1":7744,"payload":{"name":"T1055 Process Injection","description":"The malware loads the Waqybg resource into memory and restores it as the wiper payload. The DLL then injects the payload into legitimate Windows utility InstallUtil.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1055/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"134","type":"asset","x0":1650,"y0":7842,"x1":1885,"y1":7929,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"134.135","sourceId":"134","targetId":"135","source":{"id":"134","type":"asset","x0":1650,"y0":7842,"x1":1885,"y1":7929,"payload":{"state":"Machine"}},"target":{"id":"135","type":"action","x0":1573,"y0":8030,"x1":1967,"y1":8334,"payload":{"name":"T1218.004 System Binary Proxy Execution: InstallUtil","description":"The malware executes Waqybg through the legitimate program InstallUtil ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"135.112","sourceId":"135","targetId":"112","source":{"id":"135","type":"action","x0":1573,"y0":8030,"x1":1967,"y1":8334,"payload":{"name":"T1218.004 System Binary Proxy Execution: InstallUtil","description":"The malware executes Waqybg through the legitimate program InstallUtil ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"112","type":"asset","x0":1660,"y0":8441,"x1":1895,"y1":8528,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}