{"namespace":"flow-1","canvas":{"cameraX":874,"cameraY":7232,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"2","type":"action","x0":1117,"y0":873,"x1":1511,"y1":1177,"payload":{"name":" T1110 Brute Force","description":"Initial compromise can be through brute forcing passwords for the RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"3","type":"action","x0":1605,"y0":877,"x1":1999,"y1":1181,"payload":{"name":"T1078 Valid Accounts","description":"Initial compromise can be through gaining stolen credentials from the black market for the victim's RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},{"id":"6","type":"action","x0":1367,"y0":1645,"x1":1761,"y1":1949,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"asset","x0":1448,"y0":2092,"x1":1683,"y1":2179,"payload":{"state":"Compromised"}},{"id":"8","type":"action","x0":1184,"y0":2338,"x1":1578,"y1":2642,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. ","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"10","type":"data_property","x0":836,"y0":2448,"x1":1078,"y1":2535,"payload":{"target":"Windows COM Vulnerability"}},{"id":"11","type":"asset","x0":1452,"y0":2763,"x1":1687,"y1":2850,"payload":{"state":"Compromised"}},{"id":"12","type":"action","x0":1377,"y0":4201,"x1":1771,"y1":4505,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"13","type":"asset","x0":1456,"y0":3990,"x1":1691,"y1":4077,"payload":{"state":"Compromised"}},{"id":"14","type":"action","x0":1395,"y0":6215,"x1":1789,"y1":6519,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"15","type":"action","x0":1391,"y0":6904,"x1":1785,"y1":7208,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"18","type":"asset","x0":1457,"y0":5277,"x1":1692,"y1":5364,"payload":{"state":"Mappable to VM"}},{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},{"id":"22","type":"action","x0":1383,"y0":5475,"x1":1777,"y1":5779,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"26","type":"action","x0":1413,"y0":7624,"x1":1807,"y1":7928,"payload":{"name":"T1486 Data Encrypted for Impact","description":"Ragnar Locker then commences the encryption process in 64 simultaneous threads. The encrypted file contains the encrypted Salsa20 key data (40+32 bytes) with the signature ‘_RAGNAR_’ added to the footer at the very end. The ransomware note is displayed. ","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"27","type":"asset","x0":1476,"y0":5896,"x1":1711,"y1":5983,"payload":{"state":"Exfiltrated"}},{"id":"29","type":"action","x0":1374,"y0":2979,"x1":1768,"y1":3283,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"32","type":"action","x0":1377,"y0":4839,"x1":1771,"y1":5143,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"34","type":"asset","x0":1456,"y0":4622,"x1":1691,"y1":4709,"payload":{"state":"Compromised"}},{"id":"37","type":"asset","x0":1477,"y0":7384,"x1":1712,"y1":7471,"payload":{"state":"Deleted"}},{"id":"38","type":"data_property","x0":1813,"y0":6558,"x1":2055,"y1":6645,"payload":{"target":"Target Data"}},{"id":"39","type":"data_property","x0":1804,"y0":5889,"x1":2046,"y1":5976,"payload":{"target":"Data"}},{"id":"40","type":"data_property","x0":1807,"y0":5283,"x1":2049,"y1":5370,"payload":{"target":"Local Drives"}},{"id":"43","type":"data_property","x0":1833,"y0":7378,"x1":2075,"y1":7465,"payload":{"target":"Shadow Copies"}},{"id":"44","type":"action","x0":1328,"y0":148,"x1":1722,"y1":452,"payload":{"name":"T1133 External Remote Services","description":"The initial compromise began with compromising the victim's RDP services ","reference":"https://www.acronis.com/en-us/blog/posts/ragnar-locker/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"45","type":"data_property","x0":1760,"y0":1407,"x1":2002,"y1":1494,"payload":{"target":"RDP Credentials"}},{"id":"46","type":"asset","x0":1405,"y0":563,"x1":1640,"y1":650,"payload":{"state":"Compromised"}},{"id":"47","type":"data_property","x0":1735,"y0":564,"x1":1977,"y1":651,"payload":{"target":"RDP"}},{"id":"48","type":"action","x0":1651,"y0":2342,"x1":2045,"y1":2646,"payload":{"name":"T1059 Command and Scripting Interpreter","description":"The actor is able to run arbitrary code after exploiting CVE-2017-0213","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"49","type":"action","x0":1378,"y0":3577,"x1":1772,"y1":3881,"payload":{"name":"T1570 Lateral Tool Transfer","description":"Microsoft Installer downloads a Windows XP image and an old Oracle VirtualBox from a remote web server","reference":"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"50","type":"asset","x0":1455,"y0":3381,"x1":1690,"y1":3468,"payload":{"state":"Compromised"}},{"id":"51","type":"data_property","x0":1774,"y0":3384,"x1":2016,"y1":3471,"payload":{"target":"Admin Tools"}},{"id":"52","type":"data_property","x0":1812,"y0":6673,"x1":2054,"y1":6760,"payload":{"target":"Backup Services"}},{"id":"53","type":"data_property","x0":1816,"y0":6790,"x1":2058,"y1":6877,"payload":{"target":"Anti-virus"}},{"id":"54","type":"action","x0":908,"y0":1647,"x1":1302,"y1":1951,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}}],"edges":[{"id":"2.5","sourceId":"2","targetId":"5","source":{"id":"2","type":"action","x0":1117,"y0":873,"x1":1511,"y1":1177,"payload":{"name":" T1110 Brute Force","description":"Initial compromise can be through brute forcing passwords for the RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"3.5","sourceId":"3","targetId":"5","source":{"id":"3","type":"action","x0":1605,"y0":877,"x1":1999,"y1":1181,"payload":{"name":"T1078 Valid Accounts","description":"Initial compromise can be through gaining stolen credentials from the black market for the victim's RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"5.6","sourceId":"5","targetId":"6","source":{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},"target":{"id":"6","type":"action","x0":1367,"y0":1645,"x1":1761,"y1":1949,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"6.7","sourceId":"6","targetId":"7","source":{"id":"6","type":"action","x0":1367,"y0":1645,"x1":1761,"y1":1949,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"7","type":"asset","x0":1448,"y0":2092,"x1":1683,"y1":2179,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"7.8","sourceId":"7","targetId":"8","source":{"id":"7","type":"asset","x0":1448,"y0":2092,"x1":1683,"y1":2179,"payload":{"state":"Compromised"}},"target":{"id":"8","type":"action","x0":1184,"y0":2338,"x1":1578,"y1":2642,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. ","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"8.11","sourceId":"8","targetId":"11","source":{"id":"8","type":"action","x0":1184,"y0":2338,"x1":1578,"y1":2642,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. ","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"11","type":"asset","x0":1452,"y0":2763,"x1":1687,"y1":2850,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"22.27","sourceId":"22","targetId":"27","source":{"id":"22","type":"action","x0":1383,"y0":5475,"x1":1777,"y1":5779,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"27","type":"asset","x0":1476,"y0":5896,"x1":1711,"y1":5983,"payload":{"state":"Exfiltrated"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"11.29","sourceId":"11","targetId":"29","source":{"id":"11","type":"asset","x0":1452,"y0":2763,"x1":1687,"y1":2850,"payload":{"state":"Compromised"}},"target":{"id":"29","type":"action","x0":1374,"y0":2979,"x1":1768,"y1":3283,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"12.34","sourceId":"12","targetId":"34","source":{"id":"12","type":"action","x0":1377,"y0":4201,"x1":1771,"y1":4505,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"34","type":"asset","x0":1456,"y0":4622,"x1":1691,"y1":4709,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"34.32","sourceId":"34","targetId":"32","source":{"id":"34","type":"asset","x0":1456,"y0":4622,"x1":1691,"y1":4709,"payload":{"state":"Compromised"}},"target":{"id":"32","type":"action","x0":1377,"y0":4839,"x1":1771,"y1":5143,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"32.18","sourceId":"32","targetId":"18","source":{"id":"32","type":"action","x0":1377,"y0":4839,"x1":1771,"y1":5143,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"18","type":"asset","x0":1457,"y0":5277,"x1":1692,"y1":5364,"payload":{"state":"Mappable to VM"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"18.22","sourceId":"18","targetId":"22","source":{"id":"18","type":"asset","x0":1457,"y0":5277,"x1":1692,"y1":5364,"payload":{"state":"Mappable to VM"}},"target":{"id":"22","type":"action","x0":1383,"y0":5475,"x1":1777,"y1":5779,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"14.21","sourceId":"14","targetId":"21","source":{"id":"14","type":"action","x0":1395,"y0":6215,"x1":1789,"y1":6519,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"21.15","sourceId":"21","targetId":"15","source":{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},"target":{"id":"15","type":"action","x0":1391,"y0":6904,"x1":1785,"y1":7208,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"15.37","sourceId":"15","targetId":"37","source":{"id":"15","type":"action","x0":1391,"y0":6904,"x1":1785,"y1":7208,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"37","type":"asset","x0":1477,"y0":7384,"x1":1712,"y1":7471,"payload":{"state":"Deleted"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"37.26","sourceId":"37","targetId":"26","source":{"id":"37","type":"asset","x0":1477,"y0":7384,"x1":1712,"y1":7471,"payload":{"state":"Deleted"}},"target":{"id":"26","type":"action","x0":1413,"y0":7624,"x1":1807,"y1":7928,"payload":{"name":"T1486 Data Encrypted for Impact","description":"Ragnar Locker then commences the encryption process in 64 simultaneous threads. The encrypted file contains the encrypted Salsa20 key data (40+32 bytes) with the signature ‘_RAGNAR_’ added to the footer at the very end. The ransomware note is displayed. ","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"21.38","sourceId":"21","targetId":"38","source":{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},"target":{"id":"38","type":"data_property","x0":1813,"y0":6558,"x1":2055,"y1":6645,"payload":{"target":"Target Data"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"27.39","sourceId":"27","targetId":"39","source":{"id":"27","type":"asset","x0":1476,"y0":5896,"x1":1711,"y1":5983,"payload":{"state":"Exfiltrated"}},"target":{"id":"39","type":"data_property","x0":1804,"y0":5889,"x1":2046,"y1":5976,"payload":{"target":"Data"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"18.40","sourceId":"18","targetId":"40","source":{"id":"18","type":"asset","x0":1457,"y0":5277,"x1":1692,"y1":5364,"payload":{"state":"Mappable to VM"}},"target":{"id":"40","type":"data_property","x0":1807,"y0":5283,"x1":2049,"y1":5370,"payload":{"target":"Local Drives"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"37.43","sourceId":"37","targetId":"43","source":{"id":"37","type":"asset","x0":1477,"y0":7384,"x1":1712,"y1":7471,"payload":{"state":"Deleted"}},"target":{"id":"43","type":"data_property","x0":1833,"y0":7378,"x1":2075,"y1":7465,"payload":{"target":"Shadow Copies"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"5.45","sourceId":"5","targetId":"45","source":{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},"target":{"id":"45","type":"data_property","x0":1760,"y0":1407,"x1":2002,"y1":1494,"payload":{"target":"RDP Credentials"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"44.46","sourceId":"44","targetId":"46","source":{"id":"44","type":"action","x0":1328,"y0":148,"x1":1722,"y1":452,"payload":{"name":"T1133 External Remote Services","description":"The initial compromise began with compromising the victim's RDP services ","reference":"https://www.acronis.com/en-us/blog/posts/ragnar-locker/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"46","type":"asset","x0":1405,"y0":563,"x1":1640,"y1":650,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"46.47","sourceId":"46","targetId":"47","source":{"id":"46","type":"asset","x0":1405,"y0":563,"x1":1640,"y1":650,"payload":{"state":"Compromised"}},"target":{"id":"47","type":"data_property","x0":1735,"y0":564,"x1":1977,"y1":651,"payload":{"target":"RDP"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"46.2","sourceId":"46","targetId":"2","source":{"id":"46","type":"asset","x0":1405,"y0":563,"x1":1640,"y1":650,"payload":{"state":"Compromised"}},"target":{"id":"2","type":"action","x0":1117,"y0":873,"x1":1511,"y1":1177,"payload":{"name":" T1110 Brute Force","description":"Initial compromise can be through brute forcing passwords for the RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"46.3","sourceId":"46","targetId":"3","source":{"id":"46","type":"asset","x0":1405,"y0":563,"x1":1640,"y1":650,"payload":{"state":"Compromised"}},"target":{"id":"3","type":"action","x0":1605,"y0":877,"x1":1999,"y1":1181,"payload":{"name":"T1078 Valid Accounts","description":"Initial compromise can be through gaining stolen credentials from the black market for the victim's RDP service","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"7.48","sourceId":"7","targetId":"48","source":{"id":"7","type":"asset","x0":1448,"y0":2092,"x1":1683,"y1":2179,"payload":{"state":"Compromised"}},"target":{"id":"48","type":"action","x0":1651,"y0":2342,"x1":2045,"y1":2646,"payload":{"name":"T1059 Command and Scripting Interpreter","description":"The actor is able to run arbitrary code after exploiting CVE-2017-0213","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"48.11","sourceId":"48","targetId":"11","source":{"id":"48","type":"action","x0":1651,"y0":2342,"x1":2045,"y1":2646,"payload":{"name":"T1059 Command and Scripting Interpreter","description":"The actor is able to run arbitrary code after exploiting CVE-2017-0213","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"11","type":"asset","x0":1452,"y0":2763,"x1":1687,"y1":2850,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"8.10","sourceId":"8","targetId":"10","source":{"id":"8","type":"action","x0":1184,"y0":2338,"x1":1578,"y1":2642,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. ","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"10","type":"data_property","x0":836,"y0":2448,"x1":1078,"y1":2535,"payload":{"target":"Windows COM Vulnerability"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"50.51","sourceId":"50","targetId":"51","source":{"id":"50","type":"asset","x0":1455,"y0":3381,"x1":1690,"y1":3468,"payload":{"state":"Compromised"}},"target":{"id":"51","type":"data_property","x0":1774,"y0":3384,"x1":2016,"y1":3471,"payload":{"target":"Admin Tools"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"29.50","sourceId":"29","targetId":"50","source":{"id":"29","type":"action","x0":1374,"y0":2979,"x1":1768,"y1":3283,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"50","type":"asset","x0":1455,"y0":3381,"x1":1690,"y1":3468,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"50.49","sourceId":"50","targetId":"49","source":{"id":"50","type":"asset","x0":1455,"y0":3381,"x1":1690,"y1":3468,"payload":{"state":"Compromised"}},"target":{"id":"49","type":"action","x0":1378,"y0":3577,"x1":1772,"y1":3881,"payload":{"name":"T1570 Lateral Tool Transfer","description":"Microsoft Installer downloads a Windows XP image and an old Oracle VirtualBox from a remote web server","reference":"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"49.13","sourceId":"49","targetId":"13","source":{"id":"49","type":"action","x0":1378,"y0":3577,"x1":1772,"y1":3881,"payload":{"name":"T1570 Lateral Tool Transfer","description":"Microsoft Installer downloads a Windows XP image and an old Oracle VirtualBox from a remote web server","reference":"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"13","type":"asset","x0":1456,"y0":3990,"x1":1691,"y1":4077,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"13.12","sourceId":"13","targetId":"12","source":{"id":"13","type":"asset","x0":1456,"y0":3990,"x1":1691,"y1":4077,"payload":{"state":"Compromised"}},"target":{"id":"12","type":"action","x0":1377,"y0":4201,"x1":1771,"y1":4505,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"21.53","sourceId":"21","targetId":"53","source":{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},"target":{"id":"53","type":"data_property","x0":1816,"y0":6790,"x1":2058,"y1":6877,"payload":{"target":"Anti-virus"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"21.52","sourceId":"21","targetId":"52","source":{"id":"21","type":"asset","x0":1472,"y0":6682,"x1":1707,"y1":6769,"payload":{"state":"Compromised"}},"target":{"id":"52","type":"data_property","x0":1812,"y0":6673,"x1":2054,"y1":6760,"payload":{"target":"Backup Services"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"5.54","sourceId":"5","targetId":"54","source":{"id":"5","type":"asset","x0":1444,"y0":1408,"x1":1679,"y1":1495,"payload":{"state":"Compromised"}},"target":{"id":"54","type":"action","x0":908,"y0":1647,"x1":1302,"y1":1951,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"54.7","sourceId":"54","targetId":"7","source":{"id":"54","type":"action","x0":908,"y0":1647,"x1":1302,"y1":1951,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"7","type":"asset","x0":1448,"y0":2092,"x1":1683,"y1":2179,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"27.14","sourceId":"27","targetId":"14","source":{"id":"27","type":"asset","x0":1476,"y0":5896,"x1":1711,"y1":5983,"payload":{"state":"Exfiltrated"}},"target":{"id":"14","type":"action","x0":1395,"y0":6215,"x1":1789,"y1":6519,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}
