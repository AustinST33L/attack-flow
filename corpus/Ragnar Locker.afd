{"namespace":"flow-1","canvas":{"cameraX":28,"cameraY":0,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"2","type":"action","x0":317,"y0":73,"x1":711,"y1":377,"payload":{"name":" T1110 Brute Force","description":"Initial compromise is through the RDP service, and the attacker can brute forcing passwords ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"3","type":"action","x0":805,"y0":77,"x1":1199,"y1":381,"payload":{"name":"T1078 Valid Accounts","description":"Initial compromise is through the RDP service, and the attacker can use stolen credentials from the black market","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"5","type":"asset","x0":644,"y0":608,"x1":879,"y1":695,"payload":{"state":"RDP Credentials"}},{"id":"6","type":"action","x0":567,"y0":845,"x1":961,"y1":1149,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"asset","x0":648,"y0":1292,"x1":883,"y1":1379,"payload":{"state":"Machine"}},{"id":"8","type":"action","x0":570,"y0":1531,"x1":964,"y1":1835,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. POC code is available that abuses the BITS SetNotifyInterface to get a type library loaded under impersonation, and causes it to load a type library which references a scriptlet moniker which gets us code execution inside the BITS service. The result is a new cmd window with system privileges.","timestamp":"","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"10","type":"data_property","x0":1106,"y0":1638,"x1":1348,"y1":1725,"payload":{"target":"Windows COM Vulnerability"}},{"id":"11","type":"asset","x0":652,"y0":1963,"x1":887,"y1":2050,"payload":{"state":"Machine"}},{"id":"12","type":"action","x0":580,"y0":2915,"x1":974,"y1":3219,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"13","type":"asset","x0":654,"y0":2658,"x1":889,"y1":2745,"payload":{"state":"Admin Tools"}},{"id":"14","type":"action","x0":597,"y0":5628,"x1":991,"y1":5932,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"15","type":"action","x0":595,"y0":6288,"x1":989,"y1":6592,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"18","type":"asset","x0":655,"y0":3998,"x1":890,"y1":4085,"payload":{"state":"Local Drives"}},{"id":"21","type":"asset","x0":676,"y0":6059,"x1":911,"y1":6146,"payload":{"state":"Target Data"}},{"id":"22","type":"action","x0":573,"y0":4246,"x1":967,"y1":4550,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","timestamp":"","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"24","type":"action","x0":604,"y0":4982,"x1":998,"y1":5286,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"25","type":"asset","x0":680,"y0":5414,"x1":915,"y1":5501,"payload":{"state":"Machine"}},{"id":"26","type":"action","x0":604,"y0":6934,"x1":998,"y1":7238,"payload":{"name":"T1486 Data Encrypted for Impact","description":"Ragnar Locker then commences the encryption process in 64 simultaneous threads. The encrypted file contains the encrypted Salsa20 key data (40+32 bytes) with the signature ‘_RAGNAR_’ added to the footer at the very end. The ransomware note is displayed. ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"27","type":"asset","x0":683,"y0":4716,"x1":918,"y1":4803,"payload":{"state":"Data"}},{"id":"29","type":"action","x0":574,"y0":2205,"x1":968,"y1":2509,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer, which downloads a Windows XP image and an old Oracle VirtualBox","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"32","type":"action","x0":581,"y0":3576,"x1":975,"y1":3880,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"34","type":"asset","x0":662,"y0":3350,"x1":897,"y1":3437,"payload":{"state":"Machine"}},{"id":"35","type":"data_property","x0":1149,"y0":5737,"x1":1391,"y1":5824,"payload":{"target":"Anti-virus"}},{"id":"36","type":"data_property","x0":1142,"y0":5619,"x1":1384,"y1":5706,"payload":{"target":"Remote Management"}},{"id":"37","type":"asset","x0":679,"y0":6715,"x1":914,"y1":6802,"payload":{"state":"Shadow Copies"}},{"id":"38","type":"data_property","x0":1075,"y0":6058,"x1":1317,"y1":6145,"payload":{"target":"Released and Available for Encryption "}},{"id":"39","type":"data_property","x0":1028,"y0":4712,"x1":1270,"y1":4799,"payload":{"target":"Exfiltrated"}},{"id":"40","type":"data_property","x0":1022,"y0":4000,"x1":1264,"y1":4087,"payload":{"target":"Mappable to VM"}},{"id":"43","type":"data_property","x0":1081,"y0":6708,"x1":1323,"y1":6795,"payload":{"target":"Deleted"}}],"edges":[{"id":"2.5","sourceId":"2","targetId":"5","source":{"id":"2","type":"action","x0":317,"y0":73,"x1":711,"y1":377,"payload":{"name":" T1110 Brute Force","description":"Initial compromise is through the RDP service, and the attacker can brute forcing passwords ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"5","type":"asset","x0":644,"y0":608,"x1":879,"y1":695,"payload":{"state":"RDP Credentials"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"3.5","sourceId":"3","targetId":"5","source":{"id":"3","type":"action","x0":805,"y0":77,"x1":1199,"y1":381,"payload":{"name":"T1078 Valid Accounts","description":"Initial compromise is through the RDP service, and the attacker can use stolen credentials from the black market","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"5","type":"asset","x0":644,"y0":608,"x1":879,"y1":695,"payload":{"state":"RDP Credentials"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"5.6","sourceId":"5","targetId":"6","source":{"id":"5","type":"asset","x0":644,"y0":608,"x1":879,"y1":695,"payload":{"state":"RDP Credentials"}},"target":{"id":"6","type":"action","x0":567,"y0":845,"x1":961,"y1":1149,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"6.7","sourceId":"6","targetId":"7","source":{"id":"6","type":"action","x0":567,"y0":845,"x1":961,"y1":1149,"payload":{"name":" TA0043 Reconaissance","description":"The attacker performs second-stage reconaissance","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"7","type":"asset","x0":648,"y0":1292,"x1":883,"y1":1379,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"7.8","sourceId":"7","targetId":"8","source":{"id":"7","type":"asset","x0":648,"y0":1292,"x1":883,"y1":1379,"payload":{"state":"Machine"}},"target":{"id":"8","type":"action","x0":570,"y0":1531,"x1":964,"y1":1835,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. POC code is available that abuses the BITS SetNotifyInterface to get a type library loaded under impersonation, and causes it to load a type library which references a scriptlet moniker which gets us code execution inside the BITS service. The result is a new cmd window with system privileges.","timestamp":"","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"8.10","sourceId":"8","targetId":"10","source":{"id":"8","type":"action","x0":570,"y0":1531,"x1":964,"y1":1835,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. POC code is available that abuses the BITS SetNotifyInterface to get a type library loaded under impersonation, and causes it to load a type library which references a scriptlet moniker which gets us code execution inside the BITS service. The result is a new cmd window with system privileges.","timestamp":"","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"10","type":"data_property","x0":1106,"y0":1638,"x1":1348,"y1":1725,"payload":{"target":"Windows COM Vulnerability"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"8.11","sourceId":"8","targetId":"11","source":{"id":"8","type":"action","x0":570,"y0":1531,"x1":964,"y1":1835,"payload":{"name":"T1068 Exploitation for Privilege Escalation","description":"The threat actor elevates privileges by exploiting CVE-2017-0213. This allows the attacker to run arbitrary code with elevated privileges. POC code is available that abuses the BITS SetNotifyInterface to get a type library loaded under impersonation, and causes it to load a type library which references a scriptlet moniker which gets us code execution inside the BITS service. The result is a new cmd window with system privileges.","timestamp":"","reference":"\"https://www.miltonsecurity.com/company/blog/cve-2017-0213-windows-com-privilege-escalation-vulnerability\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"11","type":"asset","x0":652,"y0":1963,"x1":887,"y1":2050,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"22.27","sourceId":"22","targetId":"27","source":{"id":"22","type":"action","x0":573,"y0":4246,"x1":967,"y1":4550,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","timestamp":"","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"27","type":"asset","x0":683,"y0":4716,"x1":918,"y1":4803,"payload":{"state":"Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"11.29","sourceId":"11","targetId":"29","source":{"id":"11","type":"asset","x0":652,"y0":1963,"x1":887,"y1":2050,"payload":{"state":"Machine"}},"target":{"id":"29","type":"action","x0":574,"y0":2205,"x1":968,"y1":2509,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer, which downloads a Windows XP image and an old Oracle VirtualBox","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"29.13","sourceId":"29","targetId":"13","source":{"id":"29","type":"action","x0":574,"y0":2205,"x1":968,"y1":2509,"payload":{"name":"T1218.007 System Binary Proxy Execution: Msiexec ","description":"Ragnar has used admin tools such as PowerShell or GPO to move laterally to other Windows machines. In some attacks, the ransomware has been observed using a GPO task to execute Microsoft Installer, which downloads a Windows XP image and an old Oracle VirtualBox","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\" \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"13","type":"asset","x0":654,"y0":2658,"x1":889,"y1":2745,"payload":{"state":"Admin Tools"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"13.12","sourceId":"13","targetId":"12","source":{"id":"13","type":"asset","x0":654,"y0":2658,"x1":889,"y1":2745,"payload":{"state":"Admin Tools"}},"target":{"id":"12","type":"action","x0":580,"y0":2915,"x1":974,"y1":3219,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"12.34","sourceId":"12","targetId":"34","source":{"id":"12","type":"action","x0":580,"y0":2915,"x1":974,"y1":3219,"payload":{"name":"T1564.006 Hide Artifacts: Run Virtual Instance","description":"The attacker deploys a VirtualBox VM and loads a Windows XP image","timestamp":"","reference":"\"https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/\", \"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"34","type":"asset","x0":662,"y0":3350,"x1":897,"y1":3437,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"34.32","sourceId":"34","targetId":"32","source":{"id":"34","type":"asset","x0":662,"y0":3350,"x1":897,"y1":3437,"payload":{"state":"Machine"}},"target":{"id":"32","type":"action","x0":581,"y0":3576,"x1":975,"y1":3880,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"32.18","sourceId":"32","targetId":"18","source":{"id":"32","type":"action","x0":581,"y0":3576,"x1":975,"y1":3880,"payload":{"name":"T1120 Peripheral Device Discovery","description":"The specially-crafted VM image is loaded to the VirtualBox VM, mapping all local drives as read/writable into the virtual machine. This allows the ransomware process running inside the VM to encrypt all files. ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"18","type":"asset","x0":655,"y0":3998,"x1":890,"y1":4085,"payload":{"state":"Local Drives"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"18.22","sourceId":"18","targetId":"22","source":{"id":"18","type":"asset","x0":655,"y0":3998,"x1":890,"y1":4085,"payload":{"state":"Local Drives"}},"target":{"id":"22","type":"action","x0":573,"y0":4246,"x1":967,"y1":4550,"payload":{"name":"T1537 Transfer Data to Cloud Account","description":"The ransomware steals files and uploads them in case the victim refuses to pay the ransomware","timestamp":"","reference":"\"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\" \"https://www.zscaler.com/blogs/security-research/threatlabz-ransomware-review-advent-double-extortion\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"27.24","sourceId":"27","targetId":"24","source":{"id":"27","type":"asset","x0":683,"y0":4716,"x1":918,"y1":4803,"payload":{"state":"Data"}},"target":{"id":"24","type":"action","x0":604,"y0":4982,"x1":998,"y1":5286,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"24.25","sourceId":"24","targetId":"25","source":{"id":"24","type":"action","x0":604,"y0":4982,"x1":998,"y1":5286,"payload":{"name":" T1614.001 System Location Discovery: System Language Discovery","description":"One of the first things the ransomware checks is language. Locale information is checked to make sure CIS countries are not infected. If the machine’s default language matches one on the CIS list, the ransomware process is terminated with the “666” exit code.","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\", \"https://www.avertium.com/resources/threat-reports/ragnar-locker-ransomware-attacks-analysis\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"25","type":"asset","x0":680,"y0":5414,"x1":915,"y1":5501,"payload":{"state":"Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"25.14","sourceId":"25","targetId":"14","source":{"id":"25","type":"asset","x0":680,"y0":5414,"x1":915,"y1":5501,"payload":{"state":"Machine"}},"target":{"id":"14","type":"action","x0":597,"y0":5628,"x1":991,"y1":5932,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"14.35","sourceId":"14","targetId":"35","source":{"id":"14","type":"action","x0":597,"y0":5628,"x1":991,"y1":5932,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"35","type":"data_property","x0":1149,"y0":5737,"x1":1391,"y1":5824,"payload":{"target":"Anti-virus"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"14.36","sourceId":"14","targetId":"36","source":{"id":"14","type":"action","x0":597,"y0":5628,"x1":991,"y1":5932,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"36","type":"data_property","x0":1142,"y0":5619,"x1":1384,"y1":5706,"payload":{"target":"Remote Management"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"14.21","sourceId":"14","targetId":"21","source":{"id":"14","type":"action","x0":597,"y0":5628,"x1":991,"y1":5932,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Next, it references a list of services to be terminated by Ragnar Locker that include strings related to backup and antivirus solutions (such as ‘sophos’ and ‘veeam’), as well as remote management software (RMM) tools like ConnectWise and Kaseya that are typically used by managed service providers (MSPs).","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"21","type":"asset","x0":676,"y0":6059,"x1":911,"y1":6146,"payload":{"state":"Target Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"21.15","sourceId":"21","targetId":"15","source":{"id":"21","type":"asset","x0":676,"y0":6059,"x1":911,"y1":6146,"payload":{"state":"Target Data"}},"target":{"id":"15","type":"action","x0":595,"y0":6288,"x1":989,"y1":6592,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"15.37","sourceId":"15","targetId":"37","source":{"id":"15","type":"action","x0":595,"y0":6288,"x1":989,"y1":6592,"payload":{"name":"T1490 Inhibit System Recovery","description":"The ransomware deletes shadow copies","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"37","type":"asset","x0":679,"y0":6715,"x1":914,"y1":6802,"payload":{"state":"Shadow Copies"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"37.26","sourceId":"37","targetId":"26","source":{"id":"37","type":"asset","x0":679,"y0":6715,"x1":914,"y1":6802,"payload":{"state":"Shadow Copies"}},"target":{"id":"26","type":"action","x0":604,"y0":6934,"x1":998,"y1":7238,"payload":{"name":"T1486 Data Encrypted for Impact","description":"Ragnar Locker then commences the encryption process in 64 simultaneous threads. The encrypted file contains the encrypted Salsa20 key data (40+32 bytes) with the signature ‘_RAGNAR_’ added to the footer at the very end. The ransomware note is displayed. ","timestamp":"","reference":"\"https://www.acronis.com/en-us/blog/posts/ragnar-locker/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"21.38","sourceId":"21","targetId":"38","source":{"id":"21","type":"asset","x0":676,"y0":6059,"x1":911,"y1":6146,"payload":{"state":"Target Data"}},"target":{"id":"38","type":"data_property","x0":1075,"y0":6058,"x1":1317,"y1":6145,"payload":{"target":"Released and Available for Encryption "}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"27.39","sourceId":"27","targetId":"39","source":{"id":"27","type":"asset","x0":683,"y0":4716,"x1":918,"y1":4803,"payload":{"state":"Data"}},"target":{"id":"39","type":"data_property","x0":1028,"y0":4712,"x1":1270,"y1":4799,"payload":{"target":"Exfiltrated"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"18.40","sourceId":"18","targetId":"40","source":{"id":"18","type":"asset","x0":655,"y0":3998,"x1":890,"y1":4085,"payload":{"state":"Local Drives"}},"target":{"id":"40","type":"data_property","x0":1022,"y0":4000,"x1":1264,"y1":4087,"payload":{"target":"Mappable to VM"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"37.43","sourceId":"37","targetId":"43","source":{"id":"37","type":"asset","x0":679,"y0":6715,"x1":914,"y1":6802,"payload":{"state":"Shadow Copies"}},"target":{"id":"43","type":"data_property","x0":1081,"y0":6708,"x1":1323,"y1":6795,"payload":{"target":"Deleted"}},"type":"data_property_type","payload":{"type":"Description "}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}