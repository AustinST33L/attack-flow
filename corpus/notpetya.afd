{"namespace":"flow-1","canvas":{"cameraX":862,"cameraY":2446,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"Compromised"}},{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is actually PsExec utility","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"4","type":"action","x0":1267,"y0":796,"x1":1661,"y1":1100,"payload":{"name":"T1195 Supply Chain Compromise","description":"Sandworm likely installs backdoor within MeDoc software to compromise automatic update roll-out","reference":"\"https://attack.mitre.org/techniques/T1195/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"Compromised"}},{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware. This step requires SeTcbPrivilege and is a form of defense evasion. ","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS. However, this step is unnecessary if the malware is able to obtain SeDebug privileges","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"Obtained"}},{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised"}},{"id":"34","type":"data_property","x0":629,"y0":2282,"x1":871,"y1":2369,"payload":{"target":"Kaspersky "}},{"id":"35","type":"data_property","x0":632,"y0":2404,"x1":874,"y1":2491,"payload":{"target":"Norton Security"}},{"id":"37","type":"data_property","x0":634,"y0":2525,"x1":876,"y1":2612,"payload":{"target":"Symantec"}},{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB with the stolen tokens and harvested credentials obtained previously","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"42","type":"action","x0":1670,"y0":3689,"x1":2064,"y1":3993,"payload":{"name":"T1016 System Network Configuration Discovery","description":"Malware issues commands to gather list of known IP addresses and TCP endpoints and enumerate domain controllers","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Enumerated"}},{"id":"44","type":"data_property","x0":1424,"y0":4122,"x1":1666,"y1":4209,"payload":{"target":"Network Assets"}},{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition (Eternal Blue/Romance exploit), checks the Windows version, deploys an SMB backdoor. This routine is not executed if Norton Security or Symantec are present on the system.  ","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Compromised"}},{"id":"49","type":"action","x0":2024,"y0":5147,"x1":2418,"y1":5451,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\" \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Compromised"}},{"id":"53","type":"action","x0":1479,"y0":5620,"x1":1873,"y1":5924,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"56","type":"asset","x0":1819,"y0":6111,"x1":2054,"y1":6198,"payload":{"state":"Compromised"}},{"id":"57","type":"action","x0":1742,"y0":6301,"x1":2136,"y1":6605,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"61","type":"asset","x0":1832,"y0":6739,"x1":2067,"y1":6826,"payload":{"state":"Compromised"}},{"id":"62","type":"data_property","x0":2155,"y0":6740,"x1":2397,"y1":6827,"payload":{"target":"Physical Drive"}},{"id":"63","type":"action","x0":1752,"y0":6921,"x1":2146,"y1":7225,"payload":{"name":"T1529 System Shutdown/Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"67","type":"action","x0":1759,"y0":7510,"x1":2153,"y1":7814,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"68","type":"asset","x0":1832,"y0":7316,"x1":2067,"y1":7403,"payload":{"state":"Encrypted"}},{"id":"69","type":"data_property","x0":2176,"y0":7317,"x1":2418,"y1":7404,"payload":{"target":"Data"}},{"id":"71","type":"data_property","x0":2120,"y0":2244,"x1":2362,"y1":2331,"payload":{"target":"SeTcbPrivilege"}},{"id":"72","type":"data_property","x0":2125,"y0":2351,"x1":2367,"y1":2438,"payload":{"target":"SeDebugPrivilege"}},{"id":"73","type":"data_property","x0":2130,"y0":2460,"x1":2372,"y1":2547,"payload":{"target":"SeShutdownPrivilege"}},{"id":"79","type":"action","x0":1762,"y0":8167,"x1":2156,"y1":8471,"payload":{"name":"T1529 System Shutdown/Reboot","description":"Second reboot, ransomware note displayed","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"81","type":"asset","x0":1842,"y0":7947,"x1":2077,"y1":8034,"payload":{"state":"Compromised"}},{"id":"84","type":"data_property","x0":1150,"y0":4833,"x1":1392,"y1":4920,"payload":{"target":"Remote Machine"}},{"id":"85","type":"asset","x0":1842,"y0":8591,"x1":2077,"y1":8678,"payload":{"state":"Compromised"}},{"id":"86","type":"action","x0":1765,"y0":8775,"x1":2159,"y1":9079,"payload":{"name":"T1486 Data Encrypted for Impact","description":"The data is encrypted","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"87","type":"data_property","x0":1683,"y0":1315,"x1":1925,"y1":1402,"payload":{"target":"MeDoc Software"}},{"id":"88","type":"data_property","x0":2029,"y0":2675,"x1":2271,"y1":2762,"payload":{"target":"System Privileges"}},{"id":"89","type":"data_property","x0":2125,"y0":3413,"x1":2367,"y1":3500,"payload":{"target":"Credentials"}},{"id":"92","type":"data_property","x0":2440,"y0":4825,"x1":2682,"y1":4912,"payload":{"target":"Remote Admin$"}},{"id":"95","type":"data_property","x0":2202,"y0":8590,"x1":2444,"y1":8677,"payload":{"target":"Data"}},{"id":"96","type":"action","x0":1476,"y0":5041,"x1":1870,"y1":5345,"payload":{"name":"T1055 Process Injection","description":"Rundll32.exe is injected into lsass.exe","reference":"\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},{"id":"97","type":"asset","x0":1556,"y0":5431,"x1":1791,"y1":5518,"payload":{"state":"Compromised"}},{"id":"98","type":"data_property","x0":1231,"y0":5429,"x1":1473,"y1":5516,"payload":{"target":"System Process"}}],"edges":[{"id":"1.3","sourceId":"1","targetId":"3","source":{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"Compromised"}},"target":{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is actually PsExec utility","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"4.1","sourceId":"4","targetId":"1","source":{"id":"4","type":"action","x0":1267,"y0":796,"x1":1661,"y1":1100,"payload":{"name":"T1195 Supply Chain Compromise","description":"Sandworm likely installs backdoor within MeDoc software to compromise automatic update roll-out","reference":"\"https://attack.mitre.org/techniques/T1195/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"3.8","sourceId":"3","targetId":"8","source":{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is actually PsExec utility","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"8.9","sourceId":"8","targetId":"9","source":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"Compromised"}},"target":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"23.21","sourceId":"23","targetId":"21","source":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"Obtained"}},"target":{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS. However, this step is unnecessary if the malware is able to obtain SeDebug privileges","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"23.15","sourceId":"23","targetId":"15","source":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"Obtained"}},"target":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware. This step requires SeTcbPrivilege and is a form of defense evasion. ","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"9.23","sourceId":"9","targetId":"23","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"Obtained"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"15.26","sourceId":"15","targetId":"26","source":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware. This step requires SeTcbPrivilege and is a form of defense evasion. ","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"21.26","sourceId":"21","targetId":"26","source":{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS. However, this step is unnecessary if the malware is able to obtain SeDebug privileges","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"7.34","sourceId":"7","targetId":"34","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"34","type":"data_property","x0":629,"y0":2282,"x1":871,"y1":2369,"payload":{"target":"Kaspersky "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"7.35","sourceId":"7","targetId":"35","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"35","type":"data_property","x0":632,"y0":2404,"x1":874,"y1":2491,"payload":{"target":"Norton Security"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"7.37","sourceId":"7","targetId":"37","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"37","type":"data_property","x0":634,"y0":2525,"x1":876,"y1":2612,"payload":{"target":"Symantec"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"8.7","sourceId":"8","targetId":"7","source":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"Compromised"}},"target":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"26.42","sourceId":"26","targetId":"42","source":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised"}},"target":{"id":"42","type":"action","x0":1670,"y0":3689,"x1":2064,"y1":3993,"payload":{"name":"T1016 System Network Configuration Discovery","description":"Malware issues commands to gather list of known IP addresses and TCP endpoints and enumerate domain controllers","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"42.43","sourceId":"42","targetId":"43","source":{"id":"42","type":"action","x0":1670,"y0":3689,"x1":2064,"y1":3993,"payload":{"name":"T1016 System Network Configuration Discovery","description":"Malware issues commands to gather list of known IP addresses and TCP endpoints and enumerate domain controllers","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Enumerated"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"43.44","sourceId":"43","targetId":"44","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Enumerated"}},"target":{"id":"44","type":"data_property","x0":1424,"y0":4122,"x1":1666,"y1":4209,"payload":{"target":"Network Assets"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"43.39","sourceId":"43","targetId":"39","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Enumerated"}},"target":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB with the stolen tokens and harvested credentials obtained previously","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"43.45","sourceId":"43","targetId":"45","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Enumerated"}},"target":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition (Eternal Blue/Romance exploit), checks the Windows version, deploys an SMB backdoor. This routine is not executed if Norton Security or Symantec are present on the system.  ","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"39.48","sourceId":"39","targetId":"48","source":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB with the stolen tokens and harvested credentials obtained previously","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"48.49","sourceId":"48","targetId":"49","source":{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Compromised"}},"target":{"id":"49","type":"action","x0":2024,"y0":5147,"x1":2418,"y1":5451,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\" \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"45.52","sourceId":"45","targetId":"52","source":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition (Eternal Blue/Romance exploit), checks the Windows version, deploys an SMB backdoor. This routine is not executed if Norton Security or Symantec are present on the system.  ","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"49.56","sourceId":"49","targetId":"56","source":{"id":"49","type":"action","x0":2024,"y0":5147,"x1":2418,"y1":5451,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\" \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"56","type":"asset","x0":1819,"y0":6111,"x1":2054,"y1":6198,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"53.56","sourceId":"53","targetId":"56","source":{"id":"53","type":"action","x0":1479,"y0":5620,"x1":1873,"y1":5924,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"56","type":"asset","x0":1819,"y0":6111,"x1":2054,"y1":6198,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"56.57","sourceId":"56","targetId":"57","source":{"id":"56","type":"asset","x0":1819,"y0":6111,"x1":2054,"y1":6198,"payload":{"state":"Compromised"}},"target":{"id":"57","type":"action","x0":1742,"y0":6301,"x1":2136,"y1":6605,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"57.61","sourceId":"57","targetId":"61","source":{"id":"57","type":"action","x0":1742,"y0":6301,"x1":2136,"y1":6605,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"61","type":"asset","x0":1832,"y0":6739,"x1":2067,"y1":6826,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"61.62","sourceId":"61","targetId":"62","source":{"id":"61","type":"asset","x0":1832,"y0":6739,"x1":2067,"y1":6826,"payload":{"state":"Compromised"}},"target":{"id":"62","type":"data_property","x0":2155,"y0":6740,"x1":2397,"y1":6827,"payload":{"target":"Physical Drive"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"61.63","sourceId":"61","targetId":"63","source":{"id":"61","type":"asset","x0":1832,"y0":6739,"x1":2067,"y1":6826,"payload":{"state":"Compromised"}},"target":{"id":"63","type":"action","x0":1752,"y0":6921,"x1":2146,"y1":7225,"payload":{"name":"T1529 System Shutdown/Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"63.68","sourceId":"63","targetId":"68","source":{"id":"63","type":"action","x0":1752,"y0":6921,"x1":2146,"y1":7225,"payload":{"name":"T1529 System Shutdown/Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"68","type":"asset","x0":1832,"y0":7316,"x1":2067,"y1":7403,"payload":{"state":"Encrypted"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"68.67","sourceId":"68","targetId":"67","source":{"id":"68","type":"asset","x0":1832,"y0":7316,"x1":2067,"y1":7403,"payload":{"state":"Encrypted"}},"target":{"id":"67","type":"action","x0":1759,"y0":7510,"x1":2153,"y1":7814,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"68.69","sourceId":"68","targetId":"69","source":{"id":"68","type":"asset","x0":1832,"y0":7316,"x1":2067,"y1":7403,"payload":{"state":"Encrypted"}},"target":{"id":"69","type":"data_property","x0":2176,"y0":7317,"x1":2418,"y1":7404,"payload":{"target":"Data"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"9.71","sourceId":"9","targetId":"71","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"71","type":"data_property","x0":2120,"y0":2244,"x1":2362,"y1":2331,"payload":{"target":"SeTcbPrivilege"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"9.72","sourceId":"9","targetId":"72","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"72","type":"data_property","x0":2125,"y0":2351,"x1":2367,"y1":2438,"payload":{"target":"SeDebugPrivilege"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"9.73","sourceId":"9","targetId":"73","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"73","type":"data_property","x0":2130,"y0":2460,"x1":2372,"y1":2547,"payload":{"target":"SeShutdownPrivilege"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"81.79","sourceId":"81","targetId":"79","source":{"id":"81","type":"asset","x0":1842,"y0":7947,"x1":2077,"y1":8034,"payload":{"state":"Compromised"}},"target":{"id":"79","type":"action","x0":1762,"y0":8167,"x1":2156,"y1":8471,"payload":{"name":"T1529 System Shutdown/Reboot","description":"Second reboot, ransomware note displayed","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"67.81","sourceId":"67","targetId":"81","source":{"id":"67","type":"action","x0":1759,"y0":7510,"x1":2153,"y1":7814,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"81","type":"asset","x0":1842,"y0":7947,"x1":2077,"y1":8034,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"52.84","sourceId":"52","targetId":"84","source":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Compromised"}},"target":{"id":"84","type":"data_property","x0":1150,"y0":4833,"x1":1392,"y1":4920,"payload":{"target":"Remote Machine"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"79.85","sourceId":"79","targetId":"85","source":{"id":"79","type":"action","x0":1762,"y0":8167,"x1":2156,"y1":8471,"payload":{"name":"T1529 System Shutdown/Reboot","description":"Second reboot, ransomware note displayed","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"85","type":"asset","x0":1842,"y0":8591,"x1":2077,"y1":8678,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"85.86","sourceId":"85","targetId":"86","source":{"id":"85","type":"asset","x0":1842,"y0":8591,"x1":2077,"y1":8678,"payload":{"state":"Compromised"}},"target":{"id":"86","type":"action","x0":1765,"y0":8775,"x1":2159,"y1":9079,"payload":{"name":"T1486 Data Encrypted for Impact","description":"The data is encrypted","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"1.87","sourceId":"1","targetId":"87","source":{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"Compromised"}},"target":{"id":"87","type":"data_property","x0":1683,"y0":1315,"x1":1925,"y1":1402,"payload":{"target":"MeDoc Software"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"23.88","sourceId":"23","targetId":"88","source":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"Obtained"}},"target":{"id":"88","type":"data_property","x0":2029,"y0":2675,"x1":2271,"y1":2762,"payload":{"target":"System Privileges"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"26.89","sourceId":"26","targetId":"89","source":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised"}},"target":{"id":"89","type":"data_property","x0":2125,"y0":3413,"x1":2367,"y1":3500,"payload":{"target":"Credentials"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"48.92","sourceId":"48","targetId":"92","source":{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Compromised"}},"target":{"id":"92","type":"data_property","x0":2440,"y0":4825,"x1":2682,"y1":4912,"payload":{"target":"Remote Admin$"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"85.95","sourceId":"85","targetId":"95","source":{"id":"85","type":"asset","x0":1842,"y0":8591,"x1":2077,"y1":8678,"payload":{"state":"Compromised"}},"target":{"id":"95","type":"data_property","x0":2202,"y0":8590,"x1":2444,"y1":8677,"payload":{"target":"Data"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"52.96","sourceId":"52","targetId":"96","source":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Compromised"}},"target":{"id":"96","type":"action","x0":1476,"y0":5041,"x1":1870,"y1":5345,"payload":{"name":"T1055 Process Injection","description":"Rundll32.exe is injected into lsass.exe","reference":"\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State"}},{"id":"96.97","sourceId":"96","targetId":"97","source":{"id":"96","type":"action","x0":1476,"y0":5041,"x1":1870,"y1":5345,"payload":{"name":"T1055 Process Injection","description":"Rundll32.exe is injected into lsass.exe","reference":"\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"97","type":"asset","x0":1556,"y0":5431,"x1":1791,"y1":5518,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"97.98","sourceId":"97","targetId":"98","source":{"id":"97","type":"asset","x0":1556,"y0":5431,"x1":1791,"y1":5518,"payload":{"state":"Compromised"}},"target":{"id":"98","type":"data_property","x0":1231,"y0":5429,"x1":1473,"y1":5516,"payload":{"target":"System Process"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"97.53","sourceId":"97","targetId":"53","source":{"id":"97","type":"asset","x0":1556,"y0":5431,"x1":1791,"y1":5518,"payload":{"state":"Compromised"}},"target":{"id":"53","type":"action","x0":1479,"y0":5620,"x1":1873,"y1":5924,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"State Changed"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}
