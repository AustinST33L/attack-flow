{"namespace":"flow-1","canvas":{"cameraX":751,"cameraY":642,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"MeDoc Software "}},{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is PsExec utility","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"4","type":"action","x0":1267,"y0":796,"x1":1661,"y1":1100,"payload":{"name":"T1195 Supply Chain Compromise","description":"Sandworm likely installs backdoor within MeDoc software to compromise automatic update roll-out","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1195/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"System Processes"}},{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"System Privileges"}},{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised Credentials"}},{"id":"28","type":"data_property","x0":2426,"y0":3030,"x1":2668,"y1":3117,"payload":{"target":"Requires SeTcbPrivilege "}},{"id":"29","type":"data_property","x0":992,"y0":3050,"x1":1234,"y1":3137,"payload":{"target":"Unnecessary with SeDebugPrivilege "}},{"id":"34","type":"data_property","x0":629,"y0":2282,"x1":871,"y1":2369,"payload":{"target":"Kaspersky "}},{"id":"35","type":"data_property","x0":632,"y0":2404,"x1":874,"y1":2491,"payload":{"target":"Norton Security"}},{"id":"37","type":"data_property","x0":634,"y0":2525,"x1":876,"y1":2612,"payload":{"target":"Symantec"}},{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"40","type":"data_property","x0":2554,"y0":4370,"x1":2796,"y1":4457,"payload":{"target":"Stolen Tokens"}},{"id":"41","type":"data_property","x0":2560,"y0":4509,"x1":2802,"y1":4596,"payload":{"target":"Harvested Credentials"}},{"id":"42","type":"action","x0":1698,"y0":3678,"x1":2092,"y1":3982,"payload":{"name":"Network Discovery ","description":"Malware gathers list of known IP addresses and TCP endpoints, attempts to connect to SMB ports","timestamp":"","reference":"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Network Assets"}},{"id":"44","type":"data_property","x0":1424,"y0":4122,"x1":1666,"y1":4209,"payload":{"target":"Enumerated"}},{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"46","type":"data_property","x0":1100,"y0":4485,"x1":1342,"y1":4572,"payload":{"target":"Not Executed if Norton Security or Symantec Present"}},{"id":"47","type":"data_property","x0":1099,"y0":4375,"x1":1341,"y1":4462,"payload":{"target":"Eternal Blue/Eternal Romance"}},{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Remote Admin$"}},{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"50","type":"data_property","x0":2530,"y0":5061,"x1":2772,"y1":5148,"payload":{"target":"WMIC"}},{"id":"51","type":"data_property","x0":2532,"y0":5179,"x1":2774,"y1":5266,"payload":{"target":"PsExec"}},{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Remote Machine"}},{"id":"53","type":"action","x0":1483,"y0":5048,"x1":1877,"y1":5352,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},{"id":"55","type":"data_property","x0":1089,"y0":5158,"x1":1331,"y1":5245,"payload":{"target":"Lsass Injection"}},{"id":"56","type":"asset","x0":1846,"y0":5450,"x1":2081,"y1":5537,"payload":{"state":"Physical Drive"}},{"id":"57","type":"action","x0":1767,"y0":5663,"x1":2161,"y1":5967,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"58","type":"data_property","x0":1092,"y0":5274,"x1":1334,"y1":5361,"payload":{"target":"Defense Evasion"}},{"id":"59","type":"data_property","x0":2533,"y0":5295,"x1":2775,"y1":5382,"payload":{"target":"Defense Evasion"}},{"id":"60","type":"data_property","x0":2430,"y0":3138,"x1":2672,"y1":3225,"payload":{"target":"Defense Evasion"}},{"id":"61","type":"asset","x0":1849,"y0":6069,"x1":2084,"y1":6156,"payload":{"state":"Physical Drive"}},{"id":"62","type":"data_property","x0":2240,"y0":6066,"x1":2482,"y1":6153,"payload":{"target":"Compromised"}},{"id":"63","type":"action","x0":1770,"y0":6267,"x1":2164,"y1":6571,"payload":{"name":"System Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"66","type":"data_property","x0":1365,"y0":5772,"x1":1607,"y1":5859,"payload":{"target":"Kaspersky Alters Subroutine"}},{"id":"67","type":"action","x0":1775,"y0":6923,"x1":2169,"y1":7227,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"68","type":"asset","x0":1851,"y0":6654,"x1":2086,"y1":6741,"payload":{"state":"Data"}},{"id":"69","type":"data_property","x0":2249,"y0":6656,"x1":2491,"y1":6743,"payload":{"target":"Encrypted"}},{"id":"70","type":"data_property","x0":1722,"y0":1989,"x1":1964,"y1":2076,"payload":{"target":"Hashed"}},{"id":"71","type":"data_property","x0":2120,"y0":2244,"x1":2362,"y1":2331,"payload":{"target":"SeTcbPrivilege"}},{"id":"72","type":"data_property","x0":2125,"y0":2351,"x1":2367,"y1":2438,"payload":{"target":"SeDebugPrivilege"}},{"id":"73","type":"data_property","x0":2130,"y0":2460,"x1":2372,"y1":2547,"payload":{"target":"SeShutdownPrivilege"}},{"id":"79","type":"action","x0":1780,"y0":7573,"x1":2174,"y1":7877,"payload":{"name":"System Reboot","description":"Second reboot, ransomware note displayed","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"80","type":"data_property","x0":2327,"y0":7682,"x1":2569,"y1":7769,"payload":{"target":"Ransomware Note Displayed"}},{"id":"81","type":"asset","x0":1856,"y0":7339,"x1":2091,"y1":7426,"payload":{"state":"Victim Machine"}},{"id":"82","type":"data_property","x0":1107,"y0":4603,"x1":1349,"y1":4690,"payload":{"target":"Vulnerable SMBv1 "}},{"id":"83","type":"data_property","x0":2566,"y0":4624,"x1":2808,"y1":4711,"payload":{"target":"Any Version of SMB"}},{"id":"84","type":"data_property","x0":1150,"y0":4833,"x1":1392,"y1":4920,"payload":{"target":"Backdoor"}},{"id":"85","type":"asset","x0":1860,"y0":7986,"x1":2095,"y1":8073,"payload":{"state":"Data"}},{"id":"86","type":"action","x0":1782,"y0":8228,"x1":2176,"y1":8532,"payload":{"name":"T1486 Data Encrypted for Impact","description":"The data is encrypted","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}}],"edges":[{"id":"1.3","sourceId":"1","targetId":"3","source":{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"MeDoc Software "}},"target":{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is PsExec utility","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"4.1","sourceId":"4","targetId":"1","source":{"id":"4","type":"action","x0":1267,"y0":796,"x1":1661,"y1":1100,"payload":{"name":"T1195 Supply Chain Compromise","description":"Sandworm likely installs backdoor within MeDoc software to compromise automatic update roll-out","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1195/\"","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"1","type":"asset","x0":1345,"y0":1315,"x1":1580,"y1":1402,"payload":{"state":"MeDoc Software "}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"3.8","sourceId":"3","targetId":"8","source":{"id":"3","type":"action","x0":1266,"y0":1556,"x1":1660,"y1":1860,"payload":{"name":"T1036 Masquerading","description":"NotPetya drops the ransomware DLL perfc.dat. Part of the malware decompresses to dllhost.dat, which is PsExec utility","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1036/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"System Processes"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"8.9","sourceId":"8","targetId":"9","source":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"System Processes"}},"target":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"23.21","sourceId":"23","targetId":"21","source":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"System Privileges"}},"target":{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"23.15","sourceId":"23","targetId":"15","source":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"System Privileges"}},"target":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"9.23","sourceId":"9","targetId":"23","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"23","type":"asset","x0":1669,"y0":2676,"x1":1904,"y1":2763,"payload":{"state":"System Privileges"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"15.26","sourceId":"15","targetId":"26","source":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised Credentials"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"15.28","sourceId":"15","targetId":"28","source":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"28","type":"data_property","x0":2426,"y0":3030,"x1":2668,"y1":3117,"payload":{"target":"Requires SeTcbPrivilege "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"21.29","sourceId":"21","targetId":"29","source":{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"29","type":"data_property","x0":992,"y0":3050,"x1":1234,"y1":3137,"payload":{"target":"Unnecessary with SeDebugPrivilege "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"21.26","sourceId":"21","targetId":"26","source":{"id":"21","type":"action","x0":1384,"y0":2936,"x1":1778,"y1":3240,"payload":{"name":"T1003.001 OS Credential Dumping: LSASS Memory","description":"Operated as a modified version of Mimikatz, extracted credentials from LSASS","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1003/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised Credentials"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"7.34","sourceId":"7","targetId":"34","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"34","type":"data_property","x0":629,"y0":2282,"x1":871,"y1":2369,"payload":{"target":"Kaspersky "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"7.35","sourceId":"7","targetId":"35","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"35","type":"data_property","x0":632,"y0":2404,"x1":874,"y1":2491,"payload":{"target":"Norton Security"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"7.37","sourceId":"7","targetId":"37","source":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"37","type":"data_property","x0":634,"y0":2525,"x1":876,"y1":2612,"payload":{"target":"Symantec"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"8.7","sourceId":"8","targetId":"7","source":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"System Processes"}},"target":{"id":"7","type":"action","x0":982,"y0":2243,"x1":1376,"y1":2547,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"Malware starts subroutine and hashes every running process on the system and sets PROC_FLAG. It is looking for three hardcoded hashes: Kaspersky, Symantec, Norton. Which antivirus are present dictates how the malware will act. ","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T1518/001/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"39.40","sourceId":"39","targetId":"40","source":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"40","type":"data_property","x0":2554,"y0":4370,"x1":2796,"y1":4457,"payload":{"target":"Stolen Tokens"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"39.41","sourceId":"39","targetId":"41","source":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"41","type":"data_property","x0":2560,"y0":4509,"x1":2802,"y1":4596,"payload":{"target":"Harvested Credentials"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"26.42","sourceId":"26","targetId":"42","source":{"id":"26","type":"asset","x0":1777,"y0":3412,"x1":2012,"y1":3499,"payload":{"state":"Compromised Credentials"}},"target":{"id":"42","type":"action","x0":1698,"y0":3678,"x1":2092,"y1":3982,"payload":{"name":"Network Discovery ","description":"Malware gathers list of known IP addresses and TCP endpoints, attempts to connect to SMB ports","timestamp":"","reference":"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"42.43","sourceId":"42","targetId":"43","source":{"id":"42","type":"action","x0":1698,"y0":3678,"x1":2092,"y1":3982,"payload":{"name":"Network Discovery ","description":"Malware gathers list of known IP addresses and TCP endpoints, attempts to connect to SMB ports","timestamp":"","reference":"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Network Assets"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"43.44","sourceId":"43","targetId":"44","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Network Assets"}},"target":{"id":"44","type":"data_property","x0":1424,"y0":4122,"x1":1666,"y1":4209,"payload":{"target":"Enumerated"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"43.39","sourceId":"43","targetId":"39","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Network Assets"}},"target":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"43.45","sourceId":"43","targetId":"45","source":{"id":"43","type":"asset","x0":1779,"y0":4121,"x1":2014,"y1":4208,"payload":{"state":"Network Assets"}},"target":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"45.46","sourceId":"45","targetId":"46","source":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"46","type":"data_property","x0":1100,"y0":4485,"x1":1342,"y1":4572,"payload":{"target":"Not Executed if Norton Security or Symantec Present"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"45.47","sourceId":"45","targetId":"47","source":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"47","type":"data_property","x0":1099,"y0":4375,"x1":1341,"y1":4462,"payload":{"target":"Eternal Blue/Eternal Romance"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"39.48","sourceId":"39","targetId":"48","source":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Remote Admin$"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"48.49","sourceId":"48","targetId":"49","source":{"id":"48","type":"asset","x0":2098,"y0":4827,"x1":2333,"y1":4914,"payload":{"state":"Remote Admin$"}},"target":{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"49.50","sourceId":"49","targetId":"50","source":{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"50","type":"data_property","x0":2530,"y0":5061,"x1":2772,"y1":5148,"payload":{"target":"WMIC"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"49.51","sourceId":"49","targetId":"51","source":{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"51","type":"data_property","x0":2532,"y0":5179,"x1":2774,"y1":5266,"payload":{"target":"PsExec"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"45.52","sourceId":"45","targetId":"52","source":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Remote Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"52.53","sourceId":"52","targetId":"53","source":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Remote Machine"}},"target":{"id":"53","type":"action","x0":1483,"y0":5048,"x1":1877,"y1":5352,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"53.55","sourceId":"53","targetId":"55","source":{"id":"53","type":"action","x0":1483,"y0":5048,"x1":1877,"y1":5352,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"55","type":"data_property","x0":1089,"y0":5158,"x1":1331,"y1":5245,"payload":{"target":"Lsass Injection"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"49.56","sourceId":"49","targetId":"56","source":{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"56","type":"asset","x0":1846,"y0":5450,"x1":2081,"y1":5537,"payload":{"state":"Physical Drive"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"53.56","sourceId":"53","targetId":"56","source":{"id":"53","type":"action","x0":1483,"y0":5048,"x1":1877,"y1":5352,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"56","type":"asset","x0":1846,"y0":5450,"x1":2081,"y1":5537,"payload":{"state":"Physical Drive"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"53.58","sourceId":"53","targetId":"58","source":{"id":"53","type":"action","x0":1483,"y0":5048,"x1":1877,"y1":5352,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"NotPetya written to c:/windows and executed as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"58","type":"data_property","x0":1092,"y0":5274,"x1":1334,"y1":5361,"payload":{"target":"Defense Evasion"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"49.59","sourceId":"49","targetId":"59","source":{"id":"49","type":"action","x0":2016,"y0":5045,"x1":2410,"y1":5349,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":"Malware is written to Admin$ and executes either using PsExec or WMIC as rundll32.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"59","type":"data_property","x0":2533,"y0":5295,"x1":2775,"y1":5382,"payload":{"target":"Defense Evasion"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"15.60","sourceId":"15","targetId":"60","source":{"id":"15","type":"action","x0":1916,"y0":2927,"x1":2310,"y1":3231,"payload":{"name":"T1134.001 Access Token Impersonation","description":"Duplicates another user's token and allows attacker to escalate privileges and impersonate another user to spread the malware","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1134/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"60","type":"data_property","x0":2430,"y0":3138,"x1":2672,"y1":3225,"payload":{"target":"Defense Evasion"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"56.57","sourceId":"56","targetId":"57","source":{"id":"56","type":"asset","x0":1846,"y0":5450,"x1":2081,"y1":5537,"payload":{"state":"Physical Drive"}},"target":{"id":"57","type":"action","x0":1767,"y0":5663,"x1":2161,"y1":5967,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"57.61","sourceId":"57","targetId":"61","source":{"id":"57","type":"action","x0":1767,"y0":5663,"x1":2161,"y1":5967,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"61","type":"asset","x0":1849,"y0":6069,"x1":2084,"y1":6156,"payload":{"state":"Physical Drive"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"61.62","sourceId":"61","targetId":"62","source":{"id":"61","type":"asset","x0":1849,"y0":6069,"x1":2084,"y1":6156,"payload":{"state":"Physical Drive"}},"target":{"id":"62","type":"data_property","x0":2240,"y0":6066,"x1":2482,"y1":6153,"payload":{"target":"Compromised"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"57.66","sourceId":"57","targetId":"66","source":{"id":"57","type":"action","x0":1767,"y0":5663,"x1":2161,"y1":5967,"payload":{"name":"T1542.003 Pre-OS Boot: BootKit","description":"Malware reads and encodes MBR, overrides with custom boot loader, includes Bitcoin wallet and randomly generated personal installation key for user. If Kaspersky is present on the system, NotPetya will not encrypt the MFT but will still render the machine unbootable, though possible to recover MBR. ","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"66","type":"data_property","x0":1365,"y0":5772,"x1":1607,"y1":5859,"payload":{"target":"Kaspersky Alters Subroutine"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"61.63","sourceId":"61","targetId":"63","source":{"id":"61","type":"asset","x0":1849,"y0":6069,"x1":2084,"y1":6156,"payload":{"state":"Physical Drive"}},"target":{"id":"63","type":"action","x0":1770,"y0":6267,"x1":2164,"y1":6571,"payload":{"name":"System Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"63.68","sourceId":"63","targetId":"68","source":{"id":"63","type":"action","x0":1770,"y0":6267,"x1":2164,"y1":6571,"payload":{"name":"System Reboot","description":"System reboots, displays decoy, custom boot loader encrypts","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"68","type":"asset","x0":1851,"y0":6654,"x1":2086,"y1":6741,"payload":{"state":"Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"68.67","sourceId":"68","targetId":"67","source":{"id":"68","type":"asset","x0":1851,"y0":6654,"x1":2086,"y1":6741,"payload":{"state":"Data"}},"target":{"id":"67","type":"action","x0":1775,"y0":6923,"x1":2169,"y1":7227,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"68.69","sourceId":"68","targetId":"69","source":{"id":"68","type":"asset","x0":1851,"y0":6654,"x1":2086,"y1":6741,"payload":{"state":"Data"}},"target":{"id":"69","type":"data_property","x0":2249,"y0":6656,"x1":2491,"y1":6743,"payload":{"target":"Encrypted"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"8.70","sourceId":"8","targetId":"70","source":{"id":"8","type":"asset","x0":1348,"y0":1989,"x1":1583,"y1":2076,"payload":{"state":"System Processes"}},"target":{"id":"70","type":"data_property","x0":1722,"y0":1989,"x1":1964,"y1":2076,"payload":{"target":"Hashed"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"9.71","sourceId":"9","targetId":"71","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"71","type":"data_property","x0":2120,"y0":2244,"x1":2362,"y1":2331,"payload":{"target":"SeTcbPrivilege"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"9.72","sourceId":"9","targetId":"72","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"72","type":"data_property","x0":2125,"y0":2351,"x1":2367,"y1":2438,"payload":{"target":"SeDebugPrivilege"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"9.73","sourceId":"9","targetId":"73","source":{"id":"9","type":"action","x0":1586,"y0":2247,"x1":1980,"y1":2551,"payload":{"name":"Malware Privilege Discovery ","description":"Malware attempts to determine privilege of running process and gain various levels of privilege: SeTcbPrivilege, SeDebugPrivilege, SeShutdownPrivilege","timestamp":"","reference":"\"https://gallery.logrhythm.com/threat-intelligence-reports/notpetya-technical-analysis-logrhythm-labs-threat-intelligence-report.pdf\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"73","type":"data_property","x0":2130,"y0":2460,"x1":2372,"y1":2547,"payload":{"target":"SeShutdownPrivilege"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"81.79","sourceId":"81","targetId":"79","source":{"id":"81","type":"asset","x0":1856,"y0":7339,"x1":2091,"y1":7426,"payload":{"state":"Victim Machine"}},"target":{"id":"79","type":"action","x0":1780,"y0":7573,"x1":2174,"y1":7877,"payload":{"name":"System Reboot","description":"Second reboot, ransomware note displayed","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}},{"id":"67.81","sourceId":"67","targetId":"81","source":{"id":"67","type":"action","x0":1775,"y0":6923,"x1":2169,"y1":7227,"payload":{"name":"T1070.001 Indicator Removal on Host: Clear Windows Event Logs","description":"NotPetya uses wevtutil to clear the Windows event logs","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/001/\", \"https://www.justice.gov/opa/press-release/file/1328521/download\", \"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"81","type":"asset","x0":1856,"y0":7339,"x1":2091,"y1":7426,"payload":{"state":"Victim Machine"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"79.80","sourceId":"79","targetId":"80","source":{"id":"79","type":"action","x0":1780,"y0":7573,"x1":2174,"y1":7877,"payload":{"name":"System Reboot","description":"Second reboot, ransomware note displayed","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"80","type":"data_property","x0":2327,"y0":7682,"x1":2569,"y1":7769,"payload":{"target":"Ransomware Note Displayed"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"45.82","sourceId":"45","targetId":"82","source":{"id":"45","type":"action","x0":1475,"y0":4370,"x1":1869,"y1":4674,"payload":{"name":"T0866 Exploitation of Remote Services ","description":"NotPetya tests for vulnerable SMBv1 condition, checks the Windows version, deploys an SMB backdoor","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T0866/\", \"https://www.crowdstrike.com/blog/petrwrap-technical-analysis-part-2-further-findings-and-potential-for-mbr-recovery/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"82","type":"data_property","x0":1107,"y0":4603,"x1":1349,"y1":4690,"payload":{"target":"Vulnerable SMBv1 "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"39.83","sourceId":"39","targetId":"83","source":{"id":"39","type":"action","x0":2016,"y0":4369,"x1":2410,"y1":4673,"payload":{"name":"T1021.002 Remote Services: SMB/Windows Admin Shares","description":"Logs into any version of SMB","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\", \"https://attack.mitre.org/techniques/T0866/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"}},"target":{"id":"83","type":"data_property","x0":2566,"y0":4624,"x1":2808,"y1":4711,"payload":{"target":"Any Version of SMB"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"52.84","sourceId":"52","targetId":"84","source":{"id":"52","type":"asset","x0":1557,"y0":4834,"x1":1792,"y1":4921,"payload":{"state":"Remote Machine"}},"target":{"id":"84","type":"data_property","x0":1150,"y0":4833,"x1":1392,"y1":4920,"payload":{"target":"Backdoor"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"79.85","sourceId":"79","targetId":"85","source":{"id":"79","type":"action","x0":1780,"y0":7573,"x1":2174,"y1":7877,"payload":{"name":"System Reboot","description":"Second reboot, ransomware note displayed","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"85","type":"asset","x0":1860,"y0":7986,"x1":2095,"y1":8073,"payload":{"state":"Data"}},"type":"relationship","payload":{"type":"Compromises"}},{"id":"85.86","sourceId":"85","targetId":"86","source":{"id":"85","type":"asset","x0":1860,"y0":7986,"x1":2095,"y1":8073,"payload":{"state":"Data"}},"target":{"id":"86","type":"action","x0":1782,"y0":8228,"x1":2176,"y1":8532,"payload":{"name":"T1486 Data Encrypted for Impact","description":"The data is encrypted","timestamp":"","reference":"\"https://www.crowdstrike.com/blog/petrwrap-ransomware-technical-analysis-triple-threat-file-encryption-mft-encryption-credential-theft\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"Compromised"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}