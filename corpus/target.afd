{"namespace":"flow-1","canvas":{"cameraX":262.5,"cameraY":50,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"1","type":"action","x0":1285.2000489234924,"y0":1523.400016784668,"x1":1691,"y1":1823,"payload":{"name":"T1199 Trusted Relationship","description":"Targeted third-party supplier to gain access to Target's internal systems","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},{"id":"3","type":"data_property","x0":1926.00021982193,"y0":1243.400016784668,"x1":2184,"y1":1330,"payload":{"target":"technical configurations"}},{"id":"4","type":"data_property","x0":1924.4000000953674,"y0":1378.6000061035156,"x1":2182,"y1":1465,"payload":{"target":"3rd party Suppliers "}},{"id":"5","type":"action","x0":1011.066656589508,"y0":912.1999931335449,"x1":1417,"y1":1212,"payload":{"name":"T1592.004 Gather Victim Host Information: Client Configurations","description":"gathered information on Target network configurations","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"6","type":"action","x0":1552.93332529068,"y0":910.0667304992676,"x1":1958,"y1":1210,"payload":{"name":"T1593.002 Search Open Websites/Domains: Search Engines","description":"Googled information on Target systems for reconnaissance","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"asset","x0":1363.6000122129917,"y0":1889.0000610351562,"x1":1613,"y1":1976,"payload":{"state":"target"}},{"id":"8","type":"data_property","x0":1761.999975591898,"y0":1863.4000244140625,"x1":2020,"y1":1950,"payload":{"target":"Fazio Mechanical"}},{"id":"9","type":"action","x0":1261.199975579977,"y0":2024.1999206542969,"x1":1667,"y1":2324,"payload":{"name":"T1566 Phishing","description":"phishing attempts toward Fazio employess","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"10","type":"asset","x0":1333.2000366151333,"y0":2383.4000854492188,"x1":1583,"y1":2470,"payload":{"state":"compromised"}},{"id":"11","type":"data_property","x0":1733.2000366151333,"y0":2365.000030517578,"x1":1991,"y1":2452,"payload":{"target":"employee system"}},{"id":"12","type":"action","x0":1263.5999999940395,"y0":2560.199920654297,"x1":1669,"y1":2860,"payload":{"name":"T1078.002 Valid Accounts: Domain Accounts","description":"Successful phishing attempts allowed attackers to compromise AD credentials (most likely used by Fazio employees to access the Ariba system)","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},{"id":"14","type":"data_property","x0":1834.000024408102,"y0":2920.999984741211,"x1":2092,"y1":3008,"payload":{"target":"Ariba system"}},{"id":"15","type":"action","x0":2025.1000610291958,"y0":3038.8999633789062,"x1":2431,"y1":3338,"payload":{"name":"T1078.001 Valid Accounts: Default Accounts","description":"default account compromised","timestamp":"","reference":"https://sansorg.egnyte.com/dl/g5ykEMZpIk; https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"16","type":"data_property","x0":1761.999780267477,"y0":2796.2000122070312,"x1":2020,"y1":2883,"payload":{"target":"credentials"}},{"id":"17","type":"asset","x0":2108.3999877870083,"y0":3501.7999420166016,"x1":2358,"y1":3588,"payload":{"state":"compromised"}},{"id":"18","type":"data_property","x0":2209.199914544821,"y0":3670.6000061035156,"x1":2467,"y1":3757,"payload":{"target":"BMC Software management system"}},{"id":"19","type":"action","x0":1152.5499999523163,"y0":3174.9001121520996,"x1":1558,"y1":3474,"payload":{"name":"T1105 Ingress Tool Transfer","description":"added malware to POS systems","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"20","type":"asset","x0":1164.400042772293,"y0":3635.399932861328,"x1":1414,"y1":3722,"payload":{"state":"compromised"}},{"id":"21","type":"data_property","x0":1521.9998047351837,"y0":3749.000244140625,"x1":1780,"y1":3836,"payload":{"target":"POS systems"}},{"id":"22","type":"data_property","x0":1643.4500000476837,"y0":3277.900161743164,"x1":1901,"y1":3364,"payload":{"target":"BlackPOS malware"}},{"id":"25","type":"action","x0":627.6000065803528,"y0":2972.2001342773438,"x1":1033,"y1":3272,"payload":{"name":"T1072 Software Deployment Tools; T1078 Valid Accounts; T1505 Server Software Component; T1203 Exploitation for Client Execution","description":"attackers potentially compromised additional servers using vulnerabilities in installed software and valid accounts","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},{"id":"27","type":"asset","x0":714,"y0":3373.7999877929688,"x1":964,"y1":3460,"payload":{"state":"compromised"}},{"id":"28","type":"data_property","x0":702.0000457763672,"y0":3541.0000915527344,"x1":960,"y1":3628,"payload":{"target":"Target servers"}},{"id":"29","type":"action","x0":1070.8001098632812,"y0":3830.6001586914062,"x1":1476,"y1":4130,"payload":{"name":"T1029 Scheduled Transfer","description":"Every seven hours the Trojan checks to see if the local time is between the hours of 10 AM and 5 PM","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"30","type":"asset","x0":1250.000015258789,"y0":4260.999855041504,"x1":1500,"y1":4348,"payload":{"state":"identification"}},{"id":"31","type":"data_property","x0":1655.5998802185059,"y0":4149.800010681152,"x1":1913,"y1":4236,"payload":{"target":"POS local time between 10AM - 5PM"}},{"id":"32","type":"action","x0":720.6664237976074,"y0":4977.266704559326,"x1":1126,"y1":5277,"payload":{"name":"T1557.001 Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay","description":"establishes temporary NetBIOS share to transfer POS data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"33","type":"action","x0":1366.5335960388184,"y0":4946.3334884643555,"x1":1772,"y1":5246,"payload":{"name":"T1074.002 Data Staged: Remote Data Staging","description":"Collects POS information from multiple systems via NetBIOS share. Stores data in an internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"34","type":"action","x0":1899.6001243591309,"y0":4348.200225830078,"x1":2305,"y1":4648,"payload":{"name":"Utilizing common protocols","description":"uses common protocols to transfer data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"35","type":"action","x0":631.6000900268555,"y0":4368.199905395508,"x1":1037,"y1":4668,"payload":{"name":"T1570 Lateral Tool Transfer","description":"If the local machine time is between 10am - 5pm, then winxml.dll is sent over a temporary NetBIOS share","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"36","type":"asset","x0":710.8000030517578,"y0":4754.600006103516,"x1":960,"y1":4841,"payload":{"state":"compromised"}},{"id":"41","type":"data_property","x0":2227.5997772216797,"y0":5045.533226013184,"x1":2485,"y1":5132,"payload":{"target":"internal dump server"}},{"id":"42","type":"asset","x0":913.1999969482422,"y0":5426.33349609375,"x1":1163,"y1":5513,"payload":{"state":"established"}},{"id":"43","type":"asset","x0":1859.8665466308594,"y0":5042.866863250732,"x1":2109,"y1":5129,"payload":{"state":"established"}},{"id":"45","type":"data_property","x0":2422.7001342773438,"y0":4433.000106811523,"x1":2680,"y1":4520,"payload":{"target":"ports 139, 443, or 80"}},{"id":"46","type":"action","x0":1766.0001220703125,"y0":5327.733703613281,"x1":2172,"y1":5627,"payload":{"name":"T1095 Non-Application Layer Protocol","description":"ICMP packet sent to remote server to indicated that data was located on the internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"47","type":"asset","x0":1855.0667724609375,"y0":5759.733306884766,"x1":2105,"y1":5846,"payload":{"state":" alert"}},{"id":"49","type":"data_property","x0":2232.6671142578125,"y0":5753.867141723633,"x1":2490,"y1":5840,"payload":{"target":"ICMP ping"}},{"id":"50","type":"action","x0":1772.4002075195312,"y0":5975.2000732421875,"x1":2178,"y1":6275,"payload":{"name":"Exfiltration of data via unknown means","description":"exfiltration of data from internal dump server to off-site FTP servers","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"52","type":"asset","x0":1842.2666625976562,"y0":6371.466857910156,"x1":2092,"y1":6458,"payload":{"state":"exfiltration"}},{"id":"53","type":"data_property","x0":2235.866943359375,"y0":6362.400054931641,"x1":2493,"y1":6449,"payload":{"target":"data from internal dump server"}},{"id":"54","type":"asset","x0":1368.6668090820312,"y0":761.8666763305664,"x1":1618,"y1":848,"payload":{"state":"recon"}},{"id":"55","type":"data_property","x0":1761.2000122070312,"y0":762.9333915710449,"x1":2019,"y1":849,"payload":{"target":"Target"}},{"id":"56","type":"data_property","x0":511.6000671386719,"y0":5428.00048828125,"x1":769,"y1":5515,"payload":{"target":"temporary NetBIOS share"}},{"id":"57","type":"data_property","x0":246.25,"y0":4487.5,"x1":504,"y1":4574,"payload":{"target":"winxml.dll"}},{"id":"58","type":"data_property","x0":2313.75,"y0":6065,"x1":2571,"y1":6152,"payload":{"target":"FTP servers"}}],"edges":[{"id":"2.3","sourceId":"2","targetId":"3","source":{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},"target":{"id":"3","type":"data_property","x0":1926.00021982193,"y0":1243.400016784668,"x1":2184,"y1":1330,"payload":{"target":"technical configurations"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"2.4","sourceId":"2","targetId":"4","source":{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},"target":{"id":"4","type":"data_property","x0":1924.4000000953674,"y0":1378.6000061035156,"x1":2182,"y1":1465,"payload":{"target":"3rd party Suppliers "}},"type":"data_property_type","payload":{"type":"description"}},{"id":"2.1","sourceId":"2","targetId":"1","source":{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},"target":{"id":"1","type":"action","x0":1285.2000489234924,"y0":1523.400016784668,"x1":1691,"y1":1823,"payload":{"name":"T1199 Trusted Relationship","description":"Targeted third-party supplier to gain access to Target's internal systems","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"5.2","sourceId":"5","targetId":"2","source":{"id":"5","type":"action","x0":1011.066656589508,"y0":912.1999931335449,"x1":1417,"y1":1212,"payload":{"name":"T1592.004 Gather Victim Host Information: Client Configurations","description":"gathered information on Target network configurations","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},"type":"relationship","payload":{"type":"state change"}},{"id":"6.2","sourceId":"6","targetId":"2","source":{"id":"6","type":"action","x0":1552.93332529068,"y0":910.0667304992676,"x1":1958,"y1":1210,"payload":{"name":"T1593.002 Search Open Websites/Domains: Search Engines","description":"Googled information on Target systems for reconnaissance","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"2","type":"asset","x0":1359.600073337555,"y0":1329.8000450134277,"x1":1609,"y1":1416,"payload":{"state":"identified "}},"type":"relationship","payload":{"type":"state change"}},{"id":"1.7","sourceId":"1","targetId":"7","source":{"id":"1","type":"action","x0":1285.2000489234924,"y0":1523.400016784668,"x1":1691,"y1":1823,"payload":{"name":"T1199 Trusted Relationship","description":"Targeted third-party supplier to gain access to Target's internal systems","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"7","type":"asset","x0":1363.6000122129917,"y0":1889.0000610351562,"x1":1613,"y1":1976,"payload":{"state":"target"}},"type":"relationship","payload":{"type":"state change"}},{"id":"7.8","sourceId":"7","targetId":"8","source":{"id":"7","type":"asset","x0":1363.6000122129917,"y0":1889.0000610351562,"x1":1613,"y1":1976,"payload":{"state":"target"}},"target":{"id":"8","type":"data_property","x0":1761.999975591898,"y0":1863.4000244140625,"x1":2020,"y1":1950,"payload":{"target":"Fazio Mechanical"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"7.9","sourceId":"7","targetId":"9","source":{"id":"7","type":"asset","x0":1363.6000122129917,"y0":1889.0000610351562,"x1":1613,"y1":1976,"payload":{"state":"target"}},"target":{"id":"9","type":"action","x0":1261.199975579977,"y0":2024.1999206542969,"x1":1667,"y1":2324,"payload":{"name":"T1566 Phishing","description":"phishing attempts toward Fazio employess","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"9.10","sourceId":"9","targetId":"10","source":{"id":"9","type":"action","x0":1261.199975579977,"y0":2024.1999206542969,"x1":1667,"y1":2324,"payload":{"name":"T1566 Phishing","description":"phishing attempts toward Fazio employess","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"10","type":"asset","x0":1333.2000366151333,"y0":2383.4000854492188,"x1":1583,"y1":2470,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"10.11","sourceId":"10","targetId":"11","source":{"id":"10","type":"asset","x0":1333.2000366151333,"y0":2383.4000854492188,"x1":1583,"y1":2470,"payload":{"state":"compromised"}},"target":{"id":"11","type":"data_property","x0":1733.2000366151333,"y0":2365.000030517578,"x1":1991,"y1":2452,"payload":{"target":"employee system"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"12.13","sourceId":"12","targetId":"13","source":{"id":"12","type":"action","x0":1263.5999999940395,"y0":2560.199920654297,"x1":1669,"y1":2860,"payload":{"name":"T1078.002 Valid Accounts: Domain Accounts","description":"Successful phishing attempts allowed attackers to compromise AD credentials (most likely used by Fazio employees to access the Ariba system)","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"13.14","sourceId":"13","targetId":"14","source":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"target":{"id":"14","type":"data_property","x0":1834.000024408102,"y0":2920.999984741211,"x1":2092,"y1":3008,"payload":{"target":"Ariba system"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"10.12","sourceId":"10","targetId":"12","source":{"id":"10","type":"asset","x0":1333.2000366151333,"y0":2383.4000854492188,"x1":1583,"y1":2470,"payload":{"state":"compromised"}},"target":{"id":"12","type":"action","x0":1263.5999999940395,"y0":2560.199920654297,"x1":1669,"y1":2860,"payload":{"name":"T1078.002 Valid Accounts: Domain Accounts","description":"Successful phishing attempts allowed attackers to compromise AD credentials (most likely used by Fazio employees to access the Ariba system)","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"13.16","sourceId":"13","targetId":"16","source":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"target":{"id":"16","type":"data_property","x0":1761.999780267477,"y0":2796.2000122070312,"x1":2020,"y1":2883,"payload":{"target":"credentials"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"13.15","sourceId":"13","targetId":"15","source":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"target":{"id":"15","type":"action","x0":2025.1000610291958,"y0":3038.8999633789062,"x1":2431,"y1":3338,"payload":{"name":"T1078.001 Valid Accounts: Default Accounts","description":"default account compromised","timestamp":"","reference":"https://sansorg.egnyte.com/dl/g5ykEMZpIk; https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"15.17","sourceId":"15","targetId":"17","source":{"id":"15","type":"action","x0":2025.1000610291958,"y0":3038.8999633789062,"x1":2431,"y1":3338,"payload":{"name":"T1078.001 Valid Accounts: Default Accounts","description":"default account compromised","timestamp":"","reference":"https://sansorg.egnyte.com/dl/g5ykEMZpIk; https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"17","type":"asset","x0":2108.3999877870083,"y0":3501.7999420166016,"x1":2358,"y1":3588,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"17.18","sourceId":"17","targetId":"18","source":{"id":"17","type":"asset","x0":2108.3999877870083,"y0":3501.7999420166016,"x1":2358,"y1":3588,"payload":{"state":"compromised"}},"target":{"id":"18","type":"data_property","x0":2209.199914544821,"y0":3670.6000061035156,"x1":2467,"y1":3757,"payload":{"target":"BMC Software management system"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"20.21","sourceId":"20","targetId":"21","source":{"id":"20","type":"asset","x0":1164.400042772293,"y0":3635.399932861328,"x1":1414,"y1":3722,"payload":{"state":"compromised"}},"target":{"id":"21","type":"data_property","x0":1521.9998047351837,"y0":3749.000244140625,"x1":1780,"y1":3836,"payload":{"target":"POS systems"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"19.20","sourceId":"19","targetId":"20","source":{"id":"19","type":"action","x0":1152.5499999523163,"y0":3174.9001121520996,"x1":1558,"y1":3474,"payload":{"name":"T1105 Ingress Tool Transfer","description":"added malware to POS systems","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"20","type":"asset","x0":1164.400042772293,"y0":3635.399932861328,"x1":1414,"y1":3722,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"19.22","sourceId":"19","targetId":"22","source":{"id":"19","type":"action","x0":1152.5499999523163,"y0":3174.9001121520996,"x1":1558,"y1":3474,"payload":{"name":"T1105 Ingress Tool Transfer","description":"added malware to POS systems","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"22","type":"data_property","x0":1643.4500000476837,"y0":3277.900161743164,"x1":1901,"y1":3364,"payload":{"target":"BlackPOS malware"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"13.19","sourceId":"13","targetId":"19","source":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"target":{"id":"19","type":"action","x0":1152.5499999523163,"y0":3174.9001121520996,"x1":1558,"y1":3474,"payload":{"name":"T1105 Ingress Tool Transfer","description":"added malware to POS systems","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"13.25","sourceId":"13","targetId":"25","source":{"id":"13","type":"asset","x0":1356.3999877870083,"y0":2925.800018310547,"x1":1606,"y1":3012,"payload":{"state":"compromised"}},"target":{"id":"25","type":"action","x0":627.6000065803528,"y0":2972.2001342773438,"x1":1033,"y1":3272,"payload":{"name":"T1072 Software Deployment Tools; T1078 Valid Accounts; T1505 Server Software Component; T1203 Exploitation for Client Execution","description":"attackers potentially compromised additional servers using vulnerabilities in installed software and valid accounts","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"25.27","sourceId":"25","targetId":"27","source":{"id":"25","type":"action","x0":627.6000065803528,"y0":2972.2001342773438,"x1":1033,"y1":3272,"payload":{"name":"T1072 Software Deployment Tools; T1078 Valid Accounts; T1505 Server Software Component; T1203 Exploitation for Client Execution","description":"attackers potentially compromised additional servers using vulnerabilities in installed software and valid accounts","timestamp":"","reference":"https://www.commerce.senate.gov/services/files/24d3c229-4f2f-405d-b8db-a3a67f183883","succeeded":1,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"27","type":"asset","x0":714,"y0":3373.7999877929688,"x1":964,"y1":3460,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"27.28","sourceId":"27","targetId":"28","source":{"id":"27","type":"asset","x0":714,"y0":3373.7999877929688,"x1":964,"y1":3460,"payload":{"state":"compromised"}},"target":{"id":"28","type":"data_property","x0":702.0000457763672,"y0":3541.0000915527344,"x1":960,"y1":3628,"payload":{"target":"Target servers"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"20.29","sourceId":"20","targetId":"29","source":{"id":"20","type":"asset","x0":1164.400042772293,"y0":3635.399932861328,"x1":1414,"y1":3722,"payload":{"state":"compromised"}},"target":{"id":"29","type":"action","x0":1070.8001098632812,"y0":3830.6001586914062,"x1":1476,"y1":4130,"payload":{"name":"T1029 Scheduled Transfer","description":"Every seven hours the Trojan checks to see if the local time is between the hours of 10 AM and 5 PM","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"29.30","sourceId":"29","targetId":"30","source":{"id":"29","type":"action","x0":1070.8001098632812,"y0":3830.6001586914062,"x1":1476,"y1":4130,"payload":{"name":"T1029 Scheduled Transfer","description":"Every seven hours the Trojan checks to see if the local time is between the hours of 10 AM and 5 PM","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"30","type":"asset","x0":1250.000015258789,"y0":4260.999855041504,"x1":1500,"y1":4348,"payload":{"state":"identification"}},"type":"relationship","payload":{"type":"state change"}},{"id":"30.31","sourceId":"30","targetId":"31","source":{"id":"30","type":"asset","x0":1250.000015258789,"y0":4260.999855041504,"x1":1500,"y1":4348,"payload":{"state":"identification"}},"target":{"id":"31","type":"data_property","x0":1655.5998802185059,"y0":4149.800010681152,"x1":1913,"y1":4236,"payload":{"target":"POS local time between 10AM - 5PM"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"30.35","sourceId":"30","targetId":"35","source":{"id":"30","type":"asset","x0":1250.000015258789,"y0":4260.999855041504,"x1":1500,"y1":4348,"payload":{"state":"identification"}},"target":{"id":"35","type":"action","x0":631.6000900268555,"y0":4368.199905395508,"x1":1037,"y1":4668,"payload":{"name":"T1570 Lateral Tool Transfer","description":"If the local machine time is between 10am - 5pm, then winxml.dll is sent over a temporary NetBIOS share","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"36.32","sourceId":"36","targetId":"32","source":{"id":"36","type":"asset","x0":710.8000030517578,"y0":4754.600006103516,"x1":960,"y1":4841,"payload":{"state":"compromised"}},"target":{"id":"32","type":"action","x0":720.6664237976074,"y0":4977.266704559326,"x1":1126,"y1":5277,"payload":{"name":"T1557.001 Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay","description":"establishes temporary NetBIOS share to transfer POS data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"32.42","sourceId":"32","targetId":"42","source":{"id":"32","type":"action","x0":720.6664237976074,"y0":4977.266704559326,"x1":1126,"y1":5277,"payload":{"name":"T1557.001 Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay","description":"establishes temporary NetBIOS share to transfer POS data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"42","type":"asset","x0":913.1999969482422,"y0":5426.33349609375,"x1":1163,"y1":5513,"payload":{"state":"established"}},"type":"relationship","payload":{"type":"state change"}},{"id":"42.33","sourceId":"42","targetId":"33","source":{"id":"42","type":"asset","x0":913.1999969482422,"y0":5426.33349609375,"x1":1163,"y1":5513,"payload":{"state":"established"}},"target":{"id":"33","type":"action","x0":1366.5335960388184,"y0":4946.3334884643555,"x1":1772,"y1":5246,"payload":{"name":"T1074.002 Data Staged: Remote Data Staging","description":"Collects POS information from multiple systems via NetBIOS share. Stores data in an internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"43.41","sourceId":"43","targetId":"41","source":{"id":"43","type":"asset","x0":1859.8665466308594,"y0":5042.866863250732,"x1":2109,"y1":5129,"payload":{"state":"established"}},"target":{"id":"41","type":"data_property","x0":2227.5997772216797,"y0":5045.533226013184,"x1":2485,"y1":5132,"payload":{"target":"internal dump server"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"33.43","sourceId":"33","targetId":"43","source":{"id":"33","type":"action","x0":1366.5335960388184,"y0":4946.3334884643555,"x1":1772,"y1":5246,"payload":{"name":"T1074.002 Data Staged: Remote Data Staging","description":"Collects POS information from multiple systems via NetBIOS share. Stores data in an internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"43","type":"asset","x0":1859.8665466308594,"y0":5042.866863250732,"x1":2109,"y1":5129,"payload":{"state":"established"}},"type":"relationship","payload":{"type":"state change"}},{"id":"43.34","sourceId":"43","targetId":"34","source":{"id":"43","type":"asset","x0":1859.8665466308594,"y0":5042.866863250732,"x1":2109,"y1":5129,"payload":{"state":"established"}},"target":{"id":"34","type":"action","x0":1899.6001243591309,"y0":4348.200225830078,"x1":2305,"y1":4648,"payload":{"name":"Utilizing common protocols","description":"uses common protocols to transfer data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"43.46","sourceId":"43","targetId":"46","source":{"id":"43","type":"asset","x0":1859.8665466308594,"y0":5042.866863250732,"x1":2109,"y1":5129,"payload":{"state":"established"}},"target":{"id":"46","type":"action","x0":1766.0001220703125,"y0":5327.733703613281,"x1":2172,"y1":5627,"payload":{"name":"T1095 Non-Application Layer Protocol","description":"ICMP packet sent to remote server to indicated that data was located on the internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"46.47","sourceId":"46","targetId":"47","source":{"id":"46","type":"action","x0":1766.0001220703125,"y0":5327.733703613281,"x1":2172,"y1":5627,"payload":{"name":"T1095 Non-Application Layer Protocol","description":"ICMP packet sent to remote server to indicated that data was located on the internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"47","type":"asset","x0":1855.0667724609375,"y0":5759.733306884766,"x1":2105,"y1":5846,"payload":{"state":" alert"}},"type":"relationship","payload":{"type":"state change"}},{"id":"47.49","sourceId":"47","targetId":"49","source":{"id":"47","type":"asset","x0":1855.0667724609375,"y0":5759.733306884766,"x1":2105,"y1":5846,"payload":{"state":" alert"}},"target":{"id":"49","type":"data_property","x0":2232.6671142578125,"y0":5753.867141723633,"x1":2490,"y1":5840,"payload":{"target":"ICMP ping"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"52.53","sourceId":"52","targetId":"53","source":{"id":"52","type":"asset","x0":1842.2666625976562,"y0":6371.466857910156,"x1":2092,"y1":6458,"payload":{"state":"exfiltration"}},"target":{"id":"53","type":"data_property","x0":2235.866943359375,"y0":6362.400054931641,"x1":2493,"y1":6449,"payload":{"target":"data from internal dump server"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"50.52","sourceId":"50","targetId":"52","source":{"id":"50","type":"action","x0":1772.4002075195312,"y0":5975.2000732421875,"x1":2178,"y1":6275,"payload":{"name":"Exfiltration of data via unknown means","description":"exfiltration of data from internal dump server to off-site FTP servers","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"52","type":"asset","x0":1842.2666625976562,"y0":6371.466857910156,"x1":2092,"y1":6458,"payload":{"state":"exfiltration"}},"type":"relationship","payload":{"type":"state change"}},{"id":"47.50","sourceId":"47","targetId":"50","source":{"id":"47","type":"asset","x0":1855.0667724609375,"y0":5759.733306884766,"x1":2105,"y1":5846,"payload":{"state":" alert"}},"target":{"id":"50","type":"action","x0":1772.4002075195312,"y0":5975.2000732421875,"x1":2178,"y1":6275,"payload":{"name":"Exfiltration of data via unknown means","description":"exfiltration of data from internal dump server to off-site FTP servers","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"54.5","sourceId":"54","targetId":"5","source":{"id":"54","type":"asset","x0":1368.6668090820312,"y0":761.8666763305664,"x1":1618,"y1":848,"payload":{"state":"recon"}},"target":{"id":"5","type":"action","x0":1011.066656589508,"y0":912.1999931335449,"x1":1417,"y1":1212,"payload":{"name":"T1592.004 Gather Victim Host Information: Client Configurations","description":"gathered information on Target network configurations","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"54.6","sourceId":"54","targetId":"6","source":{"id":"54","type":"asset","x0":1368.6668090820312,"y0":761.8666763305664,"x1":1618,"y1":848,"payload":{"state":"recon"}},"target":{"id":"6","type":"action","x0":1552.93332529068,"y0":910.0667304992676,"x1":1958,"y1":1210,"payload":{"name":"T1593.002 Search Open Websites/Domains: Search Engines","description":"Googled information on Target systems for reconnaissance","timestamp":"","reference":"https://krebsonsecurity.com/2014/02/email-attack-on-vendor-set-up-breach-at-target/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"state"}},{"id":"54.55","sourceId":"54","targetId":"55","source":{"id":"54","type":"asset","x0":1368.6668090820312,"y0":761.8666763305664,"x1":1618,"y1":848,"payload":{"state":"recon"}},"target":{"id":"55","type":"data_property","x0":1761.2000122070312,"y0":762.9333915710449,"x1":2019,"y1":849,"payload":{"target":"Target"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"42.56","sourceId":"42","targetId":"56","source":{"id":"42","type":"asset","x0":913.1999969482422,"y0":5426.33349609375,"x1":1163,"y1":5513,"payload":{"state":"established"}},"target":{"id":"56","type":"data_property","x0":511.6000671386719,"y0":5428.00048828125,"x1":769,"y1":5515,"payload":{"target":"temporary NetBIOS share"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"35.36","sourceId":"35","targetId":"36","source":{"id":"35","type":"action","x0":631.6000900268555,"y0":4368.199905395508,"x1":1037,"y1":4668,"payload":{"name":"T1570 Lateral Tool Transfer","description":"If the local machine time is between 10am - 5pm, then winxml.dll is sent over a temporary NetBIOS share","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"36","type":"asset","x0":710.8000030517578,"y0":4754.600006103516,"x1":960,"y1":4841,"payload":{"state":"compromised"}},"type":"relationship","payload":{"type":"state change"}},{"id":"34.30","sourceId":"34","targetId":"30","source":{"id":"34","type":"action","x0":1899.6001243591309,"y0":4348.200225830078,"x1":2305,"y1":4648,"payload":{"name":"Utilizing common protocols","description":"uses common protocols to transfer data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"30","type":"asset","x0":1250.000015258789,"y0":4260.999855041504,"x1":1500,"y1":4348,"payload":{"state":"identification"}},"type":"relationship","payload":{"type":"state change"}},{"id":"35.57","sourceId":"35","targetId":"57","source":{"id":"35","type":"action","x0":631.6000900268555,"y0":4368.199905395508,"x1":1037,"y1":4668,"payload":{"name":"T1570 Lateral Tool Transfer","description":"If the local machine time is between 10am - 5pm, then winxml.dll is sent over a temporary NetBIOS share","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"57","type":"data_property","x0":246.25,"y0":4487.5,"x1":504,"y1":4574,"payload":{"target":"winxml.dll"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"34.45","sourceId":"34","targetId":"45","source":{"id":"34","type":"action","x0":1899.6001243591309,"y0":4348.200225830078,"x1":2305,"y1":4648,"payload":{"name":"Utilizing common protocols","description":"uses common protocols to transfer data to internal dump server","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"45","type":"data_property","x0":2422.7001342773438,"y0":4433.000106811523,"x1":2680,"y1":4520,"payload":{"target":"ports 139, 443, or 80"}},"type":"data_property_type","payload":{"type":"description"}},{"id":"50.58","sourceId":"50","targetId":"58","source":{"id":"50","type":"action","x0":1772.4002075195312,"y0":5975.2000732421875,"x1":2178,"y1":6275,"payload":{"name":"Exfiltration of data via unknown means","description":"exfiltration of data from internal dump server to off-site FTP servers","timestamp":"","reference":"https://www.zdnet.com/article/anatomy-of-the-target-data-breach-missed-opportunities-and-lessons-learned/","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"58","type":"data_property","x0":2313.75,"y0":6065,"x1":2571,"y1":6152,"payload":{"target":"FTP servers"}},"type":"data_property_type","payload":{"type":"description"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}