{"$schema":"./attack_flow_2022-05-09_16-47-53.json","flow":{"type":"attack-flow","id":"http://flow-1","name":"Attack Flow Export","author":"Unspecified","created":"2022-05-09T12:47:53-04:00"},"actions":[{"id":"http://flow-1/action-1","type":"action","name":"T1078 Valid Accounts","description":"Cisco assesses that the attackers gained initial access through stolen credentials and likely had access to the victim's network for months ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1078/\" \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-3","type":"action","name":"T1059.006 Command and Scripting Interpreter: Python","description":"The malware is written to the C: and executes via Impacket, a publicly available tool, set of python scripts ","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/006/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-4","type":"action","name":"T1542.003 Pre-OS Boot: Bootkit","description":"Executable wipes the MBR and replaces it with a malicious boot loader ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1542/003/\", \"https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/\", \"https://attack.mitre.org/techniques/T1561/002/\" \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-87","type":"action","name":"T1059.001 Command and Scripting Interpreter: Powershell","description":"WhisperGates's MBR code will not run on GPT systems. To hedge against this possibility, the malware executes additional stages. The malware executes a PowerShell command twice to make the machine sleep for 20 seconds","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1059/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-91","type":"action","name":"T1497.003 Virtualization/Sandbox Evasion: Time Based Evasion","description":"In the second stage, the machine sleeps for 20 seconds, likely to evade AV detection ","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND "},{"id":"http://flow-1/action-93","type":"action","name":"T1105 Ingress Tool Transfer","description":"The malware retrieves the third stage of the attack from a Discord channel. It is a JPG file","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1105/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-96","type":"action","name":"T1036 Masquerading","description":"The malware pulls down a JPG file from Discord and reverses the file bytes and loads it as a .NET assembly","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1036/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-99","type":"action","name":"T1027 Obfuscated Files or Information","description":"WhisperGate uses Eazfuscator to obfuscate the .NET malware","timestamp":"","reference":"\"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\", \"https://attack.mitre.org/techniques/T1027/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-101","type":"action","name":"T1059.005 Command and Scripting Interpreter: Visual Basic","description":"The DLL drops a VBScript into the %Temp% directory and executes it. The script modifies Windows Defender settings to exclude the C: from being scanned","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1059/005/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-102","type":"action","name":"T1140 Deobfuscate/Decode Files or Information","description":"The DLL loads an embedded resource into memory and decrypts it using multiple XOR operations. Two resources embedded in the decrypted file: AdvancedRun, Waqybg","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1140/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-107","type":"action","name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"The DLL leverages AdvancedRun to disable Windows Defender. It also leverages PowerShell to delete all the Windows Defender files and directories","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1562/001/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-110","type":"action","name":"T1055 Process Injection","description":"The malware loads the Waqybg resource into memory and restores it as the wiper payload. The DLL then injects the payload into legitimate Windows utility InstallUtil.exe","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1055/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-113","type":"action","name":"T1082 System Information Discovery","description":"The wiper looks for fixed logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1082/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-115","type":"action","name":"T1485 Data Destruction","description":"For each enumeration, the malware wipes the files in the logical drive with specific file extensions, while ignoring files in the %HOMEDRIVE%/Windows directory","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1485/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-116","type":"action","name":"T1561.001 Disk Wipe: Disk Content Wipe","description":"The MBR-wiping code will only run on MBR-style partitions. The fake ransomware note is displayed, and sections of attached drives are overwritten.","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1561/001/\", \"https://www.recordedfuture.com/whispergate-malware-corrupts-computers-ukraine/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-123","type":"action","name":"T1529 System Shutdown/Reboot","description":"WhisperGate attempts to stop all running processes (including itself) by calling ExitWindowsEx API","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\" \"https://attack.mitre.org/techniques/T1529/\" ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-124","type":"action","name":"T1204 User Execution (Shutdown)","description":"WhisperGate does not force a reboot, likely to provide time to execute additional stages of the malware. When the user reboots the machine, the first stage of the malware is executed","timestamp":"","reference":"\"https://blogs.blackberry.com/en/2022/01/threat-thursday-whispergate-wiper\", \"https://attack.mitre.org/techniques/T1204/\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"OR"},{"id":"http://flow-1/action-131","type":"action","name":"T1049 System Network Connections Discovery ","description":"The wiper looks for remote logical drives in the system","timestamp":"","reference":"\"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\", \"https://attack.mitre.org/techniques/T1049/\", ","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-133","type":"action","name":"T1070.004 Indicator Removal on Host: File Deletion","description":"After the wiping process, WhisperGate deletes InstallerUtil.exe\" from the %TEMP% directory","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1070/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"},{"id":"http://flow-1/action-135","type":"action","name":"T1218.004 System Binary Proxy Execution: InstallUtil","description":"The malware executes Waqybg through the legitimate program InstallUtil ","timestamp":"","reference":"\"https://attack.mitre.org/techniques/T1218/004/\", \"https://blog.talosintelligence.com/2022/01/ukraine-campaign-delivers-defacement.html\"","succeeded":0,"confidence":0,"logic_operator_language":"","logic_operator":"AND"}],"assets":[{"id":"http://flow-1/asset-2","type":"asset","state":"Credentials"},{"id":"http://flow-1/asset-86","type":"asset","state":"Master Boot Record "},{"id":"http://flow-1/asset-88","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-90","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-92","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-95","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-98","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-100","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-103","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-106","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-108","type":"asset","state":"Windows Defender"},{"id":"http://flow-1/asset-112","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-114","type":"asset","state":"System Drives"},{"id":"http://flow-1/asset-119","type":"asset","state":"Data"},{"id":"http://flow-1/asset-125","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-129","type":"asset","state":"Data"},{"id":"http://flow-1/asset-132","type":"asset","state":"Machine"},{"id":"http://flow-1/asset-134","type":"asset","state":"Machine"}],"relationships":[{"source":"http://flow-1/action-1","type":"http://flow-1#Compromises","target":"http://flow-1/asset-2"},{"source":"http://flow-1/asset-2","type":"http://flow-1#Compromised","target":"http://flow-1/action-3"},{"source":"http://flow-1/action-3","type":"http://flow-1#Compromises","target":"http://flow-1/asset-86"},{"source":"http://flow-1/asset-86","type":"http://flow-1#Compromised","target":"http://flow-1/action-4"},{"source":"http://flow-1/action-4","type":"http://flow-1#Compromises","target":"http://flow-1/asset-88"},{"source":"http://flow-1/action-87","type":"http://flow-1#Compromises","target":"http://flow-1/asset-90"},{"source":"http://flow-1/asset-90","type":"http://flow-1#Compromised","target":"http://flow-1/action-91"},{"source":"http://flow-1/action-91","type":"http://flow-1#Compromises","target":"http://flow-1/asset-92"},{"source":"http://flow-1/asset-92","type":"http://flow-1#Compromised","target":"http://flow-1/action-93"},{"source":"http://flow-1/action-93","type":"http://flow-1#Compromises","target":"http://flow-1/asset-95"},{"source":"http://flow-1/asset-95","type":"http://flow-1#Compromised","target":"http://flow-1/action-96"},{"source":"http://flow-1/action-96","type":"http://flow-1#Compromises","target":"http://flow-1/asset-98"},{"source":"http://flow-1/asset-98","type":"http://flow-1#Compromised","target":"http://flow-1/action-99"},{"source":"http://flow-1/action-99","type":"http://flow-1#Compromises","target":"http://flow-1/asset-100"},{"source":"http://flow-1/asset-100","type":"http://flow-1#Compromised","target":"http://flow-1/action-101"},{"source":"http://flow-1/action-101","type":"http://flow-1#Compromises","target":"http://flow-1/asset-103"},{"source":"http://flow-1/asset-103","type":"http://flow-1#Compromised","target":"http://flow-1/action-102"},{"source":"http://flow-1/action-102","type":"http://flow-1#Compromises","target":"http://flow-1/asset-106"},{"source":"http://flow-1/asset-106","type":"http://flow-1#Compromised","target":"http://flow-1/action-107"},{"source":"http://flow-1/action-107","type":"http://flow-1#Compromises","target":"http://flow-1/asset-108"},{"source":"http://flow-1/asset-108","type":"http://flow-1#Compromised","target":"http://flow-1/action-110"},{"source":"http://flow-1/asset-112","type":"http://flow-1#Compromised","target":"http://flow-1/action-113"},{"source":"http://flow-1/action-113","type":"http://flow-1#Compromises","target":"http://flow-1/asset-114"},{"source":"http://flow-1/action-116","type":"http://flow-1#Compromises","target":"http://flow-1/asset-119"},{"source":"http://flow-1/asset-88","type":"http://flow-1#Compromised","target":"http://flow-1/action-87"},{"source":"http://flow-1/asset-114","type":"http://flow-1#Compromised","target":"http://flow-1/action-115"},{"source":"http://flow-1/asset-125","type":"http://flow-1#Compromised","target":"http://flow-1/action-116"},{"source":"http://flow-1/action-124","type":"http://flow-1#Compromises","target":"http://flow-1/asset-125"},{"source":"http://flow-1/asset-88","type":"http://flow-1#Compromised","target":"http://flow-1/action-124"},{"source":"http://flow-1/asset-112","type":"http://flow-1#Compromised","target":"http://flow-1/action-131"},{"source":"http://flow-1/action-131","type":"http://flow-1#Compromises","target":"http://flow-1/asset-114"},{"source":"http://flow-1/action-115","type":"http://flow-1#Compromises","target":"http://flow-1/asset-129"},{"source":"http://flow-1/asset-129","type":"http://flow-1#Compromised","target":"http://flow-1/action-133"},{"source":"http://flow-1/action-133","type":"http://flow-1#Compromises","target":"http://flow-1/asset-132"},{"source":"http://flow-1/asset-132","type":"http://flow-1#Compromised","target":"http://flow-1/action-123"},{"source":"http://flow-1/action-110","type":"http://flow-1#Compromises","target":"http://flow-1/asset-134"},{"source":"http://flow-1/asset-134","type":"http://flow-1#Compromised","target":"http://flow-1/action-135"},{"source":"http://flow-1/action-135","type":"http://flow-1#Compromises","target":"http://flow-1/asset-112"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-1"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-3"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-4"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-87"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-91"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-93"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-96"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-99"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-101"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-102"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-107"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-110"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-113"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-115"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-116"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-123"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-124"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-131"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-133"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/action-135"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-2"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-86"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-88"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-90"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-92"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-95"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-98"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-100"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-103"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-106"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-108"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-112"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-114"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-119"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-125"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-129"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-132"},{"source":"http://flow-1","type":"http://flow-1#flow-edge","target":"http://flow-1/asset-134"}],"object_properties":[],"data_properties":[{"source":"http://flow-1/action-3","type":"http://flow-1#Description-","target":"Impacket"},{"source":"http://flow-1/action-93","type":"http://flow-1#Description-","target":"Discord Channel"},{"source":"http://flow-1/action-96","type":"http://flow-1#Description-","target":"JPG File"},{"source":"http://flow-1/action-102","type":"http://flow-1#Description","target":"AdvancedRun"},{"source":"http://flow-1/action-102","type":"http://flow-1#Description-","target":"Waqybg"},{"source":"http://flow-1/asset-108","type":"http://flow-1#Description-","target":"Disabled"},{"source":"http://flow-1/action-116","type":"http://flow-1#Description","target":"Ransomware Note Displayed"},{"source":"http://flow-1/action-116","type":"http://flow-1#Description-","target":"MBR-Style Partition"},{"source":"http://flow-1/asset-119","type":"http://flow-1#Description","target":"Wiped"},{"source":"http://flow-1/action-99","type":"http://flow-1#Description-","target":"Eazfuscator"},{"source":"http://flow-1/action-107","type":"http://flow-1#Description-","target":"AdvancedRun"},{"source":"http://flow-1/action-110","type":"http://flow-1#Description-","target":"Waqybg"},{"source":"http://flow-1/asset-129","type":"http://flow-1#Description-","target":"Wiped"}]}