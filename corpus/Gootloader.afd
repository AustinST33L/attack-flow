{"namespace":"flow-1","canvas":{"cameraX":925,"cameraY":7191,"padding":45,"pageSizeX":800,"pageSizeY":800},"nodes":[{"id":"1","type":"action","x0":1259,"y0":86,"x1":1653,"y1":390,"payload":{"name":"T1189 Drive-by Compromise","description":"The threat actor gained initial access using Gootloader malware. The user searched and browsed for the malware via the poisoned SEO search. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"2","type":"asset","x0":1341,"y0":511,"x1":1576,"y1":598,"payload":{"state":"Compromised"}},{"id":"3","type":"action","x0":954,"y0":767,"x1":1348,"y1":1071,"payload":{"name":"T1204.001 User Execution: Malicious Link","description":"Once the user navigated to the compromised website, a forum looking page was displayed and the user clicked on a link","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"4","type":"action","x0":1555,"y0":769,"x1":1949,"y1":1073,"payload":{"name":"T1204.002 User Execution: Malicious File","description":"The user clicked on a link, which downloaded a file that the user accidentally executes","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"5","type":"asset","x0":1321,"y0":1212,"x1":1556,"y1":1299,"payload":{"state":"Compromised"}},{"id":"6","type":"action","x0":1245,"y0":1430,"x1":1639,"y1":1734,"payload":{"name":"T1059.007 Command and Scripting Interpreter: JavaScript","description":"The user double clicks on the zip file and the malicious Javascript file is executed ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"7","type":"asset","x0":1326,"y0":1841,"x1":1561,"y1":1928,"payload":{"state":"Compromised"}},{"id":"8","type":"action","x0":1248,"y0":3486,"x1":1642,"y1":3790,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":".NET loader is executed which decodes a Cobalt Strike payload from the registry and loads and executes the payload. Rundll32 is often used to load the Cobalt Strike beacons into memory on the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"9","type":"action","x0":1111,"y0":2759,"x1":1505,"y1":3063,"payload":{"name":"T1053 Scheduled Task/Job","description":" The encoded PowerShell script  creates a Scheduled Task that executes when the user logs on to the computer. The encoded PowerShell command reads .NET loader from the registry and loads it into PowerShell. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"10","type":"data_property","x0":806,"y0":3593,"x1":1048,"y1":3680,"payload":{"target":"Cobalt Strike beacons"}},{"id":"11","type":"action","x0":1249,"y0":2078,"x1":1643,"y1":2382,"payload":{"name":"T1112 Modify Registry","description":"Upon execution, Gootloader creates two registry keys, the first is populated with an encoded Cobalt Strike payload and the latter stores a .NET loader","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"12","type":"data_property","x0":1819,"y0":2135,"x1":2061,"y1":2222,"payload":{"target":"Cobalt Strike payload"}},{"id":"13","type":"data_property","x0":1821,"y0":2267,"x1":2063,"y1":2354,"payload":{"target":".NET loader"}},{"id":"14","type":"asset","x0":1333,"y0":2546,"x1":1568,"y1":2633,"payload":{"state":"Compromised"}},{"id":"15","type":"action","x0":743,"y0":4136,"x1":1137,"y1":4440,"payload":{"name":"T1087 Account Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"16","type":"asset","x0":1330,"y0":3204,"x1":1565,"y1":3291,"payload":{"state":"Compromised"}},{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},{"id":"18","type":"action","x0":1250,"y0":4136,"x1":1644,"y1":4440,"payload":{"name":"T1482 Domain Trust Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"19","type":"action","x0":1813,"y0":4130,"x1":2207,"y1":4434,"payload":{"name":"T1615 Group Policy Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},{"id":"21","type":"action","x0":1251,"y0":4872,"x1":1645,"y1":5176,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"The attackers then pivoted to a workstation host via a Cobalt Strike Powershell beacon ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"24","type":"asset","x0":1333,"y0":5296,"x1":1568,"y1":5383,"payload":{"state":"Compromised"}},{"id":"25","type":"asset","x0":1337,"y0":5947,"x1":1572,"y1":6034,"payload":{"state":"Compromised"}},{"id":"26","type":"action","x0":1263,"y0":6747,"x1":1657,"y1":7051,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"The attackers then ran a WMI command on the beachhead host to check for AntiVirus","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"27","type":"data_property","x0":1666,"y0":511,"x1":1908,"y1":598,"payload":{"target":"Beachhead Host"}},{"id":"28","type":"data_property","x0":1636,"y0":1212,"x1":1878,"y1":1299,"payload":{"target":"Beachhead Host"}},{"id":"29","type":"data_property","x0":1638,"y0":1841,"x1":1880,"y1":1928,"payload":{"target":"Beachhead Host"}},{"id":"30","type":"data_property","x0":1643,"y0":2546,"x1":1885,"y1":2633,"payload":{"target":"Registry"}},{"id":"31","type":"data_property","x0":1666,"y0":3204,"x1":1908,"y1":3291,"payload":{"target":"Beachhead Host"}},{"id":"32","type":"data_property","x0":1664,"y0":3913,"x1":1906,"y1":4000,"payload":{"target":"Beachhead Host"}},{"id":"33","type":"data_property","x0":973,"y0":4586,"x1":1215,"y1":4673,"payload":{"target":"AD Domain"}},{"id":"34","type":"data_property","x0":975,"y0":4701,"x1":1217,"y1":4788,"payload":{"target":"Beachhead Host"}},{"id":"35","type":"data_property","x0":1682,"y0":5294,"x1":1924,"y1":5381,"payload":{"target":"Workstation"}},{"id":"36","type":"data_property","x0":1670,"y0":5915,"x1":1912,"y1":6002,"payload":{"target":"Workstation"}},{"id":"37","type":"asset","x0":1345,"y0":7157,"x1":1580,"y1":7244,"payload":{"state":"Compromised"}},{"id":"38","type":"data_property","x0":1732,"y0":7154,"x1":1974,"y1":7241,"payload":{"target":"Beachhead Host"}},{"id":"39","type":"action","x0":1268,"y0":7375,"x1":1662,"y1":7679,"payload":{"name":"T1555 Credentials from Password Stores","description":"On the beachhead host, the threat actors ran Mimikatz via Powershell to harvest credentials","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"40","type":"data_property","x0":1797,"y0":7479,"x1":2039,"y1":7566,"payload":{"target":"Mimikatz"}},{"id":"41","type":"data_property","x0":1708,"y0":7708,"x1":1950,"y1":7795,"payload":{"target":"Beachhead Host"}},{"id":"42","type":"asset","x0":1344,"y0":7754,"x1":1579,"y1":7841,"payload":{"state":"Compromised"}},{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},{"id":"44","type":"data_property","x0":1753,"y0":8198,"x1":1995,"y1":8285,"payload":{"target":"Workstation"}},{"id":"45","type":"action","x0":1258,"y0":7902,"x1":1652,"y1":8206,"payload":{"name":"T1555 Credentials from Password Stores","description":"The threat actors then ran LaZagne to retrieve all saved credentials from the pivoted workstation","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"46","type":"data_property","x0":1756,"y0":8007,"x1":1998,"y1":8094,"payload":{"target":"LaZagne"}},{"id":"47","type":"data_property","x0":1758,"y0":8323,"x1":2000,"y1":8410,"payload":{"target":"Credentials"}},{"id":"48","type":"data_property","x0":1709,"y0":7823,"x1":1951,"y1":7910,"payload":{"target":"Credentials"}},{"id":"49","type":"action","x0":1537,"y0":8442,"x1":1931,"y1":8746,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"With the harvested credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"52","type":"data_property","x0":666,"y0":8553,"x1":908,"y1":8640,"payload":{"target":"Restricted Admin Mode"}},{"id":"53","type":"action","x0":1037,"y0":9042,"x1":1431,"y1":9346,"payload":{"name":" T1021.002 Remote Services: SMB/Windows Admin Shares","description":"The threat actors then targeted several other workstations with Cobalt Strike executables, but no other activity was observed on the endpoints after this lateral movement. SMB was used to transfer the executable Cobalt Strike beacons","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"54","type":"action","x0":1493,"y0":9701,"x1":1887,"y1":10005,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"The attackers logged into the Domain Controller through RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"55","type":"asset","x0":885,"y0":9473,"x1":1120,"y1":9560,"payload":{"state":"Compromised"}},{"id":"56","type":"data_property","x0":1228,"y0":9470,"x1":1470,"y1":9557,"payload":{"target":"3 Other Workstations"}},{"id":"57","type":"action","x0":1008,"y0":8441,"x1":1402,"y1":8745,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"Prior to lateral movement via RDP, the actors enabled Restricted Admin Mode through remote WMI. RAM only requires knowledge of the password hash, not the cleartext password","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},{"id":"59","type":"data_property","x0":1725,"y0":8812,"x1":1967,"y1":8899,"payload":{"target":"Workstation"}},{"id":"60","type":"action","x0":1255,"y0":5514,"x1":1649,"y1":5818,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"After pivoting, the actors disabled Windows Defender logs","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"62","type":"action","x0":1508,"y0":9042,"x1":1902,"y1":9346,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"The attackers enabled Restricted Admin Mode via remote WMI prior to attempting to RDP into the Domain Controller from the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"63","type":"asset","x0":1568,"y0":9459,"x1":1803,"y1":9546,"payload":{"state":"Compromised"}},{"id":"64","type":"data_property","x0":1904,"y0":9457,"x1":2146,"y1":9544,"payload":{"target":"Domain Controller"}},{"id":"66","type":"data_property","x0":2071,"y0":9151,"x1":2313,"y1":9238,"payload":{"target":"Restricted Admin Mode"}},{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},{"id":"69","type":"data_property","x0":1974,"y0":10125,"x1":2216,"y1":10212,"payload":{"target":"Domain Controller"}},{"id":"70","type":"action","x0":999,"y0":10349,"x1":1393,"y1":10653,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"Cobalt Strike PowerShell payload executed through PowerShell via RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"71","type":"action","x0":1497,"y0":10360,"x1":1891,"y1":10664,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Microsoft Defender Scheduled Tasks Deleted","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"72","type":"action","x0":2074,"y0":10341,"x1":2468,"y1":10645,"payload":{"name":"T1555 Credentials from Password Stores","description":"LaZagne dropped and executed","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"73","type":"data_property","x0":1670,"y0":6025,"x1":1912,"y1":6112,"payload":{"target":"Windows Defender"}},{"id":"75","type":"data_property","x0":2618,"y0":10444,"x1":2860,"y1":10531,"payload":{"target":"LaZagne"}},{"id":"76","type":"data_property","x0":1760,"y0":4980,"x1":2002,"y1":5067,"payload":{"target":"Cobalt Strike beacon"}},{"id":"77","type":"asset","x0":2185,"y0":10844,"x1":2420,"y1":10931,"payload":{"state":"Compromised"}},{"id":"78","type":"data_property","x0":2551,"y0":10868,"x1":2793,"y1":10955,"payload":{"target":"Credentials"}},{"id":"81","type":"data_property","x0":1890,"y0":10827,"x1":2132,"y1":10914,"payload":{"target":"Windows Defender"}},{"id":"82","type":"data_property","x0":807,"y0":10901,"x1":1049,"y1":10988,"payload":{"target":"Domain Controller"}},{"id":"83","type":"asset","x0":1577,"y0":10761,"x1":1812,"y1":10848,"payload":{"state":"Compromised"}},{"id":"84","type":"asset","x0":1174,"y0":10900,"x1":1409,"y1":10987,"payload":{"state":"Compromised"}},{"id":"85","type":"action","x0":1498,"y0":10950,"x1":1892,"y1":11254,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The attackers then began looking for documents on file shares via RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"86","type":"data_property","x0":1884,"y0":10720,"x1":2126,"y1":10807,"payload":{"target":"Domain Controller"}},{"id":"87","type":"data_property","x0":2536,"y0":10758,"x1":2778,"y1":10845,"payload":{"target":"Domain Controller"}},{"id":"88","type":"asset","x0":1579,"y0":11361,"x1":1814,"y1":11448,"payload":{"state":"Compromised"}},{"id":"91","type":"data_property","x0":1913,"y0":11295,"x1":2155,"y1":11382,"payload":{"target":"File Server Data "}},{"id":"92","type":"action","x0":1500,"y0":11571,"x1":1894,"y1":11875,"payload":{"name":"T1046 Network Service Discovery","description":"The threat actors ran Advanced IP scanner from the domain controller via the RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"93","type":"data_property","x0":2023,"y0":11676,"x1":2265,"y1":11763,"payload":{"target":"Advanced IP Scanner"}},{"id":"94","type":"asset","x0":1581,"y0":11970,"x1":1816,"y1":12057,"payload":{"state":"Scanned"}},{"id":"95","type":"data_property","x0":1940,"y0":11967,"x1":2182,"y1":12054,"payload":{"target":"Network Ports"}},{"id":"96","type":"action","x0":1505,"y0":12150,"x1":1899,"y1":12454,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The file server SMB shares were accessed from the DC ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"97","type":"asset","x0":1587,"y0":12557,"x1":1822,"y1":12644,"payload":{"state":"Compromised"}},{"id":"98","type":"data_property","x0":1899,"y0":12511,"x1":2141,"y1":12598,"payload":{"target":"File Server"}},{"id":"99","type":"data_property","x0":1896,"y0":12631,"x1":2138,"y1":12718,"payload":{"target":"SMB Share Data"}},{"id":"100","type":"action","x0":1507,"y0":12754,"x1":1901,"y1":13058,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"RDP Connection to Backup Server to look for files","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"101","type":"asset","x0":1587,"y0":13158,"x1":1822,"y1":13245,"payload":{"state":"Compromised"}},{"id":"103","type":"data_property","x0":1952,"y0":13158,"x1":2194,"y1":13245,"payload":{"target":"Backup Server Data"}},{"id":"105","type":"action","x0":1563,"y0":2766,"x1":1957,"y1":3070,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell","description":"Following the registry events, a PS command was launched that extracts the .NET loader from the registry and executes the code in memory via Assembly.Load()","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"106","type":"action","x0":1260,"y0":6121,"x1":1654,"y1":6425,"payload":{"name":"T1059: Command and Scripting Interpreter","description":"The attackers then executed a second Cobalt Strike payload for a different C2 server","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},{"id":"107","type":"asset","x0":1341,"y0":6541,"x1":1576,"y1":6628,"payload":{"state":"Compromised"}},{"id":"108","type":"data_property","x0":1658,"y0":6540,"x1":1900,"y1":6627,"payload":{"target":"Workstation"}},{"id":"109","type":"data_property","x0":1763,"y0":6855,"x1":2005,"y1":6942,"payload":{"target":"Antivirus"}},{"id":"110","type":"data_property","x0":1924,"y0":11411,"x1":2166,"y1":11498,"payload":{"target":"Domain Controller"}}],"edges":[{"id":"1.2","sourceId":"1","targetId":"2","source":{"id":"1","type":"action","x0":1259,"y0":86,"x1":1653,"y1":390,"payload":{"name":"T1189 Drive-by Compromise","description":"The threat actor gained initial access using Gootloader malware. The user searched and browsed for the malware via the poisoned SEO search. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"2","type":"asset","x0":1341,"y0":511,"x1":1576,"y1":598,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"2.3","sourceId":"2","targetId":"3","source":{"id":"2","type":"asset","x0":1341,"y0":511,"x1":1576,"y1":598,"payload":{"state":"Compromised"}},"target":{"id":"3","type":"action","x0":954,"y0":767,"x1":1348,"y1":1071,"payload":{"name":"T1204.001 User Execution: Malicious Link","description":"Once the user navigated to the compromised website, a forum looking page was displayed and the user clicked on a link","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"2.4","sourceId":"2","targetId":"4","source":{"id":"2","type":"asset","x0":1341,"y0":511,"x1":1576,"y1":598,"payload":{"state":"Compromised"}},"target":{"id":"4","type":"action","x0":1555,"y0":769,"x1":1949,"y1":1073,"payload":{"name":"T1204.002 User Execution: Malicious File","description":"The user clicked on a link, which downloaded a file that the user accidentally executes","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"3.5","sourceId":"3","targetId":"5","source":{"id":"3","type":"action","x0":954,"y0":767,"x1":1348,"y1":1071,"payload":{"name":"T1204.001 User Execution: Malicious Link","description":"Once the user navigated to the compromised website, a forum looking page was displayed and the user clicked on a link","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"5","type":"asset","x0":1321,"y0":1212,"x1":1556,"y1":1299,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"4.5","sourceId":"4","targetId":"5","source":{"id":"4","type":"action","x0":1555,"y0":769,"x1":1949,"y1":1073,"payload":{"name":"T1204.002 User Execution: Malicious File","description":"The user clicked on a link, which downloaded a file that the user accidentally executes","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"5","type":"asset","x0":1321,"y0":1212,"x1":1556,"y1":1299,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"5.6","sourceId":"5","targetId":"6","source":{"id":"5","type":"asset","x0":1321,"y0":1212,"x1":1556,"y1":1299,"payload":{"state":"Compromised"}},"target":{"id":"6","type":"action","x0":1245,"y0":1430,"x1":1639,"y1":1734,"payload":{"name":"T1059.007 Command and Scripting Interpreter: JavaScript","description":"The user double clicks on the zip file and the malicious Javascript file is executed ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"6.7","sourceId":"6","targetId":"7","source":{"id":"6","type":"action","x0":1245,"y0":1430,"x1":1639,"y1":1734,"payload":{"name":"T1059.007 Command and Scripting Interpreter: JavaScript","description":"The user double clicks on the zip file and the malicious Javascript file is executed ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"7","type":"asset","x0":1326,"y0":1841,"x1":1561,"y1":1928,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"8.10","sourceId":"8","targetId":"10","source":{"id":"8","type":"action","x0":1248,"y0":3486,"x1":1642,"y1":3790,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":".NET loader is executed which decodes a Cobalt Strike payload from the registry and loads and executes the payload. Rundll32 is often used to load the Cobalt Strike beacons into memory on the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"10","type":"data_property","x0":806,"y0":3593,"x1":1048,"y1":3680,"payload":{"target":"Cobalt Strike beacons"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"7.11","sourceId":"7","targetId":"11","source":{"id":"7","type":"asset","x0":1326,"y0":1841,"x1":1561,"y1":1928,"payload":{"state":"Compromised"}},"target":{"id":"11","type":"action","x0":1249,"y0":2078,"x1":1643,"y1":2382,"payload":{"name":"T1112 Modify Registry","description":"Upon execution, Gootloader creates two registry keys, the first is populated with an encoded Cobalt Strike payload and the latter stores a .NET loader","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"11.13","sourceId":"11","targetId":"13","source":{"id":"11","type":"action","x0":1249,"y0":2078,"x1":1643,"y1":2382,"payload":{"name":"T1112 Modify Registry","description":"Upon execution, Gootloader creates two registry keys, the first is populated with an encoded Cobalt Strike payload and the latter stores a .NET loader","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"13","type":"data_property","x0":1821,"y0":2267,"x1":2063,"y1":2354,"payload":{"target":".NET loader"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"11.12","sourceId":"11","targetId":"12","source":{"id":"11","type":"action","x0":1249,"y0":2078,"x1":1643,"y1":2382,"payload":{"name":"T1112 Modify Registry","description":"Upon execution, Gootloader creates two registry keys, the first is populated with an encoded Cobalt Strike payload and the latter stores a .NET loader","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"12","type":"data_property","x0":1819,"y0":2135,"x1":2061,"y1":2222,"payload":{"target":"Cobalt Strike payload"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"11.14","sourceId":"11","targetId":"14","source":{"id":"11","type":"action","x0":1249,"y0":2078,"x1":1643,"y1":2382,"payload":{"name":"T1112 Modify Registry","description":"Upon execution, Gootloader creates two registry keys, the first is populated with an encoded Cobalt Strike payload and the latter stores a .NET loader","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"14","type":"asset","x0":1333,"y0":2546,"x1":1568,"y1":2633,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"14.9","sourceId":"14","targetId":"9","source":{"id":"14","type":"asset","x0":1333,"y0":2546,"x1":1568,"y1":2633,"payload":{"state":"Compromised"}},"target":{"id":"9","type":"action","x0":1111,"y0":2759,"x1":1505,"y1":3063,"payload":{"name":"T1053 Scheduled Task/Job","description":" The encoded PowerShell script  creates a Scheduled Task that executes when the user logs on to the computer. The encoded PowerShell command reads .NET loader from the registry and loads it into PowerShell. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"9.16","sourceId":"9","targetId":"16","source":{"id":"9","type":"action","x0":1111,"y0":2759,"x1":1505,"y1":3063,"payload":{"name":"T1053 Scheduled Task/Job","description":" The encoded PowerShell script  creates a Scheduled Task that executes when the user logs on to the computer. The encoded PowerShell command reads .NET loader from the registry and loads it into PowerShell. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"16","type":"asset","x0":1330,"y0":3204,"x1":1565,"y1":3291,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"16.8","sourceId":"16","targetId":"8","source":{"id":"16","type":"asset","x0":1330,"y0":3204,"x1":1565,"y1":3291,"payload":{"state":"Compromised"}},"target":{"id":"8","type":"action","x0":1248,"y0":3486,"x1":1642,"y1":3790,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":".NET loader is executed which decodes a Cobalt Strike payload from the registry and loads and executes the payload. Rundll32 is often used to load the Cobalt Strike beacons into memory on the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"8.17","sourceId":"8","targetId":"17","source":{"id":"8","type":"action","x0":1248,"y0":3486,"x1":1642,"y1":3790,"payload":{"name":"T1218.011 System Binary Proxy Execution: Rundll32","description":".NET loader is executed which decodes a Cobalt Strike payload from the registry and loads and executes the payload. Rundll32 is often used to load the Cobalt Strike beacons into memory on the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"17.15","sourceId":"17","targetId":"15","source":{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},"target":{"id":"15","type":"action","x0":743,"y0":4136,"x1":1137,"y1":4440,"payload":{"name":"T1087 Account Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"17.18","sourceId":"17","targetId":"18","source":{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},"target":{"id":"18","type":"action","x0":1250,"y0":4136,"x1":1644,"y1":4440,"payload":{"name":"T1482 Domain Trust Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"17.19","sourceId":"17","targetId":"19","source":{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},"target":{"id":"19","type":"action","x0":1813,"y0":4130,"x1":2207,"y1":4434,"payload":{"name":"T1615 Group Policy Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"15.20","sourceId":"15","targetId":"20","source":{"id":"15","type":"action","x0":743,"y0":4136,"x1":1137,"y1":4440,"payload":{"name":"T1087 Account Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"19.20","sourceId":"19","targetId":"20","source":{"id":"19","type":"action","x0":1813,"y0":4130,"x1":2207,"y1":4434,"payload":{"name":"T1615 Group Policy Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"18.20","sourceId":"18","targetId":"20","source":{"id":"18","type":"action","x0":1250,"y0":4136,"x1":1644,"y1":4440,"payload":{"name":"T1482 Domain Trust Discovery","description":"The threat actors used Bloodhound on the beachhead to enumerate the Active Directory domain ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"20.21","sourceId":"20","targetId":"21","source":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"target":{"id":"21","type":"action","x0":1251,"y0":4872,"x1":1645,"y1":5176,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"The attackers then pivoted to a workstation host via a Cobalt Strike Powershell beacon ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"21.24","sourceId":"21","targetId":"24","source":{"id":"21","type":"action","x0":1251,"y0":4872,"x1":1645,"y1":5176,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"The attackers then pivoted to a workstation host via a Cobalt Strike Powershell beacon ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"24","type":"asset","x0":1333,"y0":5296,"x1":1568,"y1":5383,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"2.27","sourceId":"2","targetId":"27","source":{"id":"2","type":"asset","x0":1341,"y0":511,"x1":1576,"y1":598,"payload":{"state":"Compromised"}},"target":{"id":"27","type":"data_property","x0":1666,"y0":511,"x1":1908,"y1":598,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"5.28","sourceId":"5","targetId":"28","source":{"id":"5","type":"asset","x0":1321,"y0":1212,"x1":1556,"y1":1299,"payload":{"state":"Compromised"}},"target":{"id":"28","type":"data_property","x0":1636,"y0":1212,"x1":1878,"y1":1299,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"7.29","sourceId":"7","targetId":"29","source":{"id":"7","type":"asset","x0":1326,"y0":1841,"x1":1561,"y1":1928,"payload":{"state":"Compromised"}},"target":{"id":"29","type":"data_property","x0":1638,"y0":1841,"x1":1880,"y1":1928,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"14.30","sourceId":"14","targetId":"30","source":{"id":"14","type":"asset","x0":1333,"y0":2546,"x1":1568,"y1":2633,"payload":{"state":"Compromised"}},"target":{"id":"30","type":"data_property","x0":1643,"y0":2546,"x1":1885,"y1":2633,"payload":{"target":"Registry"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"16.31","sourceId":"16","targetId":"31","source":{"id":"16","type":"asset","x0":1330,"y0":3204,"x1":1565,"y1":3291,"payload":{"state":"Compromised"}},"target":{"id":"31","type":"data_property","x0":1666,"y0":3204,"x1":1908,"y1":3291,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"17.32","sourceId":"17","targetId":"32","source":{"id":"17","type":"asset","x0":1327,"y0":3914,"x1":1562,"y1":4001,"payload":{"state":"Compromised"}},"target":{"id":"32","type":"data_property","x0":1664,"y0":3913,"x1":1906,"y1":4000,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"20.33","sourceId":"20","targetId":"33","source":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"target":{"id":"33","type":"data_property","x0":973,"y0":4586,"x1":1215,"y1":4673,"payload":{"target":"AD Domain"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"20.34","sourceId":"20","targetId":"34","source":{"id":"20","type":"asset","x0":1331,"y0":4656,"x1":1566,"y1":4743,"payload":{"state":"Enumerated"}},"target":{"id":"34","type":"data_property","x0":975,"y0":4701,"x1":1217,"y1":4788,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"24.35","sourceId":"24","targetId":"35","source":{"id":"24","type":"asset","x0":1333,"y0":5296,"x1":1568,"y1":5383,"payload":{"state":"Compromised"}},"target":{"id":"35","type":"data_property","x0":1682,"y0":5294,"x1":1924,"y1":5381,"payload":{"target":"Workstation"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"25.36","sourceId":"25","targetId":"36","source":{"id":"25","type":"asset","x0":1337,"y0":5947,"x1":1572,"y1":6034,"payload":{"state":"Compromised"}},"target":{"id":"36","type":"data_property","x0":1670,"y0":5915,"x1":1912,"y1":6002,"payload":{"target":"Workstation"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"26.37","sourceId":"26","targetId":"37","source":{"id":"26","type":"action","x0":1263,"y0":6747,"x1":1657,"y1":7051,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"The attackers then ran a WMI command on the beachhead host to check for AntiVirus","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"37","type":"asset","x0":1345,"y0":7157,"x1":1580,"y1":7244,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"37.38","sourceId":"37","targetId":"38","source":{"id":"37","type":"asset","x0":1345,"y0":7157,"x1":1580,"y1":7244,"payload":{"state":"Compromised"}},"target":{"id":"38","type":"data_property","x0":1732,"y0":7154,"x1":1974,"y1":7241,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"37.39","sourceId":"37","targetId":"39","source":{"id":"37","type":"asset","x0":1345,"y0":7157,"x1":1580,"y1":7244,"payload":{"state":"Compromised"}},"target":{"id":"39","type":"action","x0":1268,"y0":7375,"x1":1662,"y1":7679,"payload":{"name":"T1555 Credentials from Password Stores","description":"On the beachhead host, the threat actors ran Mimikatz via Powershell to harvest credentials","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"42.41","sourceId":"42","targetId":"41","source":{"id":"42","type":"asset","x0":1344,"y0":7754,"x1":1579,"y1":7841,"payload":{"state":"Compromised"}},"target":{"id":"41","type":"data_property","x0":1708,"y0":7708,"x1":1950,"y1":7795,"payload":{"target":"Beachhead Host"}},"type":"data_property_type","payload":{"type":"Description "}},{"id":"39.42","sourceId":"39","targetId":"42","source":{"id":"39","type":"action","x0":1268,"y0":7375,"x1":1662,"y1":7679,"payload":{"name":"T1555 Credentials from Password Stores","description":"On the beachhead host, the threat actors ran Mimikatz via Powershell to harvest credentials","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"42","type":"asset","x0":1344,"y0":7754,"x1":1579,"y1":7841,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"39.40","sourceId":"39","targetId":"40","source":{"id":"39","type":"action","x0":1268,"y0":7375,"x1":1662,"y1":7679,"payload":{"name":"T1555 Credentials from Password Stores","description":"On the beachhead host, the threat actors ran Mimikatz via Powershell to harvest credentials","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"40","type":"data_property","x0":1797,"y0":7479,"x1":2039,"y1":7566,"payload":{"target":"Mimikatz"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"42.45","sourceId":"42","targetId":"45","source":{"id":"42","type":"asset","x0":1344,"y0":7754,"x1":1579,"y1":7841,"payload":{"state":"Compromised"}},"target":{"id":"45","type":"action","x0":1258,"y0":7902,"x1":1652,"y1":8206,"payload":{"name":"T1555 Credentials from Password Stores","description":"The threat actors then ran LaZagne to retrieve all saved credentials from the pivoted workstation","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"43.44","sourceId":"43","targetId":"44","source":{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},"target":{"id":"44","type":"data_property","x0":1753,"y0":8198,"x1":1995,"y1":8285,"payload":{"target":"Workstation"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"45.43","sourceId":"45","targetId":"43","source":{"id":"45","type":"action","x0":1258,"y0":7902,"x1":1652,"y1":8206,"payload":{"name":"T1555 Credentials from Password Stores","description":"The threat actors then ran LaZagne to retrieve all saved credentials from the pivoted workstation","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"45.46","sourceId":"45","targetId":"46","source":{"id":"45","type":"action","x0":1258,"y0":7902,"x1":1652,"y1":8206,"payload":{"name":"T1555 Credentials from Password Stores","description":"The threat actors then ran LaZagne to retrieve all saved credentials from the pivoted workstation","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"46","type":"data_property","x0":1756,"y0":8007,"x1":1998,"y1":8094,"payload":{"target":"LaZagne"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"43.47","sourceId":"43","targetId":"47","source":{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},"target":{"id":"47","type":"data_property","x0":1758,"y0":8323,"x1":2000,"y1":8410,"payload":{"target":"Credentials"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"42.48","sourceId":"42","targetId":"48","source":{"id":"42","type":"asset","x0":1344,"y0":7754,"x1":1579,"y1":7841,"payload":{"state":"Compromised"}},"target":{"id":"48","type":"data_property","x0":1709,"y0":7823,"x1":1951,"y1":7910,"payload":{"target":"Credentials"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"55.56","sourceId":"55","targetId":"56","source":{"id":"55","type":"asset","x0":885,"y0":9473,"x1":1120,"y1":9560,"payload":{"state":"Compromised"}},"target":{"id":"56","type":"data_property","x0":1228,"y0":9470,"x1":1470,"y1":9557,"payload":{"target":"3 Other Workstations"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"53.55","sourceId":"53","targetId":"55","source":{"id":"53","type":"action","x0":1037,"y0":9042,"x1":1431,"y1":9346,"payload":{"name":" T1021.002 Remote Services: SMB/Windows Admin Shares","description":"The threat actors then targeted several other workstations with Cobalt Strike executables, but no other activity was observed on the endpoints after this lateral movement. SMB was used to transfer the executable Cobalt Strike beacons","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"55","type":"asset","x0":885,"y0":9473,"x1":1120,"y1":9560,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"43.57","sourceId":"43","targetId":"57","source":{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},"target":{"id":"57","type":"action","x0":1008,"y0":8441,"x1":1402,"y1":8745,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"Prior to lateral movement via RDP, the actors enabled Restricted Admin Mode through remote WMI. RAM only requires knowledge of the password hash, not the cleartext password","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"57.58","sourceId":"57","targetId":"58","source":{"id":"57","type":"action","x0":1008,"y0":8441,"x1":1402,"y1":8745,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"Prior to lateral movement via RDP, the actors enabled Restricted Admin Mode through remote WMI. RAM only requires knowledge of the password hash, not the cleartext password","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"43.49","sourceId":"43","targetId":"49","source":{"id":"43","type":"asset","x0":1337,"y0":8266,"x1":1572,"y1":8353,"payload":{"state":"Compromised"}},"target":{"id":"49","type":"action","x0":1537,"y0":8442,"x1":1931,"y1":8746,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"With the harvested credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"57.52","sourceId":"57","targetId":"52","source":{"id":"57","type":"action","x0":1008,"y0":8441,"x1":1402,"y1":8745,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"Prior to lateral movement via RDP, the actors enabled Restricted Admin Mode through remote WMI. RAM only requires knowledge of the password hash, not the cleartext password","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"52","type":"data_property","x0":666,"y0":8553,"x1":908,"y1":8640,"payload":{"target":"Restricted Admin Mode"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"49.58","sourceId":"49","targetId":"58","source":{"id":"49","type":"action","x0":1537,"y0":8442,"x1":1931,"y1":8746,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"With the harvested credentials, the threat actors used RDP from the beachhead host to the already compromised workstation host. ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"58.59","sourceId":"58","targetId":"59","source":{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},"target":{"id":"59","type":"data_property","x0":1725,"y0":8812,"x1":1967,"y1":8899,"payload":{"target":"Workstation"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"58.53","sourceId":"58","targetId":"53","source":{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},"target":{"id":"53","type":"action","x0":1037,"y0":9042,"x1":1431,"y1":9346,"payload":{"name":" T1021.002 Remote Services: SMB/Windows Admin Shares","description":"The threat actors then targeted several other workstations with Cobalt Strike executables, but no other activity was observed on the endpoints after this lateral movement. SMB was used to transfer the executable Cobalt Strike beacons","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"24.60","sourceId":"24","targetId":"60","source":{"id":"24","type":"asset","x0":1333,"y0":5296,"x1":1568,"y1":5383,"payload":{"state":"Compromised"}},"target":{"id":"60","type":"action","x0":1255,"y0":5514,"x1":1649,"y1":5818,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"After pivoting, the actors disabled Windows Defender logs","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"60.25","sourceId":"60","targetId":"25","source":{"id":"60","type":"action","x0":1255,"y0":5514,"x1":1649,"y1":5818,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"After pivoting, the actors disabled Windows Defender logs","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"25","type":"asset","x0":1337,"y0":5947,"x1":1572,"y1":6034,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"58.62","sourceId":"58","targetId":"62","source":{"id":"58","type":"asset","x0":1348,"y0":8816,"x1":1583,"y1":8903,"payload":{"state":"Compromised"}},"target":{"id":"62","type":"action","x0":1508,"y0":9042,"x1":1902,"y1":9346,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"The attackers enabled Restricted Admin Mode via remote WMI prior to attempting to RDP into the Domain Controller from the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"62.63","sourceId":"62","targetId":"63","source":{"id":"62","type":"action","x0":1508,"y0":9042,"x1":1902,"y1":9346,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"The attackers enabled Restricted Admin Mode via remote WMI prior to attempting to RDP into the Domain Controller from the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"63","type":"asset","x0":1568,"y0":9459,"x1":1803,"y1":9546,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"63.64","sourceId":"63","targetId":"64","source":{"id":"63","type":"asset","x0":1568,"y0":9459,"x1":1803,"y1":9546,"payload":{"state":"Compromised"}},"target":{"id":"64","type":"data_property","x0":1904,"y0":9457,"x1":2146,"y1":9544,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"63.54","sourceId":"63","targetId":"54","source":{"id":"63","type":"asset","x0":1568,"y0":9459,"x1":1803,"y1":9546,"payload":{"state":"Compromised"}},"target":{"id":"54","type":"action","x0":1493,"y0":9701,"x1":1887,"y1":10005,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"The attackers logged into the Domain Controller through RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"62.66","sourceId":"62","targetId":"66","source":{"id":"62","type":"action","x0":1508,"y0":9042,"x1":1902,"y1":9346,"payload":{"name":"T1021.006 Remote Services: Windows Remote Management","description":"The attackers enabled Restricted Admin Mode via remote WMI prior to attempting to RDP into the Domain Controller from the beachhead host","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"66","type":"data_property","x0":2071,"y0":9151,"x1":2313,"y1":9238,"payload":{"target":"Restricted Admin Mode"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"54.68","sourceId":"54","targetId":"68","source":{"id":"54","type":"action","x0":1493,"y0":9701,"x1":1887,"y1":10005,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"The attackers logged into the Domain Controller through RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"68.69","sourceId":"68","targetId":"69","source":{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},"target":{"id":"69","type":"data_property","x0":1974,"y0":10125,"x1":2216,"y1":10212,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"68.70","sourceId":"68","targetId":"70","source":{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},"target":{"id":"70","type":"action","x0":999,"y0":10349,"x1":1393,"y1":10653,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"Cobalt Strike PowerShell payload executed through PowerShell via RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"68.71","sourceId":"68","targetId":"71","source":{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},"target":{"id":"71","type":"action","x0":1497,"y0":10360,"x1":1891,"y1":10664,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Microsoft Defender Scheduled Tasks Deleted","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"68.72","sourceId":"68","targetId":"72","source":{"id":"68","type":"asset","x0":1579,"y0":10129,"x1":1814,"y1":10216,"payload":{"state":"Compromised"}},"target":{"id":"72","type":"action","x0":2074,"y0":10341,"x1":2468,"y1":10645,"payload":{"name":"T1555 Credentials from Password Stores","description":"LaZagne dropped and executed","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"25.73","sourceId":"25","targetId":"73","source":{"id":"25","type":"asset","x0":1337,"y0":5947,"x1":1572,"y1":6034,"payload":{"state":"Compromised"}},"target":{"id":"73","type":"data_property","x0":1670,"y0":6025,"x1":1912,"y1":6112,"payload":{"target":"Windows Defender"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"72.75","sourceId":"72","targetId":"75","source":{"id":"72","type":"action","x0":2074,"y0":10341,"x1":2468,"y1":10645,"payload":{"name":"T1555 Credentials from Password Stores","description":"LaZagne dropped and executed","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"75","type":"data_property","x0":2618,"y0":10444,"x1":2860,"y1":10531,"payload":{"target":"LaZagne"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"21.76","sourceId":"21","targetId":"76","source":{"id":"21","type":"action","x0":1251,"y0":4872,"x1":1645,"y1":5176,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"The attackers then pivoted to a workstation host via a Cobalt Strike Powershell beacon ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"76","type":"data_property","x0":1760,"y0":4980,"x1":2002,"y1":5067,"payload":{"target":"Cobalt Strike beacon"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"77.85","sourceId":"77","targetId":"85","source":{"id":"77","type":"asset","x0":2185,"y0":10844,"x1":2420,"y1":10931,"payload":{"state":"Compromised"}},"target":{"id":"85","type":"action","x0":1498,"y0":10950,"x1":1892,"y1":11254,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The attackers then began looking for documents on file shares via RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"83.85","sourceId":"83","targetId":"85","source":{"id":"83","type":"asset","x0":1577,"y0":10761,"x1":1812,"y1":10848,"payload":{"state":"Compromised"}},"target":{"id":"85","type":"action","x0":1498,"y0":10950,"x1":1892,"y1":11254,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The attackers then began looking for documents on file shares via RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"84.85","sourceId":"84","targetId":"85","source":{"id":"84","type":"asset","x0":1174,"y0":10900,"x1":1409,"y1":10987,"payload":{"state":"Compromised"}},"target":{"id":"85","type":"action","x0":1498,"y0":10950,"x1":1892,"y1":11254,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The attackers then began looking for documents on file shares via RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"70.84","sourceId":"70","targetId":"84","source":{"id":"70","type":"action","x0":999,"y0":10349,"x1":1393,"y1":10653,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell ","description":"Cobalt Strike PowerShell payload executed through PowerShell via RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"84","type":"asset","x0":1174,"y0":10900,"x1":1409,"y1":10987,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"71.83","sourceId":"71","targetId":"83","source":{"id":"71","type":"action","x0":1497,"y0":10360,"x1":1891,"y1":10664,"payload":{"name":"T1562.001 Impair Defenses: Disable or Modify Tools","description":"Microsoft Defender Scheduled Tasks Deleted","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"83","type":"asset","x0":1577,"y0":10761,"x1":1812,"y1":10848,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"72.77","sourceId":"72","targetId":"77","source":{"id":"72","type":"action","x0":2074,"y0":10341,"x1":2468,"y1":10645,"payload":{"name":"T1555 Credentials from Password Stores","description":"LaZagne dropped and executed","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"77","type":"asset","x0":2185,"y0":10844,"x1":2420,"y1":10931,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"83.86","sourceId":"83","targetId":"86","source":{"id":"83","type":"asset","x0":1577,"y0":10761,"x1":1812,"y1":10848,"payload":{"state":"Compromised"}},"target":{"id":"86","type":"data_property","x0":1884,"y0":10720,"x1":2126,"y1":10807,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"77.87","sourceId":"77","targetId":"87","source":{"id":"77","type":"asset","x0":2185,"y0":10844,"x1":2420,"y1":10931,"payload":{"state":"Compromised"}},"target":{"id":"87","type":"data_property","x0":2536,"y0":10758,"x1":2778,"y1":10845,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"77.78","sourceId":"77","targetId":"78","source":{"id":"77","type":"asset","x0":2185,"y0":10844,"x1":2420,"y1":10931,"payload":{"state":"Compromised"}},"target":{"id":"78","type":"data_property","x0":2551,"y0":10868,"x1":2793,"y1":10955,"payload":{"target":"Credentials"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"83.81","sourceId":"83","targetId":"81","source":{"id":"83","type":"asset","x0":1577,"y0":10761,"x1":1812,"y1":10848,"payload":{"state":"Compromised"}},"target":{"id":"81","type":"data_property","x0":1890,"y0":10827,"x1":2132,"y1":10914,"payload":{"target":"Windows Defender"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"84.82","sourceId":"84","targetId":"82","source":{"id":"84","type":"asset","x0":1174,"y0":10900,"x1":1409,"y1":10987,"payload":{"state":"Compromised"}},"target":{"id":"82","type":"data_property","x0":807,"y0":10901,"x1":1049,"y1":10988,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"88.91","sourceId":"88","targetId":"91","source":{"id":"88","type":"asset","x0":1579,"y0":11361,"x1":1814,"y1":11448,"payload":{"state":"Compromised"}},"target":{"id":"91","type":"data_property","x0":1913,"y0":11295,"x1":2155,"y1":11382,"payload":{"target":"File Server Data "}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"85.88","sourceId":"85","targetId":"88","source":{"id":"85","type":"action","x0":1498,"y0":10950,"x1":1892,"y1":11254,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The attackers then began looking for documents on file shares via RDP","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"88","type":"asset","x0":1579,"y0":11361,"x1":1814,"y1":11448,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"88.92","sourceId":"88","targetId":"92","source":{"id":"88","type":"asset","x0":1579,"y0":11361,"x1":1814,"y1":11448,"payload":{"state":"Compromised"}},"target":{"id":"92","type":"action","x0":1500,"y0":11571,"x1":1894,"y1":11875,"payload":{"name":"T1046 Network Service Discovery","description":"The threat actors ran Advanced IP scanner from the domain controller via the RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"92.93","sourceId":"92","targetId":"93","source":{"id":"92","type":"action","x0":1500,"y0":11571,"x1":1894,"y1":11875,"payload":{"name":"T1046 Network Service Discovery","description":"The threat actors ran Advanced IP scanner from the domain controller via the RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"93","type":"data_property","x0":2023,"y0":11676,"x1":2265,"y1":11763,"payload":{"target":"Advanced IP Scanner"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"92.94","sourceId":"92","targetId":"94","source":{"id":"92","type":"action","x0":1500,"y0":11571,"x1":1894,"y1":11875,"payload":{"name":"T1046 Network Service Discovery","description":"The threat actors ran Advanced IP scanner from the domain controller via the RDP session","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"94","type":"asset","x0":1581,"y0":11970,"x1":1816,"y1":12057,"payload":{"state":"Scanned"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"94.95","sourceId":"94","targetId":"95","source":{"id":"94","type":"asset","x0":1581,"y0":11970,"x1":1816,"y1":12057,"payload":{"state":"Scanned"}},"target":{"id":"95","type":"data_property","x0":1940,"y0":11967,"x1":2182,"y1":12054,"payload":{"target":"Network Ports"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"94.96","sourceId":"94","targetId":"96","source":{"id":"94","type":"asset","x0":1581,"y0":11970,"x1":1816,"y1":12057,"payload":{"state":"Scanned"}},"target":{"id":"96","type":"action","x0":1505,"y0":12150,"x1":1899,"y1":12454,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The file server SMB shares were accessed from the DC ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"97.98","sourceId":"97","targetId":"98","source":{"id":"97","type":"asset","x0":1587,"y0":12557,"x1":1822,"y1":12644,"payload":{"state":"Compromised"}},"target":{"id":"98","type":"data_property","x0":1899,"y0":12511,"x1":2141,"y1":12598,"payload":{"target":"File Server"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"97.99","sourceId":"97","targetId":"99","source":{"id":"97","type":"asset","x0":1587,"y0":12557,"x1":1822,"y1":12644,"payload":{"state":"Compromised"}},"target":{"id":"99","type":"data_property","x0":1896,"y0":12631,"x1":2138,"y1":12718,"payload":{"target":"SMB Share Data"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"96.97","sourceId":"96","targetId":"97","source":{"id":"96","type":"action","x0":1505,"y0":12150,"x1":1899,"y1":12454,"payload":{"name":"T1039 Data from Network Shared Drive","description":"The file server SMB shares were accessed from the DC ","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"97","type":"asset","x0":1587,"y0":12557,"x1":1822,"y1":12644,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"97.100","sourceId":"97","targetId":"100","source":{"id":"97","type":"asset","x0":1587,"y0":12557,"x1":1822,"y1":12644,"payload":{"state":"Compromised"}},"target":{"id":"100","type":"action","x0":1507,"y0":12754,"x1":1901,"y1":13058,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"RDP Connection to Backup Server to look for files","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"101.103","sourceId":"101","targetId":"103","source":{"id":"101","type":"asset","x0":1587,"y0":13158,"x1":1822,"y1":13245,"payload":{"state":"Compromised"}},"target":{"id":"103","type":"data_property","x0":1952,"y0":13158,"x1":2194,"y1":13245,"payload":{"target":"Backup Server Data"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"100.101","sourceId":"100","targetId":"101","source":{"id":"100","type":"action","x0":1507,"y0":12754,"x1":1901,"y1":13058,"payload":{"name":"T1021.001 Remote Services: Remote Desktop Protocol","description":"RDP Connection to Backup Server to look for files","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"101","type":"asset","x0":1587,"y0":13158,"x1":1822,"y1":13245,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"14.105","sourceId":"14","targetId":"105","source":{"id":"14","type":"asset","x0":1333,"y0":2546,"x1":1568,"y1":2633,"payload":{"state":"Compromised"}},"target":{"id":"105","type":"action","x0":1563,"y0":2766,"x1":1957,"y1":3070,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell","description":"Following the registry events, a PS command was launched that extracts the .NET loader from the registry and executes the code in memory via Assembly.Load()","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State "}},{"id":"105.16","sourceId":"105","targetId":"16","source":{"id":"105","type":"action","x0":1563,"y0":2766,"x1":1957,"y1":3070,"payload":{"name":"T1059.001 Command and Scripting Interpreter: PowerShell","description":"Following the registry events, a PS command was launched that extracts the .NET loader from the registry and executes the code in memory via Assembly.Load()","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"16","type":"asset","x0":1330,"y0":3204,"x1":1565,"y1":3291,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"25.106","sourceId":"25","targetId":"106","source":{"id":"25","type":"asset","x0":1337,"y0":5947,"x1":1572,"y1":6034,"payload":{"state":"Compromised"}},"target":{"id":"106","type":"action","x0":1260,"y0":6121,"x1":1654,"y1":6425,"payload":{"name":"T1059: Command and Scripting Interpreter","description":"The attackers then executed a second Cobalt Strike payload for a different C2 server","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State "}},{"id":"106.107","sourceId":"106","targetId":"107","source":{"id":"106","type":"action","x0":1260,"y0":6121,"x1":1654,"y1":6425,"payload":{"name":"T1059: Command and Scripting Interpreter","description":"The attackers then executed a second Cobalt Strike payload for a different C2 server","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"107","type":"asset","x0":1341,"y0":6541,"x1":1576,"y1":6628,"payload":{"state":"Compromised"}},"type":"relationship","payload":{"type":"State Changed"}},{"id":"107.26","sourceId":"107","targetId":"26","source":{"id":"107","type":"asset","x0":1341,"y0":6541,"x1":1576,"y1":6628,"payload":{"state":"Compromised"}},"target":{"id":"26","type":"action","x0":1263,"y0":6747,"x1":1657,"y1":7051,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"The attackers then ran a WMI command on the beachhead host to check for AntiVirus","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"type":"relationship","payload":{"type":"State"}},{"id":"107.108","sourceId":"107","targetId":"108","source":{"id":"107","type":"asset","x0":1341,"y0":6541,"x1":1576,"y1":6628,"payload":{"state":"Compromised"}},"target":{"id":"108","type":"data_property","x0":1658,"y0":6540,"x1":1900,"y1":6627,"payload":{"target":"Workstation"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"26.109","sourceId":"26","targetId":"109","source":{"id":"26","type":"action","x0":1263,"y0":6747,"x1":1657,"y1":7051,"payload":{"name":"T1518.001 Software Discovery: Security Software Discovery","description":"The attackers then ran a WMI command on the beachhead host to check for AntiVirus","timestamp":"","reference":"\"https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/\"","succeeded":1,"confidence":1,"logic_operator_language":"","logic_operator":"AND"}},"target":{"id":"109","type":"data_property","x0":1763,"y0":6855,"x1":2005,"y1":6942,"payload":{"target":"Antivirus"}},"type":"data_property_type","payload":{"type":"Description"}},{"id":"88.110","sourceId":"88","targetId":"110","source":{"id":"88","type":"asset","x0":1579,"y0":11361,"x1":1814,"y1":11448,"payload":{"state":"Compromised"}},"target":{"id":"110","type":"data_property","x0":1924,"y0":11411,"x1":2166,"y1":11498,"payload":{"target":"Domain Controller"}},"type":"data_property_type","payload":{"type":"Description"}}],"schema":{"lists":{},"nodes":{"action":{"color":"#637bc9","outline":"#708ce6","subtype":null,"fields":{"name":{"type":"string","default":"","required":true},"description":{"type":"string","default":"","required":true},"timestamp":{"type":"datetime","default":""},"reference":{"type":"string","default":""},"succeeded":{"type":"number","default":0,"range":{"min":0,"max":1}},"confidence":{"type":"number","default":0,"range":{"min":0,"max":1}},"logic_operator_language":{"type":"string","default":""},"logic_operator":{"type":"string","default":"","required":true}}},"asset":{"color":"#c26130","outline":"#e57339","subtype":null,"fields":{"state":{"type":"string","default":""}}},"object_property_target":{"color":"#b62020","outline":"#d62727","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}},"data_property":{"color":"#31347c","outline":"#4246a6","subtype":null,"fields":{"target":{"type":"string","default":"","required":true}}}},"edges":{"relationship":{"color":"#4d4d4d","outline":"#696969","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"object_property_type":{"color":"#099","outline":"#00b8b8","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}},"data_property_type":{"color":"#31347c","outline":"#4246a6","hasArrow":true,"hasDash":false,"fields":{"type":{"type":"string","default":"","required":true}}}},"edgeRules":[{"source":"action","target":"asset","type":"relationship"},{"source":"action","target":"data_property","type":"data_property_type"},{"source":"action","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"action","type":"relationship"},{"source":"asset","target":"data_property","type":"data_property_type"},{"source":"asset","target":"object_property_target","type":"object_property_type"},{"source":"asset","target":"asset","type":"object_property_type"}]}}