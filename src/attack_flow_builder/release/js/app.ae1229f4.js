(function(e){function t(t){for(var r,s,a=t[0],l=t[1],c=t[2],d=0,h=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],r=!0,s=1;s<i.length;s++){var a=i[s];0!==o[a]&&(r=!1)}r&&(n.splice(t--,1),e=l(l.s=i[0]))}return e}var r={},s={app:0},o={app:0},n=[];function a(e){return l.p+"js/"+({}[e]||e)+"."+{"chunk-69bedc3b":"926d2850"}[e]+".js"}function l(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.e=function(e){var t=[],i={"chunk-69bedc3b":1};s[e]?t.push(s[e]):0!==s[e]&&i[e]&&t.push(s[e]=new Promise((function(t,i){for(var r="css/"+({}[e]||e)+"."+{"chunk-69bedc3b":"5ad2deec"}[e]+".css",o=l.p+r,n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var c=n[a],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===r||d===o))return t()}var h=document.getElementsByTagName("style");for(a=0;a<h.length;a++){c=h[a],d=c.getAttribute("data-href");if(d===r||d===o)return t()}var u=document.createElement("link");u.rel="stylesheet",u.type="text/css",u.onload=t,u.onerror=function(t){var r=t&&t.target&&t.target.src||o,n=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=r,delete s[e],u.parentNode.removeChild(u),i(n)},u.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(u)})).then((function(){s[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,i){r=o[e]=[t,i]}));t.push(r[2]=n);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,l.nc&&d.setAttribute("nonce",l.nc),d.src=a(e);var h=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(u);var i=o[e];if(0!==i){if(i){var r=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;h.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",h.name="ChunkLoadError",h.type=r,h.request=s,i[1](h)}o[e]=void 0}};var u=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},l.m=e,l.c=r,l.d=function(e,t,i){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(i,r,function(t){return e[t]}.bind(null,r));return i},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var h=0;h<c.length;h++)t(c[h]);var u=d;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("cd49")},"0469":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("898b"),s=i("7f3b"),o=i("35f6"),n=i("13c3"),a=i("1dd9");class l{constructor(e,t){this.dx=0,this.dy=0,this.ox=0,this.oy=0,this.odx=0,this.ody=0,this.anchor=void 0,this._cx=0,this._cy=0,this._cdx=0,this._cdy=0,this._alignment=a["a"].Free,this._gridX=e,this._gridY=t,this._anchors=[]}reset(e,t,i,r,s,o){this.dx=0,this.dy=0,this.ox=r,this.oy=s,this.odx=0,this.ody=0,this.anchor=void 0,this._cx=t,this._cy=i,this._cdx=0,this._cdy=0,this._alignment=e,this._anchors=null!==o&&void 0!==o?o:[]}updateDelta(e,t){this._cdx+=e,this._cdy+=t;let i,r,s,o,l=this._cx+this._cdx,c=this._cy+this._cdy;for(let n of this._anchors)if(o=n.boundingBox,i=n.radius,r=o.xMid-l,s=o.yMid-c,r*r+s*s<i*i)return this.dx=o.xMid-(this.ox+this.odx),this.dy=o.yMid-(this.oy+this.ody),this.odx+=this.dx,this.ody+=this.dy,void(this.anchor=n);switch(this.anchor=void 0,this._alignment){case a["a"].Grid:this.dx=Object(n["m"])(this._cdx,this._gridX)-this.odx,this.dy=Object(n["m"])(this._cdy,this._gridY)-this.ody;break;case a["a"].Free:default:this.dx=this._cdx-this.odx,this.dy=this._cdy-this.ody;break}this.odx+=this.dx,this.ody+=this.dy}}class c{constructor(){this.showGrid=!0,this.showShadows=!0,this.showDebug=!1,this.ssaaScale=1,this.shadowsDisableAt=0}}var d,h=i("cbc0"),u=i("a80d");class p extends n["a"]{constructor(){super();let e=h["n"].createDummy(),t=new s["a"];this._canvas=null,this._context=null,this._display=new c,this._elWidth=0,this._elHeight=0,this._mover=new l(...e.grid),this._layoutLocked=!1,this._page=e.createView(t),this._rafId=0,this._rasterCache=t,this._resizeObserver=null,this._transform=r["e"],this._viewport=new o["a"],this._ztoId=0,this._zoom=r["d"]().scaleExtent([1/8,6]).on("zoom",this.onCanvasZoom.bind(this)).on("end",()=>this.onCanvasZoomEnd()),this._hovObj=null}inject(e){this._elWidth=e.clientWidth,this._elHeight=e.clientHeight,this._canvas=r["c"](e).append("canvas").attr("style","display:block;").attr("width",this._elWidth).attr("height",this._elHeight).on("mousemove",e=>{this.onHoverSubject(...r["b"](e))}).on("contextmenu",e=>e.preventDefault()),this._context=this._canvas.node().getContext("2d",{alpha:!1}),this._resizeObserver=new ResizeObserver(e=>this.onCanvasResize(e[0].target)),this._resizeObserver.observe(e),this._canvas.call(r["a"]().filter(()=>!0).subject(this.onSelectSubject.bind(this)).on("start",this.onObjectDragStarted.bind(this)).on("drag",this.onObjectDragged.bind(this)).on("end",this.onObjectDragEnded.bind(this))).call(this._zoom)}destroy(){var e,t;null===(e=this._canvas)||void 0===e||e.remove(),this._canvas=null,this._context=null,this.removeAllListeners(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}on(e,t){super.on(e,t)}once(e,t){super.once(e,t)}removeAllListeners(e){super.removeAllListeners(e)}emit(e,...t){super.emit(e,...t)}setGridDisplay(e){this._display.showGrid=e}setShadowsDisplay(e){this._display.showShadows=e}setDebugDisplay(e){this._display.showDebug=e}setSsaaScale(e){this._display.ssaaScale=e,this._rasterCache.setScale(e)}setShadowsDisableAt(e){this._display.shadowsDisableAt=e}render(){0==this._rafId&&(this._rafId=requestAnimationFrame(()=>{this._rafId=0,this.executeRenderPipeline()}))}executeRenderPipeline(){if(null===this._context)return;let e=this._display;this._page.renderPageSurfaceTo(this._context,this._viewport,e.showGrid),e.showShadows&&e.shadowsDisableAt<=this._transform.k?this._page.renderTo(this._context,this._viewport):this._page.renderTo(this._context,this._viewport,0,0),e.showDebug&&this._page.renderDebugTo(this._context,this._viewport)}onHoverSubject(e,t,i){var r;e=this._transform.invertX(e),t=this._transform.invertY(t);let s=this._page.el.getObjectAt(e,t);this._hovObj!==s&&(this._hovObj=s,i=null!==(r=null!==i&&void 0!==i?i:null===s||void 0===s?void 0:s.getCursor())&&void 0!==r?r:a["c"].Default,this.emit("object-hover",s,i))}onSelectSubject(e){let t,i=e.sourceEvent,r=this._transform.invertX(e.x),s=this._transform.invertY(e.y),o=this._page.el.getObjectAt(r,s),a=i.button===n["e"].Right;if(o){if(o instanceof h["c"]){if(this.emit("canvas-click",i,e.x,e.y),a)return;let t=o.makeLine(),r=o.boundingBox.xMid,s=o.boundingBox.yMid;t.srcEnding.moveTo(r,s),t.trgEnding.moveTo(r,s);let n=t.createView(this._rasterCache).updateView();return{type:d.CreateLine,line:n,parent:this._page,anchor:o,obj:n.trgEnding}}if(o.parent instanceof h["e"]){if(this.emit("object-click",i,o.parent,e.x,e.y),a)return;t=[this._page.lookup(o.id)]}else{if(this.emit("object-click",i,o,e.x,e.y),a)return;t=this._page.selects}return t[0]instanceof u["d"]&&1===t.length?{type:d.MoveAnchorable,obj:t[0]}:{type:d.Move,objs:t}}this.emit("canvas-click",i,e.x,e.y)}onObjectDragStarted(e){this._layoutLocked=!0;let t=e.subject,i=this._transform.invertX(e.x),r=this._transform.invertY(e.y),s=0,o=0,n=a["a"].Free,l=void 0;switch(t.type){case d.Move:for(let e of t.objs)s+=e.x,o+=e.y,n=Math.max(n,e.el.getAlignment());s/=t.objs.length,o/=t.objs.length;break;case d.CreateLine:t.parent.children.push(t.line);case d.MoveAnchorable:s=t.obj.x,o=t.obj.y,n=t.obj.el.getAlignment(),l=this._page.el.anchorCache;break}this._mover.reset(n,i,r,s,o,l)}onObjectDragged(e){let t,i=e.subject;switch(this._mover.updateDelta(e.dx/this._transform.k,e.dy/this._transform.k),i.type){case d.Move:for(let e of i.objs)t=e.fakePositionSetByUser(a["j"].True),e.moveBy(this._mover.dx,this._mover.dy,t);break;case d.CreateLine:i.obj.el.moveBy(this._mover.dx,this._mover.dy);case d.MoveAnchorable:this.onHoverSubject(e.x,e.y,i.obj.el.getCursor()),t=i.obj.fakePositionSetByUser(a["j"].True),i.obj.moveBy(this._mover.dx,this._mover.dy,t);break}this.render()}onObjectDragEnded(e){this._layoutLocked=!1;let t=e.subject,i=this._mover.odx,r=this._mover.ody;switch(t.type){case d.Move:if(!i&&!r)return;let e=t.objs.map(e=>e.el);this.emit("object-move",e,i,r);break;case d.MoveAnchorable:if(!i&&!r)return;if(this._mover.anchor){let e=this._mover.anchor,i=t.obj.el;this.emit("object-attach",i,e)}else if(t.obj.el.isAttached()){let e=t.obj.el;this.emit("object-detach",e,i,r)}else{let e=[t.obj.el];this.emit("object-move",e,i,r)}break;case d.CreateLine:if((i||r)&&t.anchor!==this._mover.anchor){let e=t.line.el,i=t.parent.el,r=t.anchor,s=this._mover.anchor;this.emit("line-create",e,i,r,s)}else this.updateView(),this.render();break}}onCanvasZoom(e){var t;this._transform.k!==e.transform.k&&(clearTimeout(this._ztoId),this._ztoId=setTimeout(()=>{let e=this._transform.k*this._display.ssaaScale;this._rasterCache.getScale()!==e&&(this._rasterCache.setScale(e),this.render())},p.RASTER_CACHE_UPDATE_DELAY)),this._transform=e.transform,this.updateViewportBounds(),null===(t=this._context)||void 0===t||t.setTransform(this._transform.k,0,0,this._transform.k,this._transform.x,this._transform.y),null===e.sourceEvent?0===this._rafId&&this.executeRenderPipeline():this.render()}onCanvasZoomEnd(){this.emit("view-transform",this._transform.x,this._transform.y,this._transform.k,this._elWidth,this._elHeight)}onCanvasResize(e){var t,i,r;let s=e.clientWidth,o=e.clientHeight;this._transform.x+=(s-this._elWidth)/2,this._transform.y+=(o-this._elHeight)/2,this._elWidth=s,this._elHeight=o,null===(i=null===(t=this._canvas)||void 0===t?void 0:t.attr("width",this._elWidth))||void 0===i||i.attr("height",this._elHeight),this.updateViewportBounds(),null===(r=this._context)||void 0===r||r.setTransform(this._transform.k,0,0,this._transform.k,this._transform.x,this._transform.y),this._context&&this.executeRenderPipeline()}updateViewportBounds(){let e=this._transform,t=p.VIEWPORT_PADDING;this._viewport.xMin=Math.round(e.invertX(-t)),this._viewport.xMax=Math.round(e.invertX(this._elWidth+t)),this._viewport.yMin=Math.round(e.invertY(-t)),this._viewport.yMax=Math.round(e.invertY(this._elHeight+t)),this._viewport.scale=e.k}setPage(e){this._page=e.createView(this._rasterCache),this._mover=new l(...e.grid)}updateView(){this._layoutLocked||this._page.updateView()}setCameraLocation(e,t=1e3){if(!this._canvas)return;let i=e.k,s=Math.round(this._elWidth/2-e.x*i),o=Math.round(this._elHeight/2-e.y*i);this._canvas.transition().duration(t).call(this._zoom.transform,r["e"].translate(s,o).scale(i))}}p.VIEWPORT_PADDING=0,p.RASTER_CACHE_UPDATE_DELAY=100,function(e){e[e["Move"]=0]="Move",e[e["MoveAnchorable"]=1]="MoveAnchorable",e[e["CreateLine"]=2]="CreateLine"}(d||(d={}))},"0da8":function(e,t,i){},1214:function(e,t,i){},"13c3":function(e,t,i){"use strict";i.d(t,"d",(function(){return p})),i.d(t,"h",(function(){return g})),i.d(t,"i",(function(){return y})),i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return m})),i.d(t,"c",(function(){return v})),i.d(t,"f",(function(){return x})),i.d(t,"m",(function(){return w})),i.d(t,"j",(function(){return j})),i.d(t,"k",(function(){return O})),i.d(t,"l",(function(){return S})),i.d(t,"g",(function(){return M})),i.d(t,"n",(function(){return D})),i.d(t,"e",(function(){return T}));const r="0123456789abcdef";function s(e){let t="";for(let i=0;i<=3;i++)t+=r.charAt(e>>8*i+4&15)+r.charAt(e>>8*i&15);return t}function o(e){let t,i=1+(e.length+8>>6),r=new Array(16*i).fill(0);for(t=0;t<e.length;t++)r[t>>2]|=e.charCodeAt(t)<<t%4*8;return r[t>>2]|=128<<t%4*8,r[16*i-2]=8*e.length,r}function n(e,t){var i=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(i>>16);return r<<16|65535&i}function a(e,t){return e<<t|e>>>32-t}function l(e,t,i,r,s,o){return n(a(n(n(t,e),n(r,o)),s),i)}function c(e,t,i,r,s,o,n){return l(t&i|~t&r,e,t,s,o,n)}function d(e,t,i,r,s,o,n){return l(t&r|i&~r,e,t,s,o,n)}function h(e,t,i,r,s,o,n){return l(t^i^r,e,t,s,o,n)}function u(e,t,i,r,s,o,n){return l(i^(t|~r),e,t,s,o,n)}function p(e){let t=o(e),i=1732584193,r=-271733879,a=-1732584194,l=271733878;for(let s=0;s<t.length;s+=16){let e=i,o=r,p=a,g=l;i=c(i,r,a,l,t[s+0],7,-680876936),l=c(l,i,r,a,t[s+1],12,-389564586),a=c(a,l,i,r,t[s+2],17,606105819),r=c(r,a,l,i,t[s+3],22,-1044525330),i=c(i,r,a,l,t[s+4],7,-176418897),l=c(l,i,r,a,t[s+5],12,1200080426),a=c(a,l,i,r,t[s+6],17,-1473231341),r=c(r,a,l,i,t[s+7],22,-45705983),i=c(i,r,a,l,t[s+8],7,1770035416),l=c(l,i,r,a,t[s+9],12,-1958414417),a=c(a,l,i,r,t[s+10],17,-42063),r=c(r,a,l,i,t[s+11],22,-1990404162),i=c(i,r,a,l,t[s+12],7,1804603682),l=c(l,i,r,a,t[s+13],12,-40341101),a=c(a,l,i,r,t[s+14],17,-1502002290),r=c(r,a,l,i,t[s+15],22,1236535329),i=d(i,r,a,l,t[s+1],5,-165796510),l=d(l,i,r,a,t[s+6],9,-1069501632),a=d(a,l,i,r,t[s+11],14,643717713),r=d(r,a,l,i,t[s+0],20,-373897302),i=d(i,r,a,l,t[s+5],5,-701558691),l=d(l,i,r,a,t[s+10],9,38016083),a=d(a,l,i,r,t[s+15],14,-660478335),r=d(r,a,l,i,t[s+4],20,-405537848),i=d(i,r,a,l,t[s+9],5,568446438),l=d(l,i,r,a,t[s+14],9,-1019803690),a=d(a,l,i,r,t[s+3],14,-187363961),r=d(r,a,l,i,t[s+8],20,1163531501),i=d(i,r,a,l,t[s+13],5,-1444681467),l=d(l,i,r,a,t[s+2],9,-51403784),a=d(a,l,i,r,t[s+7],14,1735328473),r=d(r,a,l,i,t[s+12],20,-1926607734),i=h(i,r,a,l,t[s+5],4,-378558),l=h(l,i,r,a,t[s+8],11,-2022574463),a=h(a,l,i,r,t[s+11],16,1839030562),r=h(r,a,l,i,t[s+14],23,-35309556),i=h(i,r,a,l,t[s+1],4,-1530992060),l=h(l,i,r,a,t[s+4],11,1272893353),a=h(a,l,i,r,t[s+7],16,-155497632),r=h(r,a,l,i,t[s+10],23,-1094730640),i=h(i,r,a,l,t[s+13],4,681279174),l=h(l,i,r,a,t[s+0],11,-358537222),a=h(a,l,i,r,t[s+3],16,-722521979),r=h(r,a,l,i,t[s+6],23,76029189),i=h(i,r,a,l,t[s+9],4,-640364487),l=h(l,i,r,a,t[s+12],11,-421815835),a=h(a,l,i,r,t[s+15],16,530742520),r=h(r,a,l,i,t[s+2],23,-995338651),i=u(i,r,a,l,t[s+0],6,-198630844),l=u(l,i,r,a,t[s+7],10,1126891415),a=u(a,l,i,r,t[s+14],15,-1416354905),r=u(r,a,l,i,t[s+5],21,-57434055),i=u(i,r,a,l,t[s+12],6,1700485571),l=u(l,i,r,a,t[s+3],10,-1894986606),a=u(a,l,i,r,t[s+10],15,-1051523),r=u(r,a,l,i,t[s+1],21,-2054922799),i=u(i,r,a,l,t[s+8],6,1873313359),l=u(l,i,r,a,t[s+15],10,-30611744),a=u(a,l,i,r,t[s+6],15,-1560198380),r=u(r,a,l,i,t[s+13],21,1309151649),i=u(i,r,a,l,t[s+4],6,-145523070),l=u(l,i,r,a,t[s+11],10,-1120210379),a=u(a,l,i,r,t[s+2],15,718787259),r=u(r,a,l,i,t[s+9],21,-343485551),i=n(i,e),r=n(r,o),a=n(a,p),l=n(l,g)}return s(i)+s(r)+s(a)+s(l)}function g(e,t,i,r,s,o=12,n=0){let a=r-t,l=s-i,c=Math.atan2(l,a),d=r-o*Math.cos(c-Math.PI/6),h=s-o*Math.sin(c-Math.PI/6),u=r-o*Math.cos(c+Math.PI/6),p=s-o*Math.sin(c+Math.PI/6);e.beginPath(),e.moveTo(d,h),e.lineTo(u,p),e.lineTo(r,s),e.closePath()}function y(e,t,i,r,s,o,n=1){t+=n/2,i+=n/2,r-=n,s-=n,o="number"===typeof o?{tl:o,tr:o,br:o,bl:o}:Object.assign({tl:0,tr:0,br:0,bl:0},o),e.beginPath(),e.moveTo(t+o.tl,i),e.lineTo(t+r-o.tr,i),e.quadraticCurveTo(t+r,i,t+r,i+o.tr),e.lineTo(t+r,i+s-o.br),e.quadraticCurveTo(t+r,i+s,t+r-o.br,i+s),e.lineTo(t+o.bl,i+s),e.quadraticCurveTo(t,i+s,t,i+s-o.bl),e.lineTo(t,i+o.tl),e.quadraticCurveTo(t,i,t+o.tl,i),e.closePath()}class f{constructor(){this._listeners=new Map}on(e,t){this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).unshift(t)}once(e,t){let i=(...r)=>{let s=this._listeners.get(e);s.splice(s.indexOf(i),1),t(...r)};this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).unshift(i)}emit(e,...t){if(this._listeners.has(e)){let i=this._listeners.get(e);for(let e=i.length-1;0<=e;e--)i[e](...t)}}removeAllListeners(e){void 0!==e?this._listeners.delete(e):this._listeners.clear()}}var b=i("9ab4");class _{constructor(){this._fontList=new Map([["default",new m({size:"10pt",family:"sans-serif"})]])}getFont(e){let t=_.getCssFontString(e);return this._fontList.has(t)?this._fontList.get(t):this._fontList.get("default")}loadFonts(e,t=4e3){return Object(b["a"])(this,void 0,void 0,(function*(){let i=[];for(let o of e)i.push(this.loadFont(o,t));let r=yield Promise.allSettled(i),s=[];for(let t=0;t<r.length;t++)"fulfilled"!==r[t].status&&s.push(_.getCssFontString(e[t]));if(s.length){let e=`'${s.join("', '")}'`;throw new Error("The following fonts failed to load: "+e)}}))}loadFont(e,t=4e3){return Object(b["a"])(this,void 0,void 0,(function*(){let i=_.getCssFontString(e),r=document.fonts;if(r.check(i))return this._fontList.has(i)||this._fontList.set(i,new m(e)),!0;{let s,o=this._fontList.set.bind(this._fontList),n=Date.now(),a=new Promise((s,a)=>Object(b["a"])(this,void 0,void 0,(function*(){(function l(){return Object(b["a"])(this,void 0,void 0,(function*(){t<=Date.now()-n?a(new Error(`Failed to load font '${i}' request timed out after ${t}ms.`)):r.load(i).then(t=>{if(0<t.length){let t=r.check(i);t&&o(i,new m(e)),s(t)}else setTimeout(l,50)},a)}))})()}))),l=new Promise((e,r)=>{s=setTimeout(()=>r(new Error(`Failed to load font '${i}' request timed out after ${t}ms.`)),t)}),c=yield Promise.race([a,l]);return clearTimeout(s),c}}))}static getCssFontString(e){var t;return`${null!==(t=e.weight)&&void 0!==t?t:400} ${e.size} ${e.family}`}}class m{constructor(e){this.css=_.getCssFontString(e),this.descriptor=e,this._ctx=document.createElement("canvas").getContext("2d"),this._ctx.font=this.css,this._widthIndex=new Map;for(let t of m.DEFAULT_INDEX)this._widthIndex.set(t,this.measureWidth(t))}measureWidth(e){if(document.fonts.check(this.css))return this._ctx.measureText(e).width;throw new Error(`The font '${this.css}' has not been loaded. The width of '${e}' cannot be measured.`)}measure(e){if(document.fonts.check(this.css)){let t=this._ctx.measureText(e);return{width:t.width,ascent:t.actualBoundingBoxAscent,descent:t.actualBoundingBoxDescent}}throw new Error(`The font '${this.css}' has not been loaded. The width of '${e}' cannot be measured.`)}getCharWidth(e){return this._widthIndex.has(e)||this._widthIndex.set(e,this.measureWidth(e)),this._widthIndex.get(e)}wordWrap(e,t){let i=e.trim().split(/\n/),r=[];for(let s=0;s<i.length;s++)i[s]?r[s]=this.lineWrap(i[s],t):r[s]=i[s];return r.flat()}lineWrap(e,t){let i="",r=0,s=[],o=e.split(m.WHITESPACE).filter(Boolean),n=m.WHITESPACE.test(o[0])?0:1;for(let a=0;a<o.length;a++){let e=this.measureWidth(o[a]);if(a%2!==n)if(t<r+e&&(0!==a&&(s.push(i.trimEnd()),i="",r=0),t<e)){let n=o[a];for(let o=0;o<n.length;o++)e=this.getCharWidth(n[o]),0!==o&&t<r+e&&(s.push(i),i="",r=0),i+=n[o],r+=e}else i+=o[a],r+=e;else i+=o[a],r+=e}return s.push(i.trimEnd()),s}}m.DEFAULT_INDEX="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\t ",m.WHITESPACE=/(\s+)/;const v=new _;function x(e,t,i){return Math.min(Math.max(e,t),i)}function w(e,t){return Math.sign(e)*Math.round(Math.abs(e)/t)*t}function j(e){let t=0;for(let i in e)t|=e[i];return t}function O(e,t,i,r,s){let o=s/2,n=i-e,a=r-t,l=Math.acos(n/Math.sqrt(Math.pow(n,2)+Math.pow(a,2))),c=o*Math.sin(l),d=o*Math.cos(l);return[e-c,t-d,e+c,t+d,i+c,r+d,i-c,r-d]}function S(e,t,i){let r=1/0,s=1/0,o=-1/0,n=-1/0;for(let a=0;a<i.length;a+=2)r=Math.min(r,i[a]),s=Math.min(s,i[a+1]),o=Math.max(o,i[a]),n=Math.max(n,i[a+1]);if(r<e&&e<o&&s<t&&t<n){let r=e,s=t,n=o+1,a=t,l=0,c=i.length;for(let e=0;e<c;e+=2){let t=k(r,s,n,a,i[e],i[e+1],i[(e+2)%c],i[(e+3)%c]);t&&l++}return l%2!==0}return!1}function k(e,t,i,r,s,o,n,a){let l,c,d,h,u,p,g,y;return l=t-r,c=i-e,d=e*r-i*t,g=l*s+c*o+d,y=l*n+c*a+d,!(g<0&&y<0||g>0&&y>0)&&(h=o-a,u=n-s,p=s*a-n*o,g=h*e+u*t+p,y=h*i+u*r+p,!(g<0&&y<0||g>0&&y>0)&&l*u-h*c!=0)}function M(e){let t=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}function B(e){return e?`${e[0].toLocaleUpperCase()}${e.substring(1)}`:""}function D(e){return e.split(/\s+|_/).map(e=>B(e)).join(" ")}var T;(function(e){e[e["Left"]=0]="Left",e[e["Middle"]=1]="Middle",e[e["Right"]=2]="Right"})(T||(T={}))},"14ab":function(e,t,i){"use strict";i("ede2")},"14d9":function(e){e.exports=JSON.parse('{"file":{"image_export":{"padding":30}},"edit":{"clone_offset":[20,20]},"view":{"diagram":{"display_grid":true,"display_shadows":true,"display_debug_mode":false,"render_high_quality":true,"disable_shadows_at":0.7}},"hotkeys":{"file":{"new_file":"Control+N","open_file":"Control+O","save_file":"Control+S","save_image":"","save_select_image":"","publish_file":"","open_library":"","save_library":""},"edit":{"undo":"Control+Z","redo":"Control+Y","cut":"Control+X","copy":"Control+C","paste":"Control+V","delete":"Backspace","duplicate":"Control+D","select_all":"Control+A"},"layout":{"selection_to_front":"Control+Shift+F","selection_to_back":"Control+Shift+B","bring_selection_forward":"","send_selection_backward":"","align_left":"","align_center":"","align_right":"","align_top":"","align_middle":"","align_bottom":"","group":"Control+G","ungroup":"Control+Shift+U","open_group":"","close_group":""},"view":{"toggle_grid":"Control+Shift+G","toggle_shadows":"","reset_view":"Escape","zoom_in":"","zoom_out":"","fullscreen":"","jump_to_selection":"Shift+Z","jump_to_parents":"Shift+P","jump_to_children":"Shift+C","toggle_debug_view":""},"select":{"many":"Control"}}}')},1608:function(e,t,i){},"1b79":function(e,t,i){"use strict";var r=i("7a23");const s=e=>(Object(r["t"])("data-v-2d69016e"),e=e(),Object(r["s"])(),e),o=["fill"],n=s(()=>Object(r["g"])("path",{d:"m2.1167 0-1.0583 1.3229-1.0583-1.3229z","stroke-width":"0"},null,-1)),a=[n];function l(e,t,i,s,n,l){return Object(r["r"])(),Object(r["f"])("svg",{width:"8",height:"5",fill:e.color,class:Object(r["p"])({collapsed:e.collapsed}),version:"1.1",viewBox:"0 0 2.1167 1.3229",xmlns:"http://www.w3.org/2000/svg"},a,10,o)}var c=Object(r["k"])({name:"CollapseArrow",props:{collapsed:{type:Boolean,default:!1},color:{type:String,default:"#8c8c8c"}}}),d=(i("754c"),i("6b0d")),h=i.n(d);const u=h()(c,[["render",l],["__scopeId","data-v-2d69016e"]]);t["a"]=u},"1dd9":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return d})),i.d(t,"h",(function(){return h})),i.d(t,"i",(function(){return u})),i.d(t,"j",(function(){return p})),i.d(t,"k",(function(){return g})),i.d(t,"l",(function(){return y})),i.d(t,"m",(function(){return f})),i.d(t,"n",(function(){return b})),i.d(t,"o",(function(){return _})),i.d(t,"p",(function(){return v})),i.d(t,"d",(function(){return x}));var r=i("13c3"),s=i("317b");const o={Free:0,Grid:1},n=Object(r["j"])(o),a={Default:0,Pointer:2,Crosshair:4,Move:6,NotAllowed:8,Grab:10,Grabbing:12,N_Resize:14,E_Resize:16,S_Resize:18,W_Resize:20,EW_Resize:22,NS_Resize:24,Col_Resize:26,Row_Resize:28},l=Object(r["j"])(a),c={Off:0,Direct:32,Indirect:64},d=Object(r["j"])(c),h={False:0,True:128},u=Object(r["j"])(h),p={False:0,True:256},g=Object(r["j"])(p),y={Normal:512,High:1024},f=Object(r["j"])(y),b={False:0,True:2048},_=Object(r["j"])(b),m={None:s["f"].None,Node:s["f"].Node,Edge:s["f"].Edge,EdgeSource:s["f"].EdgeSource,EdgeTarget:s["f"].EdgeTarget},v=Object(r["j"])(m),x={[a.Default]:"default",[a.Pointer]:"pointer",[a.Crosshair]:"crosshair",[a.Move]:"move",[a.NotAllowed]:"not-allowed",[a.Grab]:"grab",[a.Grabbing]:"grabbing",[a.N_Resize]:"n-resize",[a.E_Resize]:"e-resize",[a.S_Resize]:"s-resize",[a.W_Resize]:"w-resize",[a.EW_Resize]:"ew-resize",[a.NS_Resize]:"ns-resize",[a.Col_Resize]:"col-resize",[a.Row_Resize]:"row-resize"}},"219f":function(e,t,i){"use strict";i("9453")},"24a6":function(e,t,i){"use strict";i.d(t,"a",(function(){return r["a"]})),i.d(t,"d",(function(){return r["c"]})),i.d(t,"m",(function(){return r["f"]})),i.d(t,"n",(function(){return r["g"]})),i.d(t,"s",(function(){return r["j"]})),i.d(t,"v",(function(){return r["n"]})),i.d(t,"e",(function(){return r["d"]})),i.d(t,"A",(function(){return s["f"]})),i.d(t,"B",(function(){return s["m"]})),i.d(t,"C",(function(){return s["n"]})),i.d(t,"p",(function(){return s["e"]})),i.d(t,"u",(function(){return o["h"]})),i.d(t,"t",(function(){return o["g"]})),i.d(t,"f",(function(){return o["b"]})),i.d(t,"y",(function(){return o["j"]})),i.d(t,"q",(function(){return o["f"]})),i.d(t,"k",(function(){return o["c"]})),i.d(t,"o",(function(){return o["e"]})),i.d(t,"l",(function(){return o["d"]})),i.d(t,"j",(function(){return n["g"]})),i.d(t,"g",(function(){return n["c"]})),i.d(t,"h",(function(){return n["d"]})),i.d(t,"r",(function(){return n["n"]})),i.d(t,"z",(function(){return a["g"]})),i.d(t,"x",(function(){return a["f"]})),i.d(t,"b",(function(){return a["a"]})),i.d(t,"i",(function(){return a["d"]})),i.d(t,"w",(function(){return l})),i.d(t,"c",(function(){return c["a"]}));var r=i("1dd9"),s=i("13c3"),o=i("5368"),n=i("cbc0"),a=i("317b");class l{static toGraph(e){let t,i=[],r=[];for(let s of e.getSubtree()){switch(s.getSemanticRole()){case a["f"].Node:t=r;break;case a["f"].Edge:t=i;break;default:continue}t.push({id:s.id,template:s.template,data:s.props,prev:this.getPrevGraphLinks(s).map(e=>e.id),next:this.getNextGraphLinks(s).map(e=>e.id)})}return{edges:i,nodes:r}}static getNextGraphLinks(e){switch(e.getSemanticRole()){case a["f"].Edge:return this.getNodes(this.getEdgeTargetsFor(e));case a["f"].Node:return this.getEdges(this.getEdgeSourcesFor(e));default:return[]}}static getPrevGraphLinks(e){switch(e.getSemanticRole()){case a["f"].Edge:return this.getNodes(this.getEdgeSourcesFor(e));case a["f"].Node:return this.getEdges(this.getEdgeTargetsFor(e));default:return[]}}static getNodes(e){let t=[];for(let i of e){let e=this.getNode(i);e&&t.push(e)}return t}static getNode(e){if(!(e instanceof n["d"])||!e.hasRole(a["f"].EdgeSource)&&!e.hasRole(a["f"].EdgeTarget))return;let t=e.anchor;while(t){if(t.hasRole(a["f"].Node))return t;t=t.parent}}static getEdges(e){let t=[];for(let i of e){let e=this.getEdge(i);e&&t.push(e)}return t}static getEdge(e){if(!e.hasRole(a["f"].EdgeSource)&&!e.hasRole(a["f"].EdgeTarget))return;let t=e.parent;while(t){if(t.hasRole(a["f"].Edge))return t;t=t.parent}}static getEdgeSources(e){let t=[];for(let i of e)t=t.concat(this.getEdgeSourcesFor(i));return t}static getEdgeSourcesFor(e){if(!e.hasRole(a["f"].Edge)&&!e.hasRole(a["f"].Node))return[];let t=[e],i=[];while(t.length){let e=t.pop();if(e.hasRole(a["f"].EdgeSource))i.push(e);else for(let i of e.children)t.push(i)}return i}static getEdgeTargets(e){let t=[];for(let i of e)t=t.concat(this.getEdgeTargetsFor(i));return t}static getEdgeTargetsFor(e){if(!e.hasRole(a["f"].Edge)&&!e.hasRole(a["f"].Node))return[];let t=[e],i=[];while(t.length){let e=t.pop();if(e.hasRole(a["f"].EdgeTarget))i.push(e);else for(let i of e.children)t.push(i)}return i}}i("d288");var c=i("0469");i("28e0")},"27a3":function(e,t,i){},"28e0":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("7f3b"),s=(i("d288"),i("0469"),i("35f6")),o=i("1dd9");class n{constructor(e,t=30,i=!0,r=!0,s=!1){this._page=e,this._padding=t,this._showGrid=i,this._showShadows=r,this._showDebug=s}capture(e){let t,i,n,a;if(null===e||void 0===e?void 0:e.length){t=1/0,i=1/0,n=-1/0,a=-1/0;for(let r of e)t=Math.min(t,r.boundingBox.xMin),i=Math.min(i,r.boundingBox.yMin),n=Math.max(n,r.boundingBox.xMax),a=Math.max(a,r.boundingBox.yMax)}else t=this._page.boundingBox.xMin,i=this._page.boundingBox.yMin,n=this._page.boundingBox.xMax,a=this._page.boundingBox.yMax;let l=new r["a"],c=this._page.createView(l);c.updateView();let d=document.createElement("canvas");d.width=Math.round(n-t)+2*this._padding,d.height=Math.round(a-i)+2*this._padding;let h=d.getContext("2d");h.setTransform(1,0,0,1,-t+this._padding,-i+this._padding);let u=new s["a"];u.xMin=t-this._padding,u.yMin=i-this._padding,u.xMax=n+this._padding,u.yMax=a+this._padding;let p=new Map,g=this._page.getSubtree(e=>e.isHoveredOrSelected());for(let r of g)p.set(r,r.attrs),r.setSelect(o["n"].False),r.setHover(o["f"].Off);c.renderPageSurfaceTo(h,u,this._showGrid),this._showShadows?c.renderTo(h,u):c.renderTo(h,u,0,0),this._showDebug&&c.renderDebugTo(h,u);for(let[r,s]of p)r.attrs=s;return d}}},2975:function(e,t,i){},"2c04":function(e,t,i){"use strict";i("27a3")},"2c3e":function(e,t,i){"use strict";i("ec4a")},"317b":function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"g",(function(){return s})),i.d(t,"f",(function(){return o})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return a["b"]})),i.d(t,"b",(function(){return d})),i.d(t,"d",(function(){return g}));class r extends Error{constructor(e){super(e)}}var s,o,n;(function(e){e[e["AnchorPoint"]=0]="AnchorPoint",e[e["BranchBlock"]=1]="BranchBlock",e[e["DictionaryBlock"]=2]="DictionaryBlock",e[e["LineEndingPoint"]=3]="LineEndingPoint",e[e["LineHandlePoint"]=4]="LineHandlePoint",e[e["LineHorizontalElbow"]=5]="LineHorizontalElbow",e[e["LineVerticalElbow"]=6]="LineVerticalElbow",e[e["Page"]=7]="Page",e[e["TextBlock"]=8]="TextBlock"})(s||(s={})),function(e){e[e["None"]=0]="None",e[e["Node"]=4096]="Node",e[e["Edge"]=8192]="Edge",e[e["EdgeSource"]=12288]="EdgeSource",e[e["EdgeTarget"]=16384]="EdgeTarget"}(o||(o={})),function(e){e[e["DEG_0"]=0]="DEG_0",e[e["DEG_90"]=1]="DEG_90"}(n||(n={}));var a=i("c40c"),l=i("5368");const c="@__builtin__",d=[{id:c+"page",name:"Page",type:s.Page,role:o.None,grid:[10,10],properties:{name:{type:l["h"].String,value:"Untitled Document",is_primary:!0}},style:a["b"].Page()},{id:c+"anchor",name:"Anchor",type:s.AnchorPoint,role:o.None,radius:10,line_templates:{[n.DEG_0]:c+"line_horizontal_elbow",[n.DEG_90]:c+"line_vertical_elbow"},style:a["b"].AnchorPoint()},{id:c+"line_handle",name:"Line Handle",type:s.LineHandlePoint,role:o.None,style:a["b"].LineHandle()},{id:c+"line_source",name:"Line Source",type:s.LineEndingPoint,role:o.EdgeSource,style:a["b"].LineEnding()},{id:c+"line_target",name:"Line Target",type:s.LineEndingPoint,role:o.EdgeTarget,style:a["b"].LineEnding()},{id:c+"line_horizontal_elbow",name:"Horizontal Elbow",type:s.LineHorizontalElbow,role:o.Edge,hitbox_width:20,line_handle_template:c+"line_handle",line_ending_template:{source:c+"line_source",target:c+"line_target"},style:a["b"].Line()},{id:c+"line_vertical_elbow",name:"Vertical Elbow",type:s.LineVerticalElbow,role:o.Edge,hitbox_width:20,line_handle_template:c+"line_handle",line_ending_template:{source:c+"line_source",target:c+"line_target"},style:a["b"].Line()}];var h=i("9ab4"),u=i("13c3"),p=i("cbc0");class g{constructor(e,t){this.schema=e,this.templates=t}static createDummy(){return new this({page_template:"",templates:[]},new Map)}static create(e){return Object(h["a"])(this,void 0,void 0,(function*(){let t=structuredClone(e),i=new Set;for(let e of t.templates){if(i.has(e.id))throw new r(`Template '${e.id}' can only be defined once.`);i.add(e.id)}let s=new Map;for(let e of[...d,...t.templates])s.set(e.id,e);let o=[];for(let e of s.values())o=o.concat(this.getFontDescriptorsFromTemplate(e));yield u["c"].loadFonts(o);for(let e of s.values())this.swapFontDescriptorsWithFonts(e);return new this(e,s)}))}getTemplate(e){return this.templates.get(e)}getBlockTemplates(){let e=[];for(let t of this.templates.values())switch(t.type){case s.BranchBlock:case s.DictionaryBlock:case s.TextBlock:e.push(t);break}return e}getLineTemplates(){let e=[];for(let t of this.templates.values())switch(t.type){case s.LineVerticalElbow:case s.LineHorizontalElbow:e.push(t);break}return e}createObject(e){let t,i;e instanceof Object?(t=e.template,i=e):t=e;let o=this.templates.get(t);if(!o)throw new r(`Template '${t}' does not exist.`);switch(o.type){case s.Page:return new p["n"](this,o,i);case s.AnchorPoint:return new p["a"](this,o,i);case s.BranchBlock:return new p["b"](this,o,i);case s.DictionaryBlock:return new p["h"](this,o,i);case s.LineEndingPoint:return new p["j"](this,o,i);case s.LineHandlePoint:return new p["k"](this,o,i);case s.LineVerticalElbow:return new p["m"](this,o,i);case s.LineHorizontalElbow:return new p["l"](this,o,i);case s.TextBlock:return new p["o"](this,o,i);default:throw new r(`Unknown template type: '${o.type}'.`)}}cloneObjects(...e){let t=new Map,i=new Map,r=e.map(e=>this.cloneObject(e,t,i));for(let[s,o]of i)for(let e of o){let i=t.get(e);i&&s.addChild(i)}return r}cloneObject(e,t,i){if(e instanceof p["c"]){let r=this.createObject(Object.assign(Object.assign({},e.toExport()),{id:crypto.randomUUID(),children:[]}));return t.set(e.id,r),i.set(r,e.children.map(e=>e.id)),r}let r=[];for(let o of e.children)r.push(this.cloneObject(o,t,i));let s=this.createObject(Object.assign(Object.assign({},e.toExport()),{id:crypto.randomUUID(),children:r}));return t.set(e.id,s),s}static getFontDescriptorsFromTemplate(e){let t=[];switch(e.type){case s.BranchBlock:let{style:i}=e;t.push(i.branch.font);case s.DictionaryBlock:let{style:r}=e;t=t.concat([r.head.one_title.title.font,r.head.two_title.title.font,r.head.two_title.subtitle.font,r.body.field_name.font,r.body.field_value.font]);break;case s.TextBlock:let{style:o}=e;t.push(o.text.font);break;default:break}return t}static swapFontDescriptorsWithFonts(e){let t=u["c"].getFont.bind(u["c"]);switch(e.type){case s.BranchBlock:let{branch:i}=e.style;i.font=t(i.font);case s.DictionaryBlock:let{head:r,body:o}=e.style;r.one_title.title.font=t(r.one_title.title.font),r.two_title.title.font=t(r.two_title.title.font),r.two_title.subtitle.font=t(r.two_title.subtitle.font),o.field_name.font=t(o.field_name.font),o.field_value.font=t(o.field_value.font);break;case s.TextBlock:let{text:n}=e.style;n.font=t(n.font);break;default:break}}getSchema(){let e=[];for(let t of this.templates.values()){let i=JSON.stringify(t,(e,t)=>t instanceof u["b"]?t.descriptor:t);e.push(JSON.parse(i))}return{page_template:this.schema.page_template,templates:e}}}},"335e":function(e,t,i){},"35f6":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(){this.xMin=0,this.yMin=0,this.xMax=0,this.yMax=0,this.scale=1}}},"41de":function(e,t,i){"use strict";i("a508")},"44e9":function(e,t,i){"use strict";i("9de6")},"451d":function(e,t,i){"use strict";i("5eec")},"4aad":function(e,t,i){},"4ba3":function(e,t,i){"use strict";i("f636")},5368:function(e,t,i){"use strict";var r;i.d(t,"h",(function(){return r})),i.d(t,"g",(function(){return o})),i.d(t,"b",(function(){return a})),i.d(t,"j",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"a",(function(){return d})),i.d(t,"c",(function(){return h})),i.d(t,"e",(function(){return u})),i.d(t,"d",(function(){return p})),i.d(t,"i",(function(){return g})),function(e){e[e["Int"]=0]="Int",e[e["Float"]=1]="Float",e[e["String"]=2]="String",e[e["Date"]=3]="Date",e[e["Enum"]=4]="Enum",e[e["List"]=5]="List",e[e["Dictionary"]=6]="Dictionary"}(r||(r={}));var s=i("7a23");class o{constructor(e,t){this.type=t.type,this.descriptor=t,this.trigger=Object(s["v"])(0),this._parent=e}get root(){let e=this;while(e._parent)e=e._parent;return e instanceof g?e:void 0}static create(e,t,i){switch(t.type){case r.String:return new l(e,t,i);case r.Int:case r.Float:return new c(e,t,i);case r.Date:return new a(e,t,i);case r.Enum:return new p(e,t,i);case r.List:return new u(e,t,i);case r.Dictionary:return new h(e,t,i)}}updateProperty(){var e;this.trigger.value=this.toHashValue(),null===(e=this._parent)||void 0===e||e.updateProperty()}}var n=i("13c3");class a extends o{constructor(e,t,i){var r;let s;super(e,t),this._value=null,this.descriptor=t,s=null===i?null:null!==(r=null!==i&&void 0!==i?i:t.value)&&void 0!==r?r:null,null===s?this.setValue(null):s instanceof Date||"string"===typeof s?this.setValue(new Date(s)):this.setValue(new Date)}isDefined(){return null!==this._value}setValue(e){this._value=e,this.updateProperty()}toRawValue(){var e,t;return null!==(t=null===(e=this._value)||void 0===e?void 0:e.toISOString())&&void 0!==t?t:null}toHashValue(){return null===this._value?Object(n["g"])(""):Object(n["g"])(this._value.toString())}toString(){var e;return""+(null!==(e=this._value)&&void 0!==e?e:"Null")}}class l extends o{constructor(e,t,i){var r;if(super(e,t),this.descriptor=t,this._value=null,null===i)this.setValue(null);else{let e=null!==(r=null!==i&&void 0!==i?i:t.value)&&void 0!==r?r:null;this.setValue(null===e?null:""+e)}}isDefined(){return null!==this._value}setValue(e){this._value=e,this.updateProperty()}toRawValue(){return this._value}toHashValue(){return null===this._value?Object(n["g"])(""):Object(n["g"])("v:"+this._value)}toString(){var e;return null!==(e=this._value)&&void 0!==e?e:"Null"}}class c extends o{constructor(e,t,i){var r,s,o;let n;super(e,t),this.min=null!==(r=t.min)&&void 0!==r?r:-1/0,this.max=null!==(s=t.max)&&void 0!==s?s:1/0,this.descriptor=t,this._value=null,n=null===i?null:null!==(o=null!==i&&void 0!==i?i:t.value)&&void 0!==o?o:null,null===n?this.setValue(null):"number"===typeof n?this.setValue(n):this.setValue(0)}isDefined(){return null!==this._value}setValue(e){if(null===e)this._value=null;else{let t=Object(n["f"])(e,this.min,this.max);this.type===r.Int?this._value=Math.round(t):this._value=t}this.updateProperty()}toRawValue(){return this._value}toHashValue(){var e;return Object(n["g"])(""+(null!==(e=this._value)&&void 0!==e?e:""))}toString(){var e;return""+(null!==(e=this._value)&&void 0!==e?e:"Null")}}class d extends o{constructor(e,t){super(e,t),this.descriptor=t,this.value=new Map}indexOf(e){return[...this.value.keys()].indexOf(e)}toRawValue(){return[...this.value.entries()].map(([e,t])=>[e,t.toRawValue()])}toHashValue(){let e=[...this.value.values()].map(e=>e.toHashValue()).join(".");return Object(n["g"])(e)}}class h extends d{constructor(e,t,i){var r;super(e,t),this.descriptor=t,this.primaryKey=null,this.value=new Map;for(let s in t.form){let e=null===(r=null===i||void 0===i?void 0:i.find(e=>e[0]===s))||void 0===r?void 0:r.at(1),n=o.create(this,t.form[s],e);this.value.set(s,n),!this.primaryKey&&n.descriptor.is_primary&&(this.primaryKey=s)}}addProperty(e,t,i){throw new Error("Properties cannot be dynamically added to dictionaries.")}removeProperty(e){throw new Error("Properties cannot be dynamically removed from dictionaries.")}isDefined(){return!!this.primaryKey&&this.value.get(this.primaryKey).isDefined()}toString(){return this.primaryKey?this.value.get(this.primaryKey).toString():"Error - No Primary Key"}}class u extends d{constructor(e,t,i){if(super(e,t),this.descriptor=t,this.value=new Map,Array.isArray(i))for(let[r,s]of i){let e=o.create(this,t.form,s);this.value.set(r,e)}else if(t.value)if(Array.isArray(t.value))for(let[r,s]of t.value){let e=o.create(this,t.form,s);this.value.set(Object(n["d"])(r),e)}else for(let r in t.value){let e=t.value[r],i=o.create(this,t.form,e);this.value.set(Object(n["d"])(r),i)}}addProperty(e,t=this.getNextId(),i=this.value.size){let r=[...this.value.entries()];return r.splice(i,0,[t,e]),this.value=new Map(r),this.updateProperty(),t}removeProperty(e){this.value.delete(e),this.updateProperty()}isDefined(){return 0<this.value.size}toString(){return[...this.value.values()].map(e=>e.toString()).join(", ")}getNextId(){let e=Object(n["d"])(crypto.randomUUID());while(this.value.has(e))e=Object(n["d"])(crypto.randomUUID());return e}}class p extends o{constructor(e,t,i){super(e,t);let r,s=o.create(void 0,t.options);this.descriptor=t,this.options=s,this._value=null,r=null===i?null:void 0!==i?i:t.value?Object(n["d"])(t.value):null,null===r?this.setValue(null):"string"===typeof r?this.setValue(r):this.setValue(null)}isDefined(){return null!==this._value}setValue(e){null===e?this._value=null:this.options.value.has(e)?this._value=e:this._value=null,this.updateProperty()}toReferenceValue(){return null===this._value?null:this.options.value.get(this._value)}toRawValue(){return this._value}toHashValue(){return null===this._value?Object(n["g"])(""):Object(n["g"])("v:"+this._value)}toString(){var e,t;return null!==(t=null===(e=this.toReferenceValue())||void 0===e?void 0:e.toString())&&void 0!==t?t:"Null"}}class g extends h{constructor(e,t,i){let s={type:r.Dictionary,form:t};super(void 0,s,i),this.object=e}updateProperty(){super.updateProperty(),this._notifyPropertyUpdate&&this._notifyPropertyUpdate()}onUpdate(e){this._notifyPropertyUpdate=e}}},"5eec":function(e,t,i){},6220:function(e,t,i){"use strict";i("74c2")},"69ee":function(e,t,i){"use strict";var r=i("7a23");const s={class:"dictionary-field-contents-control"},o={class:"field-name"};function n(e,t,i,n,a,l){return Object(r["r"])(),Object(r["f"])("div",s,[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.fields,([i,s])=>(Object(r["r"])(),Object(r["f"])("div",{class:"field-item",key:i},[Object(r["g"])("p",o,Object(r["A"])(e.titleCase(i)),1),(Object(r["r"])(),Object(r["d"])(Object(r["z"])(e.getField(s.type)),{class:"field-value",property:s,onChange:t[0]||(t[0]=(...t)=>e.$emit("change",...t)),onCreate:t[1]||(t[1]=(...t)=>e.$emit("create",...t)),onDelete:t[2]||(t[2]=(...t)=>e.$emit("delete",...t))},null,40,["property"]))]))),128))])}var a=i("24a6");const l={class:"grid-container"},c={class:"placeholder"},d=["contenteditable"];function h(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",{class:Object(r["p"])(["text-field-control",{disabled:!e.isEditable}]),tabindex:"0",onFocus:t[4]||(t[4]=t=>e.onFocus())},[Object(r["g"])("div",l,[Object(r["F"])(Object(r["g"])("p",c," Null ",512),[[r["C"],e.showPlaceholder]]),Object(r["g"])("div",{ref:"field",class:"field",onInput:t[0]||(t[0]=(...t)=>e.onInput&&e.onInput(...t)),onKeyup:t[1]||(t[1]=Object(r["G"])(()=>{},["stop"])),onKeydown:t[2]||(t[2]=Object(r["G"])(()=>{},["stop"])),onBlur:t[3]||(t[3]=(...t)=>e.onBlur&&e.onBlur(...t)),contenteditable:e.isEditable},Object(r["A"])(this.value),41,d)])],34)}var u=Object(r["k"])({name:"TextField",setup(){return{field:Object(r["v"])(null)}},props:{property:{type:Object,required:!0},updateTimeout:{type:Number,default:300}},data(){return{sto:0,value:"",cache:"",showPlaceholder:!0}},computed:{_property(){this.property.trigger.value;return this.property},isEditable(){var e;return null===(e=this._property.descriptor.is_editable)||void 0===e||e}},methods:{onFocus(){this.$nextTick(()=>{this.field.focus()})},onInput(){clearTimeout(this.sto),this.cache=this.field.innerText,this.sto=setTimeout(()=>{this.updateProperty()},this.updateTimeout),this.showPlaceholder=""===this.field.innerText},onBlur(){clearTimeout(this.sto),this.updateProperty()},updateProperty(){let e=this.cache||null;this._property.toRawValue()!==e?this.$emit("change",this._property,e):this.refreshValue()},refreshValue(){let e=this._property.toRawValue();this.field!==document.activeElement&&(this.value=null!==e&&void 0!==e?e:""),this.cache=null!==e&&void 0!==e?e:"",this.showPlaceholder=null===e}},emits:["change"],watch:{"_property.trigger.value"(){this.refreshValue()}},mounted(){this.refreshValue()}}),p=(i("14ab"),i("6b0d")),g=i.n(p);const y=g()(u,[["render",h],["__scopeId","data-v-1212d968"]]);var f=y;const b={class:"list-field-control"},_=["onPointerdown"],m=["onPointerdown"];function v(e,t,i,s,o,n){const a=Object(r["y"])("Plus");return Object(r["r"])(),Object(r["f"])("div",b,[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e._property.value,([i,s])=>(Object(r["r"])(),Object(r["f"])("div",{class:"field-item",key:i},["DictionaryField"===e.getField(s.type)?(Object(r["r"])(),Object(r["d"])(Object(r["z"])(e.getField(s.type)),{key:0,property:s,onChange:t[0]||(t[0]=(...t)=>e.$emit("change",...t)),onCreate:t[1]||(t[1]=(...t)=>e.$emit("create",...t)),onDelete:t[2]||(t[2]=(...t)=>e.$emit("delete",...t))},{default:Object(r["E"])(()=>[e.isEditable?(Object(r["r"])(),Object(r["f"])("button",{key:0,class:"delete-button",onPointerdown:t=>e.onDelete(i),tabindex:"-1"},"✗",40,_)):Object(r["e"])("",!0)]),_:2},1064,["property"])):(Object(r["r"])(),Object(r["f"])(r["a"],{key:1},[(Object(r["r"])(),Object(r["d"])(Object(r["z"])(e.getField(s.type)),{property:s,onChange:t[3]||(t[3]=(...t)=>e.$emit("change",...t)),onCreate:t[4]||(t[4]=(...t)=>e.$emit("create",...t)),onDelete:t[5]||(t[5]=(...t)=>e.$emit("delete",...t))},null,40,["property"])),e.isEditable?(Object(r["r"])(),Object(r["f"])("button",{key:0,class:"delete-button",onPointerdown:t=>e.onDelete(i),tabindex:"-1"},"✗",40,m)):Object(r["e"])("",!0)],64))]))),128)),e.isEditable?(Object(r["r"])(),Object(r["f"])("button",{key:0,class:"create-button",onPointerdown:t[6]||(t[6]=t=>e.onCreate())},[Object(r["g"])("span",null,[Object(r["i"])(a)]),Object(r["h"])("Add ")],32)):Object(r["e"])("",!0)])}const x=["fill"],w=Object(r["g"])("path",{d:"m0.79375 0v0.79375h-0.79375v0.52917h0.79375v0.79375h0.52917v-0.79375h0.79375v-0.52917h-0.79375v-0.79375z"},null,-1),j=[w];function O(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("svg",{width:"8",height:"8",version:"1.1",viewBox:"0 0 2.1167 2.1167",xmlns:"http://www.w3.org/2000/svg",fill:e.color},j,8,x)}var S=Object(r["k"])({name:"Plus",props:{color:{type:String,default:"#737373"}}});const k=g()(S,[["render",O]]);var M=k;const B={class:"grid-container"},D={class:"value-container"},T={key:0,class:"dropdown-arrow"},C={class:"dropdown-options"},P=["onMouseenter","onClick"];function E(e,t,i,s,o,n){const a=Object(r["y"])("ScrollBox"),l=Object(r["y"])("FocusBox");return Object(r["r"])(),Object(r["d"])(l,{class:Object(r["p"])(["enum-field-control",{disabled:!e.isEditable,open:e.showMenu}]),onFocus:e.openMenu,onUnfocus:e.closeMenu},{default:Object(r["E"])(()=>[Object(r["g"])("div",B,[Object(r["g"])("div",D,[Object(r["g"])("div",{class:Object(r["p"])(["value-text",{"is-null":e.isNull}])},Object(r["A"])(e._property.toString()),3),e.isEditable?(Object(r["r"])(),Object(r["f"])("div",T,"▼")):Object(r["e"])("",!0)]),e.showMenu?(Object(r["r"])(),Object(r["d"])(a,{key:0,propagateScroll:!1,style:Object(r["q"])(e.style)},{default:Object(r["E"])(()=>[Object(r["g"])("ul",C,[Object(r["g"])("li",{class:Object(r["p"])([{active:"null"===e.hovered},"null"]),onMouseenter:t[0]||(t[0]=t=>e.hovered="null"),onClick:t[1]||(t[1]=Object(r["G"])(t=>e.updateProperty(null),["stop"]))}," Null ",34),(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.options,([t,i])=>(Object(r["r"])(),Object(r["f"])("li",{key:t,class:Object(r["p"])({active:e.hovered===t}),onMouseenter:i=>e.hovered=t,onClick:Object(r["G"])(i=>e.updateProperty(t),["stop"])},Object(r["A"])(i.toString()),43,P))),128))])]),_:1},8,["style"])):Object(r["e"])("",!0)])]),_:1},8,["class","onFocus","onUnfocus"])}var A=i("e0ac"),L=i("6f01"),H=Object(r["k"])({name:"EnumField",props:{property:{type:Object,required:!0},maxHeight:{type:Number,default:200}},data(){return{hovered:"",showMenu:!1}},computed:{_property(){this.property.trigger.value;return this.property},isEditable(){var e;return null===(e=this._property.descriptor.is_editable)||void 0===e||e},options(){return this._property.options.value},isNull(){return null===this._property.toRawValue()},style(){return{maxHeight:this.maxHeight+"px"}}},methods:{openMenu(){this.isEditable&&(this.showMenu=!0)},closeMenu(){this.showMenu=!1,this.refreshValue()},updateProperty(e){this._property.toRawValue()!==e?this.$emit("change",this._property,e):this.refreshValue(),this.showMenu=!1},refreshValue(){var e;this.hovered=null!==(e=this._property.toRawValue())&&void 0!==e?e:"null"}},emits:["change"],watch:{"_property.trigger.value"(){this.refreshValue()}},mounted(){this.refreshValue()},components:{FocusBox:A["a"],ScrollBox:L["a"]}});i("2c04");const I=g()(H,[["render",E],["__scopeId","data-v-2178b796"]]);var F=I;const z=["disabled"],V={key:0,class:"increment-arrows"};function R(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",{class:Object(r["p"])(["number-field-control",{disabled:!e.isEditable}]),tabindex:"0",onFocus:t[6]||(t[6]=t=>e.onFocus())},[Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.value=t),type:"text",ref:"field",placeholder:"Null",onInput:t[1]||(t[1]=(...t)=>e.onInput&&e.onInput(...t)),onKeydown:t[2]||(t[2]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),onBlur:t[3]||(t[3]=(...t)=>e.onBlur&&e.onBlur(...t)),disabled:!e.isEditable},null,40,z),[[r["B"],e.value]]),e.isEditable?(Object(r["r"])(),Object(r["f"])("div",V,[Object(r["g"])("div",{class:"up-arrow",onClick:t[4]||(t[4]=t=>e.updateProperty(1))},"▲"),Object(r["g"])("div",{class:"down-arrow",onClick:t[5]||(t[5]=t=>e.updateProperty(-1))},"▼")])):Object(r["e"])("",!0)],34)}var N=Object(r["k"])({name:"NumberField",setup(){return{field:Object(r["v"])(null)}},props:{property:{type:Object,required:!0}},data(){return{value:""}},computed:{_property(){this.property.trigger.value;return this.property},isEditable(){var e;return null===(e=this._property.descriptor.is_editable)||void 0===e||e}},methods:{onFocus(){this.$nextTick(()=>{this.field.focus()})},onInput(){""===this.value&&this.updateProperty(0)},onBlur(){this.updateProperty(0)},onKeyDown(e){switch(e.key){case"ArrowUp":e.preventDefault(),this.updateProperty(1);break;case"ArrowDown":e.preventDefault(),this.updateProperty(-1);break}},updateProperty(e=0){let t;if(""===this.value&&0===e)t=null;else{t=parseFloat(this.value),Number.isNaN(t)?t=0:t+=e;let{min:i,max:r}=this._property;t=Object(a["A"])(t,i,r),this._property.type===a["u"].Int&&(t=Math.round(t))}this._property.toRawValue()!==t?this.$emit("change",this._property,t):this.refreshValue()},refreshValue(){var e;this.value=""+(null!==(e=this._property.toRawValue())&&void 0!==e?e:"")}},emits:["change"],watch:{"_property.trigger.value"(){this.refreshValue()}},mounted(){this.refreshValue()}});i("b0fd");const $=g()(N,[["render",R],["__scopeId","data-v-60cf922a"]]);var q=$;const G=e=>(Object(r["t"])("data-v-f603942e"),e=e(),Object(r["s"])(),e),U={class:"grid-container"},W={class:"value"},Y={key:0,class:"null-value"},K={key:1,class:"date-value"},X={class:"editor"},J=G(()=>Object(r["g"])("span",null,"/",-1)),Z=G(()=>Object(r["g"])("span",null,"/",-1)),Q=G(()=>Object(r["g"])("span",{class:"space"},null,-1)),ee=G(()=>Object(r["g"])("span",null,":",-1)),te=G(()=>Object(r["g"])("span",null,":",-1)),ie=G(()=>Object(r["g"])("span",{class:"timezone"},"Z",-1));function re(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",{class:Object(r["p"])(["datetime-field-control",{disabled:!e.isEditable}]),tabindex:"0",onFocus:t[18]||(t[18]=t=>e.enterEditMode())},[Object(r["g"])("div",U,[Object(r["F"])(Object(r["g"])("div",W,[null===e.value?(Object(r["r"])(),Object(r["f"])("p",Y," Null ")):(Object(r["r"])(),Object(r["f"])("p",K,Object(r["A"])(e.prop_M)+" "+Object(r["A"])(e.prop_D)+", "+Object(r["A"])(e.prop_Y)+" - "+Object(r["A"])(e.prop_H)+":"+Object(r["A"])(e.prop_m)+":"+Object(r["A"])(e.prop_s),1))],512),[[r["C"],!e.showEditor]]),Object(r["F"])(Object(r["g"])("div",X,[Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"2",segment:"M",ref:"M",class:"M",placeholder:"MM",onBlur:t[0]||(t[0]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[1]||(t[1]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[2]||(t[2]=t=>e.value_M=t)},null,544),[[r["B"],e.value_M]]),J,Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"2",segment:"D",ref:"D",class:"D",placeholder:"DD",onBlur:t[3]||(t[3]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[4]||(t[4]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[5]||(t[5]=t=>e.value_D=t)},null,544),[[r["B"],e.value_D]]),Z,Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"4",segment:"Y",ref:"Y",class:"Y",placeholder:"YYYY",onBlur:t[6]||(t[6]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[7]||(t[7]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[8]||(t[8]=t=>e.value_Y=t)},null,544),[[r["B"],e.value_Y]]),Q,Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"2",segment:"H",ref:"H",class:"H",placeholder:"HH",onBlur:t[9]||(t[9]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[10]||(t[10]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[11]||(t[11]=t=>e.value_H=t)},null,544),[[r["B"],e.value_H]]),ee,Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"2",segment:"m",ref:"m",class:"m",placeholder:"mm",onBlur:t[12]||(t[12]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[13]||(t[13]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[14]||(t[14]=t=>e.value_m=t)},null,544),[[r["B"],e.value_m]]),te,Object(r["F"])(Object(r["g"])("input",{type:"text",maxlength:"2",segment:"s",ref:"s",class:"s",placeholder:"ss",onBlur:t[15]||(t[15]=(...t)=>e.onBlur&&e.onBlur(...t)),onKeydown:t[16]||(t[16]=(...t)=>e.onKeyDown&&e.onKeyDown(...t)),"onUpdate:modelValue":t[17]||(t[17]=t=>e.value_s=t)},null,544),[[r["B"],e.value_s]]),ie],512),[[r["C"],e.showEditor]])])],34)}const se=["M","D","Y","H","m","s"],oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ne=Object(r["k"])({name:"DateTimeField",setup(){return{M:Object(r["v"])(null),D:Object(r["v"])(null),Y:Object(r["v"])(null),H:Object(r["v"])(null),m:Object(r["v"])(null),s:Object(r["v"])(null)}},props:{property:{type:Object,required:!0}},data(){return{value_M:"",value_D:"",value_Y:"",value_H:"",value_m:"",value_s:"",showEditor:!1}},computed:{_property(){this.property.trigger.value;return this.property},isEditable(){var e;return null===(e=this._property.descriptor.is_editable)||void 0===e||e},value(){let e=this._property.toRawValue();return null!==e?new Date(e):e},prop_M(){let e=this.value;return e?oe[e.getUTCMonth()]:"Null"},prop_D(){var e;let t=this.value;return""+(null!==(e=null===t||void 0===t?void 0:t.getUTCDate())&&void 0!==e?e:"Null")},prop_Y(){var e;let t=this.value;return""+(null!==(e=null===t||void 0===t?void 0:t.getUTCFullYear())&&void 0!==e?e:"Null")},prop_H(){let e=this.value;return e?(""+e.getUTCHours()).padStart(2,"0"):"Null"},prop_m(){let e=this.value;return e?(""+e.getUTCMinutes()).padStart(2,"0"):"Null"},prop_s(){let e=this.value;return e?(""+e.getUTCSeconds()).padStart(2,"0"):"Null"}},methods:{onBlur(e){this.$el.contains(e.relatedTarget)||this.exitEditMode()},onKeyDown(e){let t=e.target;if(t.selectionStart===t.selectionEnd)switch(e.key){case"Backspace":0===t.selectionEnd&&this.shiftFocus(-1,!1);break;case"ArrowLeft":0===t.selectionEnd&&(this.shiftFocus(-1,!1),e.preventDefault());break;case"ArrowRight":t.selectionEnd===t.maxLength&&(this.shiftFocus(1,!0),e.preventDefault());break;default:t.selectionEnd===t.maxLength&&this.shiftFocus(1,!0)}},enterEditMode(){this.isEditable&&(this.showEditor=!0,this.$nextTick(()=>{let e;for(let t of se)if(e=this[t],!e.value)break;e.focus(),e.selectionEnd=e.value.length}))},exitEditMode(){this.updateProperty(),this.showEditor=!1},shiftFocus(e,t=!0){let i=document.activeElement,r=se.indexOf(i.getAttribute("segment"))+e;0<=r&&r<se.length&&this.$nextTick(()=>{let e=this[se[r]];e.focus(),e.selectionEnd=t?0:e.value.length})},updateProperty(){var e;let t,i=`${this.value_Y.padStart(4,"0")}-${this.value_M.padStart(2,"0")}-${this.value_D.padStart(2,"0")}T${this.value_H.padStart(2,"0")}:${this.value_m.padStart(2,"0")}:${this.value_s.padStart(2,"0")}.000Z`,r=new Date(i);t="0000-00-00T00:00:00.000Z"===i||Number.isNaN(r.getTime())?null:r,(null===(e=this.value)||void 0===e?void 0:e.getTime())!==(null===t||void 0===t?void 0:t.getTime())?this.$emit("change",this._property,t):this.refreshValue()},refreshValue(){var e,t;let i=null!==(t=null===(e=this.value)||void 0===e?void 0:e.toISOString())&&void 0!==t?t:"--T::",[r,s,o,n,a,l]=i.split(/[-T:\.]/);this.value_Y=r,this.value_M=s,this.value_D=o,this.value_H=n,this.value_m=a,this.value_s=l}},emits:["change"],watch:{"_property.trigger.value"(){this.refreshValue()}},mounted(){this.refreshValue()}});i("451d");const ae=g()(ne,[["render",re],["__scopeId","data-v-f603942e"]]);var le=ae;const ce=Object(r["j"])(()=>i.e("chunk-69bedc3b").then(i.bind(null,"f090")));var de=Object(r["k"])({name:"ListField",props:{property:{type:Object,required:!0}},computed:{_property(){this.property.trigger.value;return this.property},isEditable(){var e;return null===(e=this._property.descriptor.is_editable)||void 0===e||e}},methods:{getField(e){switch(e){case a["u"].Int:case a["u"].Float:return"NumberField";case a["u"].String:return"TextField";case a["u"].Date:return"DateTimeField";case a["u"].Enum:return"EnumField";case a["u"].List:return"ListField";case a["u"].Dictionary:return"DictionaryField"}},onCreate(){this.$emit("create",this._property)},onDelete(e){this.$emit("delete",this._property,e)}},emits:["change","create","delete"],components:{Plus:M,TextField:f,EnumField:F,NumberField:q,DateTimeField:le,DictionaryField:ce}});i("a808");const he=g()(de,[["render",v],["__scopeId","data-v-1f8ec412"]]);var ue=he;const pe=Object(r["j"])(()=>i.e("chunk-69bedc3b").then(i.bind(null,"f090")));var ge=Object(r["k"])({name:"DictionaryFieldContents",props:{property:{type:Object,required:!0}},computed:{fields(){return[...this.property.value.entries()].filter(e=>{var t;return null===(t=e[1].descriptor.is_visible)||void 0===t||t})}},methods:{getField(e){switch(e){case a["u"].String:return"TextField";case a["u"].Int:case a["u"].Float:return"NumberField";case a["u"].Date:return"DateTimeField";case a["u"].Enum:return"EnumField";case a["u"].List:return"ListField";case a["u"].Dictionary:return"DictionaryField"}},titleCase:a["C"]},emits:["change","create","delete"],components:{TextField:f,ListField:ue,EnumField:F,NumberField:q,DateTimeField:le,DictionaryField:pe}});i("9e53");const ye=g()(ge,[["render",n],["__scopeId","data-v-5181abbf"]]);t["a"]=ye},"6f01":function(e,t,i){"use strict";var r=i("7a23");const s={class:"scrollbox-container"};function o(e,t,i,o,n,a){return Object(r["r"])(),Object(r["f"])("div",s,[Object(r["g"])("div",{ref:"content",class:"scroll-content",onWheelPassive:t[0]||(t[0]=t=>e.moveScrollPosition(e.scrollTop+t.deltaY,t))},[Object(r["x"])(e.$slots,"default",{},void 0,!0)],544),Object(r["F"])(Object(r["g"])("div",{class:"scroll-bar",style:Object(r["q"])(e.scroll.sty),onWheelPassive:t[3]||(t[3]=t=>e.moveScrollPosition(e.scrollTop+t.deltaY,t))},[Object(r["F"])(Object(r["g"])("div",{class:"scroll-handle",style:Object(r["q"])(e.handle.sty),onPointerdown:t[1]||(t[1]=(...t)=>e.startDrag&&e.startDrag(...t)),onPointerup:t[2]||(t[2]=(...t)=>e.stopDrag&&e.stopDrag(...t))},null,36),[[r["C"],e.showScrollbar]])],36),[[r["C"],e.alwaysShowScrollBar||e.showScrollbar]])])}var n=i("24a6"),a=i("a2be"),l=Object(r["k"])({name:"ScrollBox",setup(){return{content:Object(r["v"])(null)}},props:{resetScrollOnChange:{type:Boolean,default:!1},alwaysShowScrollBar:{type:Boolean,default:!1},propagateScroll:{type:Boolean,default:!0},handleColor:{type:String,default:"#333333"},scrollColor:{type:String,default:"none"},borderColor:{type:String,default:"#404040"},width:{type:Number,default:17}},data(){return{scrollTop:0,windowMax:0,scroll:{sty:{width:this.width+"px",background:this.scrollColor}},handle:{trk:Object(r["o"])(new a["a"]),hei:0,max:0,pos:0,sty:{height:"0px",transform:"translateY(0px)",background:this.handleColor,borderColor:this.borderColor}},showScrollbar:!1,onResizeObserver:null,onMutateObserver:null}},methods:{startDrag(e){this.handle.trk.capture(e,this.onDrag),document.addEventListener("pointerup",this.stopDrag,{once:!0})},onDrag(e,t){this.moveScrollPosition(this.handleTopToTop(this.handle.pos+t.movementY))},stopDrag(e){this.handle.trk.release(e)},recalculateScrollState(e=!0){let t=this.showScrollbar,i=this.content;if(0===i.clientHeight)return void(this.showScrollbar=!1);let r=i.clientHeight/i.scrollHeight;this.handle.hei=Math.max(15,Math.round((i.clientHeight-4)*r)),this.handle.max=i.clientHeight-this.handle.hei-4,this.windowMax=i.scrollHeight-i.clientHeight,this.showScrollbar=1!==r,this.handle.sty.height=this.handle.hei+"px",this.moveScrollPosition(e?0:i.scrollTop),!t&&this.showScrollbar&&setTimeout(()=>this.recalculateScrollState(e),0)},moveScrollPosition(e,t=null){let i=this.scrollTop;this.scrollTop=Object(n["A"])(e,0,this.windowMax),this.handle.pos=this.topToHandleTop(this.scrollTop),this.handle.sty.transform=`translateY(${this.handle.pos}px)`,this.content.scrollTop=this.scrollTop;let r=i-this.scrollTop!==0,s=0<this.scrollTop&&this.scrollTop<this.windowMax;(!this.propagateScroll||r||s)&&(null===t||void 0===t||t.stopPropagation())},topToHandleTop(e){return e/this.windowMax*this.handle.max},handleTopToTop(e){return e/this.handle.max*this.windowMax}},mounted(){let e={childList:!0,characterData:!0,subtree:!0};this.onMutateObserver=new MutationObserver(()=>this.recalculateScrollState(this.resetScrollOnChange)),this.onResizeObserver=new ResizeObserver(()=>this.recalculateScrollState(!1)),this.onResizeObserver.observe(this.$el),this.onMutateObserver.observe(this.content,e)},unmounted(){this.onResizeObserver.disconnect(),this.onMutateObserver.disconnect()}}),c=(i("4ba3"),i("6b0d")),d=i.n(c);const h=d()(l,[["render",o],["__scopeId","data-v-cf54a08c"]]);t["a"]=h},"74c2":function(e,t,i){},"754c":function(e,t,i){"use strict";i("4aad")},"75a4":function(e,t,i){"use strict";i("aadc")},"760f":function(e,t,i){"use strict";i("1214")},"7f3b":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(){this._scale=1,this._cache=new Map}createRaster(e,t,i,r=0){let o=new s(t,i,r,this._scale);return this._cache.set(e,o),o}drawRaster(e,t,i,r){let s=this._cache.get(t);return!!s&&(e.drawImage(s.canvas,i-s.cx,r-s.cy,s.w,s.h),!0)}setScale(e){this._scale=e,this._cache.clear()}getScale(){return this._scale}}class s{constructor(e,t,i,r){let s=i<<1;this.canvas=document.createElement("canvas"),this.canvas.width=Math.round((e+s)*r),this.canvas.height=Math.round((t+s)*r),this.context=this.canvas.getContext("2d"),this.context.setTransform(r,0,0,r,0,0),this.h=t+s,this.w=e+s,this.cx=Math.round(this.w/2),this.cy=Math.round(this.h/2),this.p=i}set fillStyle(e){this.context.fillStyle=e}set font(e){this.context.font=e}set lineWidth(e){this.context.lineWidth=e}set strokeStyle(e){this.context.strokeStyle=e}set textBaseline(e){this.context.textBaseline=e}beginPath(){this.context.beginPath()}closePath(){this.context.closePath()}moveTo(e,t){this.context.moveTo(this.p+e,this.p+t)}lineTo(e,t){this.context.lineTo(this.p+e,this.p+t)}stroke(){this.context.stroke()}fill(){this.context.fill()}fillText(e,t,i){this.context.fillText(e,t,i)}drawRect(e,t,i,r,s,o=1){e+=this.p+o/2,t+=this.p+o/2,i-=o,r-=o,s="number"===typeof s?{tl:s,tr:s,br:s,bl:s}:Object.assign({tl:0,tr:0,br:0,bl:0},s);let n=this.context;n.beginPath(),n.moveTo(e+s.tl,t),n.lineTo(e+i-s.tr,t),n.quadraticCurveTo(e+i,t,e+i,t+s.tr),n.lineTo(e+i,t+r-s.br),n.quadraticCurveTo(e+i,t+r,e+i-s.br,t+r),n.lineTo(e+s.bl,t+r),n.quadraticCurveTo(e,t+r,e,t+r-s.bl),n.lineTo(e,t+s.tl),n.quadraticCurveTo(e,t,e+s.tl,t),n.closePath()}}},"856c":function(e,t,i){"use strict";i("f9d8")},"872d":function(e,t,i){"use strict";i("335e")},9224:function(e){e.exports=JSON.parse('{"name":"attack-flow-builder","version":"0.1.0","private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build"},"author":"mcarenzo","dependencies":{"vue":"^3.0.0","vuex":"^4.0.0-0"},"devDependencies":{"@types/d3":"^7.4.0","@types/resize-observer-browser":"^0.1.7","@vue/cli-plugin-typescript":"~4.5.15","@vue/cli-plugin-vuex":"~4.5.15","@vue/cli-service":"~4.5.15","@vue/compiler-sfc":"^3.0.0","d3":"^7.4.4","standard-version":"^9.3.2","typescript":"^4.1.5"},"browserslist":["> 1%","last 2 versions","not dead"]}')},"92f3":function(e,t,i){},9453:function(e,t,i){},"98d9":function(e,t,i){},"9a52":function(e,t,i){"use strict";i("92f3")},"9de6":function(e,t,i){},"9e53":function(e,t,i){"use strict";i("e16f")},"9e60":function(e,t,i){},a2be:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(){this.deltaX=0,this.deltaY=0,this.movementX=0,this.movementY=0,this.target=null,this._originX=0,this._originY=0,this._lastX=0,this._lastY=0}capture(e,t){this._originX=e.clientX,this._originY=e.clientY,this._lastX=this._originX,this._lastY=this._originY,this.target=e.target,this.target.setPointerCapture(e.pointerId),this.target.onpointermove=e=>{this.update(e),t(e,this)}}update(e){this.deltaX=e.clientX-this._originX,this.deltaY=e.clientY-this._originY,this.movementX=e.clientX-this._lastX,this.movementY=e.clientY-this._lastY,this._lastX=e.clientX,this._lastY=e.clientY}release(e){null!==this.target&&(this.target.releasePointerCapture(e.pointerId),this.target.onpointermove=null,this.target=null)}}},a508:function(e,t,i){},a808:function(e,t,i){"use strict";i("c544")},a80d:function(e,t,i){"use strict";i.d(t,"g",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return n})),i.d(t,"e",(function(){return a})),i.d(t,"f",(function(){return c})),i.d(t,"h",(function(){return d})),i.d(t,"j",(function(){return h})),i.d(t,"k",(function(){return u})),i.d(t,"l",(function(){return g})),i.d(t,"m",(function(){return y})),i.d(t,"a",(function(){return f})),i.d(t,"i",(function(){return b})),i.d(t,"b",(function(){return _})),i.d(t,"o",(function(){return m})),i.d(t,"n",(function(){return v}));var r=i("1dd9");class s{constructor(e,t){this.el=e,this.x=e.boundingBox.xMid,this.y=e.boundingBox.yMid,this.parent=void 0,this.children=[],this._rasterCache=t}*getSubtree(e){let t=new Set([this.el.id]),i=[this];while(0!=i.length){let r=i.shift();if(e&&!e(r)||(yield r),!(r instanceof o))for(let e of r.children)t.has(e.el.id)||(t.add(e.el.id),i.push(e))}}moveTo(e,t,i){this.moveBy(e-this.x,t-this.y)}moveBy(e,t,i){this.x+=e,this.y+=t;for(let r of this.children)r instanceof n&&r.el.isAttached()||r.moveBy(e,t)}renderTo(e,t,i=0,r=0,s){if(this.isVisible(t))for(let o of this.children)o.renderTo(e,t,i,r)}renderDebugTo(e,t){if(!this.isVisible(t))return;for(let r of this.children)r.renderDebugTo(e,t);let i=this.el.boundingBox;e.beginPath(),e.moveTo(i.xMin+.5,i.yMin+.5),e.lineTo(i.xMax-.5,i.yMin+.5),e.lineTo(i.xMax-.5,i.yMax-.5),e.lineTo(i.xMin+.5,i.yMax-.5),e.lineTo(i.xMin+.5,i.yMin+.5),e.lineTo(i.xMax-.5,i.yMax-.5),e.stroke()}isVisible(e){let{xMin:t,yMin:i,xMax:r,yMax:s}=this.el.boundingBox;return e.xMin<=r&&e.xMax>=t&&e.yMin<=s&&e.yMax>=i}updateView(){let e=new Array(this.el.children.length);for(let t=0;t<e.length;t++){let i=this.el.children[t].id,r=this.children.find(e=>e.el.id===i);e[t]=null!==r&&void 0!==r?r:this.el.children[t].createView(this._rasterCache),e[t].parent=this,e[t].updateView()}return this.children=e,this.x=this.el.boundingBox.xMid,this.y=this.el.boundingBox.yMid,this}fakeAlignment(e){return this.el.attrs&~r["b"]|e}fakeCursor(e){return this.el.attrs&~r["e"]|e}fakeHover(e){return this.el.attrs&~r["g"]|e}fakeInheritAlignment(e){return this.el.attrs&~r["i"]|e}fakePositionSetByUser(e){return this.el.attrs&~r["k"]|e}fakePriority(e){return this.el.attrs&~r["m"]|e}fakeSelect(e){return this.el.attrs&~r["o"]|e}}class o extends s{constructor(e,t){super(e,t),this.children=[],this.el=e}moveBy(e,t,i){this.x+=e,this.y+=t;for(let r of this.children)r.el.isAttached(this.el)?r.moveTo(this.x,this.y):console.warn(`'${r.el.id}' incorrectly attached to anchor.`)}updateView(){return this.x=this.el.boundingBox.xMid,this.y=this.el.boundingBox.yMid,this}}class n extends s{constructor(e,t){super(e,t),this.el=e}}class a extends n{constructor(e,t){super(e,t),this.el=e}moveBy(e,t,i,r=!1){var s;r?super.moveBy(e,t,i):null===(s=this.parent)||void 0===s||s.moveChild(this.el.id,e,t,i)}}class l extends s{constructor(e,t){super(e,t),this.el=e}moveBy(e,t,i,r=!1){var s;r?super.moveBy(e,t,i):null===(s=this.parent)||void 0===s||s.moveChild(this.el.id,e,t,i)}}class c extends s{constructor(e,t){super(e,t),this.el=e,this.children=[]}get srcEnding(){return this.children.at(0)}get trgEnding(){return this.children.at(-1)}}class d extends s{constructor(e,t){super(e,t),this.el=e,this._objectCache=new Map}renderDebugTo(e,t){e.save(),e.lineWidth=1,e.fillStyle="#00ff00",e.strokeStyle="#ffffff",e.setLineDash([2,2]),super.renderDebugTo(e,t),e.restore()}updateView(){super.updateView(),this._objectCache.clear();for(let e of this.getSubtree())this._objectCache.set(e.el.id,e);for(let e of this.el.anchorCache){let t=this.lookup(e.id);t.children=new Array(e.children.length);for(let i=0;i<t.children.length;i++){let r=e.children[i];t.children[i]=this.lookup(r.id),t.children[i].anchor=t}}return this}lookup(e){return this._objectCache.get(e)}}class h extends a{constructor(e,t){super(e,t),this.el=e}renderTo(e,t,i=0,r=0,s){let{radius:o,fill_color:n,stroke_color:a,stroke_width:l}=this.el.style;e.fillStyle=n,e.lineWidth=l,e.strokeStyle=a,e.beginPath(),e.arc(this.x,this.y,o,0,2*Math.PI),e.closePath(),e.fill(),e.stroke()}}class u extends l{constructor(e,t){super(e,t),this.el=e}renderTo(e,t,i=0,r=0,s){let{radius:o,fill_color:n,stroke_color:a,stroke_width:l}=this.el.style;e.fillStyle=n,e.lineWidth=l,e.strokeStyle=a;let c=l%2?.5:0;e.beginPath(),e.arc(this.x,this.y,o+c,0,2*Math.PI),e.closePath(),e.fill(),e.stroke()}}var p=i("13c3");class g extends c{constructor(e,t){super(e,t),this.el=e}moveChild(e,t,i,r){let s=this.children.find(t=>t.el.id===e);if(!s)return;s instanceof a&&s.moveBy(t,i,void 0,!0);let[o,n,l]=this.children,c=(o.x+l.x)/2-n.x,d=(o.y+l.y)/2-n.y;n.el.hasUserSetPosition(s===n?r:void 0)?s===n&&n.moveBy(t,0,void 0,!0):n.moveBy(c,0,void 0,!0),n.moveBy(0,d,void 0,!0)}renderTo(e,t,i=0,s=0,o){if(!this.isVisible(t))return;let n,{children:a}=this,{cap_size:l,width:c,color:d,select_color:h}=this.el.style;switch(e.lineWidth=c,this.el.attrs&r["o"]){case r["n"].True:n=h;break;case r["n"].False:default:n=d;break}e.fillStyle=n,e.strokeStyle=n;let u=c%2?.5:0,g=Math.sign(a[2].x-a[1].x)*(l>>1);e.beginPath(),e.moveTo(a[0].x,a[0].y+u),e.lineTo(a[1].x+u,a[0].y+u),e.lineTo(a[1].x+u,a[2].y+u),e.lineTo(a[2].x-g,a[2].y+u),e.stroke(),Object(p["h"])(e,a[1].x,a[2].y+u,a[2].x,a[2].y+u,l),e.fill(),this.el.isSelected(o)&&super.renderTo(e,t,i,s)}renderDebugTo(e,t){if(!this.isVisible(t))return;let i=2,r=2*Math.PI;e.beginPath();for(let s of this.el.hitboxes)for(let t=0;t<s.length;t+=2)e.moveTo(s[t]+i,s[t+1]),e.arc(s[t],s[t+1],i,0,r);e.fill(),super.renderDebugTo(e,t)}}class y extends c{constructor(e,t){super(e,t),this.el=e}moveChild(e,t,i,r){let s=this.children.find(t=>t.el.id===e);if(!s)return;s instanceof a&&s.moveBy(t,i,void 0,!0);let[o,n,l]=this.children,c=(o.x+l.x)/2-n.x,d=(o.y+l.y)/2-n.y;n.el.hasUserSetPosition(s===n?r:void 0)?s===n&&n.moveBy(0,i,void 0,!0):n.moveBy(0,d,void 0,!0),n.moveBy(c,0,void 0,!0)}renderTo(e,t,i=0,s=0,o){if(!this.isVisible(t))return;let n,{children:a}=this,{cap_size:l,width:c,color:d,select_color:h}=this.el.style;switch(e.lineWidth=c,this.el.attrs&r["o"]){case r["n"].True:n=h;break;case r["n"].False:default:n=d;break}e.fillStyle=n,e.strokeStyle=n;let u=c%2?.5:0,g=Math.sign(a[1].y-a[2].y)*(l>>1);e.beginPath(),e.moveTo(a[0].x+u,a[0].y),e.lineTo(a[0].x+u,a[1].y+u),e.lineTo(a[2].x+u,a[1].y+u),e.lineTo(a[2].x+u,a[2].y+g),e.stroke(),Object(p["h"])(e,a[2].x+u,a[1].y,a[2].x+u,a[2].y,l),e.fill(),this.el.isSelected(o)&&super.renderTo(e,t,i,s)}renderDebugTo(e,t){if(!this.isVisible(t))return;let i=2,r=2*Math.PI;e.beginPath();for(let s of this.el.hitboxes)for(let t=0;t<s.length;t+=2)e.moveTo(s[t]+i,s[t+1]),e.arc(s[t],s[t+1],i,0,r);e.fill(),super.renderDebugTo(e,t)}}class f extends o{constructor(e,t){super(e,t),this.el=e}renderTo(e,t,i=0,r=0,s){this.el.isHovered(s)&&(e.fillStyle=this.el.style.color,e.beginPath(),e.arc(this.x,this.y,this.el.radius,0,2*Math.PI),e.closePath(),e.fill())}}class b extends s{constructor(e,t){super(e,t),this.el=e,this.tlx=0,this.tly=0}moveBy(e,t,i){super.moveBy(e,t),this.tlx+=e,this.tly+=t}renderTo(e,t,i=0,r=0,s){if(!this.isVisible(t))return;let o,n,{tlx:a,tly:l}=this,{body:c,head:d,select_outline:h,border_radius:u}=this.el.style,{width:g,height:y,headerHeight:f,text:b}=this.el.layout,_=f!==y;_?(o=c.fill_color,n=c.stroke_color):(o=d.fill_color,n=d.stroke_color),e.lineWidth=1.1,Object(p["i"])(e,a,l,g,y,u),i|r?(e.shadowOffsetX=i+.5*t.scale,e.shadowOffsetY=r+.5*t.scale,e.fillStyle=o,e.strokeStyle=n,e.fill(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke()):(e.fillStyle=o,e.strokeStyle=n,e.fill(),e.stroke()),_&&(Object(p["i"])(e,a,l,g,f,{tr:u,tl:u}),e.fillStyle=d.fill_color,e.strokeStyle=d.stroke_color,e.fill(),e.stroke());for(let p of b){e.font=p.font.css,e.fillStyle=p.color;for(let t of p.text)e.fillText(t.t,a+t.x,l+t.y)}if(this.el.isSelected(s)){let{color:t,padding:i,border_radius:r}=h;i+=1,Object(p["i"])(e,a-i,l-i,g+2*i,y+2*i,r,1),e.strokeStyle=t,e.stroke()}else if(this.el.isHovered(s)){let{color:s,size:o}=this.el.style.anchor_markers;super.renderTo(e,t,i,r),e.strokeStyle=s,e.beginPath();for(let t of this.children)e.moveTo(t.x-o,t.y-o),e.lineTo(t.x+o,t.y+o),e.moveTo(t.x+o,t.y-o),e.lineTo(t.x-o,t.y+o);e.stroke()}}updateView(){return super.updateView(),this.tlx=this.el.boundingBox.xMin+this.el.layout.dx,this.tly=this.el.boundingBox.yMin+this.el.layout.dy,this}}class _ extends s{constructor(e,t){super(e,t),this.el=e,this.tlx=0,this.tly=0}moveBy(e,t,i){super.moveBy(e,t),this.tlx+=e,this.tly+=t}renderTo(e,t,i=0,r=0,s){if(!this.isVisible(t))return;let o,n,{tlx:a,tly:l}=this,{body:c,head:d,select_outline:h,border_radius:u}=this.el.style,{width:g,height:y,headerHeight:f,text:b,lines:_}=this.el.layout,m=f!==y;m?(o=c.fill_color,n=c.stroke_color):(o=d.fill_color,n=d.stroke_color),e.lineWidth=1.1,Object(p["i"])(e,a,l,g,y,u),i|r?(e.shadowOffsetX=i+.5*t.scale,e.shadowOffsetY=r+.5*t.scale,e.fillStyle=o,e.strokeStyle=n,e.fill(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke()):(e.fillStyle=o,e.strokeStyle=n,e.fill(),e.stroke());for(let p of _)e.moveTo(a+p.x0,l+p.y0),e.lineTo(a+p.x1,l+p.y1);e.stroke(),m&&(Object(p["i"])(e,a,l,g,f,{tr:u,tl:u}),e.fillStyle=d.fill_color,e.strokeStyle=d.stroke_color,e.fill(),e.stroke());for(let p of b){e.font=p.font.css,e.fillStyle=p.color;for(let t of p.text)e.fillText(t.t,a+t.x,l+t.y)}if(this.el.isSelected(s)){let{color:t,padding:i,border_radius:r}=h;i+=1,Object(p["i"])(e,a-i,l-i,g+2*i,y+2*i,r,1),e.strokeStyle=t,e.stroke()}else if(this.el.isHovered(s)){let{color:s,size:o}=this.el.style.anchor_markers;super.renderTo(e,t,i,r),e.strokeStyle=s,e.beginPath();for(let t of this.children)e.moveTo(t.x-o,t.y-o),e.lineTo(t.x+o,t.y+o),e.moveTo(t.x+o,t.y-o),e.lineTo(t.x-o,t.y+o);e.stroke()}}updateView(){return super.updateView(),this.tlx=this.el.boundingBox.xMin+this.el.layout.dx,this.tly=this.el.boundingBox.yMin+this.el.layout.dy,this}}class m extends s{constructor(e,t){super(e,t),this.el=e,this.tlx=0,this.tly=0}moveBy(e,t,i){super.moveBy(e,t),this.tlx+=e,this.tly+=t}renderTo(e,t,i=0,r=0,s){if(!this.isVisible(t))return;let{tlx:o,tly:n}=this,{text:a,fill_color:l,stroke_color:c,select_outline:d,border_radius:h}=this.el.style,{width:u,height:g,text:y}=this.el.layout;e.lineWidth=1.1,i|r?(Object(p["i"])(e,o,n,u,g,h),e.shadowOffsetX=i+.5*t.scale,e.shadowOffsetY=r+.5*t.scale,e.fillStyle=l,e.strokeStyle=c,e.fill(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke()):(Object(p["i"])(e,o,n,u,g,h),e.fillStyle=l,e.strokeStyle=c,e.fill(),e.stroke()),e.font=a.font.css,e.fillStyle=a.color;for(let p of y)e.fillText(p.t,o+p.x,n+p.y);if(this.el.isSelected(s)){let{color:t,padding:i,border_radius:r}=d;i+=1,Object(p["i"])(e,o-i,n-i,u+2*i,g+2*i,r,1),e.strokeStyle=t,e.stroke()}else if(this.el.isHovered(s)){let{color:s,size:o}=this.el.style.anchor_markers;super.renderTo(e,t,i,r),e.strokeStyle=s,e.beginPath();for(let t of this.children)e.moveTo(t.x-o,t.y-o),e.lineTo(t.x+o,t.y+o),e.moveTo(t.x+o,t.y-o),e.lineTo(t.x-o,t.y+o);e.stroke()}}updateView(){return super.updateView(),this.tlx=this.el.boundingBox.xMin+this.el.layout.dx,this.tly=this.el.boundingBox.yMin+this.el.layout.dy,this}}class v extends d{constructor(e,t){super(e,t),this.el=e;let{grid_color:i,background_color:r}=this.el.style;this._gridPattern=this.createGridPattern(...this.el.grid,r,i)}get selects(){return[...this.getSubtree(e=>e.el.isSelected())]}renderPageSurfaceTo(e,t,i){e.fillStyle=i?this._gridPattern:this.el.style.background_color,e.fillRect(t.xMin,t.yMin,t.xMax-t.xMin,t.yMax-t.yMin)}renderTo(e,t,i=this.el.style.drop_shadow.offset[0],r=this.el.style.drop_shadow.offset[1],s){e.shadowColor=this.el.style.drop_shadow.color,super.renderTo(e,t,i*t.scale,r*t.scale)}createGridPattern(e,t,i,r){let s=document.createElement("canvas"),o=s.getContext("2d",{alpha:!1});s.width=e,s.height=t,o.fillStyle=i,o.lineWidth=2,o.strokeStyle=r,o.fillRect(0,0,e,t),o.moveTo(0,0),o.lineTo(0,t),o.lineTo(e,t),o.stroke();let n=o.createPattern(s,"repeat");return n.setTransform((new DOMMatrix).translate(0,1)),n}}},aadc:function(e,t,i){},b0fd:function(e,t,i){"use strict";i("98d9")},c40c:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o}));const r={Blue:{fill_color:"#637bc9",stroke_color:"#708ce6"},Orange:{fill_color:"#c26130",stroke_color:"#e57339"},Green:{fill_color:"#2a9642",stroke_color:"#32b34e"},Red:{fill_color:"#c94040",stroke_color:"#dd5050"},Gray:{fill_color:"#848484",stroke_color:"#6b6b6b"}};class s{constructor(e){this._theme=e}AnchorPoint(e={}){return this.merge(e,structuredClone(this._theme.anchor))}BranchBlock(e={}){return this.merge(e,structuredClone(this._theme.branch))}DictionaryBlock(e={}){return this.merge(e,structuredClone(this._theme.dictionary))}Line(e={}){return this.merge(e,structuredClone(this._theme.line))}LineEnding(e={}){return this.merge(e,structuredClone(this._theme.lineEnding))}LineHandle(e={}){return this.merge(e,structuredClone(this._theme.lineHandle))}TextBlock(e={}){return this.merge(e,structuredClone(this._theme.text))}Page(e={}){return this.merge(e,structuredClone(this._theme.page))}merge(e,t){for(let i in e){if(!(i in t))throw new Error("Objects do not overlap.");if(typeof e[i]!==typeof t[i])throw new Error(`'${i}' has mismatching types.`);"object"===typeof e[i]?this.merge(e[i],t[i]):t[i]=e[i]}return t}}const o=new s({anchor:{color:"rgba(255, 255, 255, 0.25)"},branch:{max_width:320,head:{fill_color:"#000",stroke_color:"#000",one_title:{title:{font:{family:"Inter",size:"10.5pt",weight:800},color:"#d8d8d8"}},two_title:{title:{font:{family:"Inter",size:"8pt",weight:600},color:"#d8d8d8",padding:8},subtitle:{font:{family:"Inter",size:"13pt",weight:800},color:"#d8d8d8",line_height:23}},vertical_padding:14},body:{fill_color:"#1f1f1f",stroke_color:"#383838",field_name:{font:{family:"Inter",size:"8pt",weight:600},color:"#b3b3b3",padding:12},field_value:{font:{family:"Inter",size:"10.5pt"},color:"#bfbfbf",line_height:20,padding:22},vertical_padding:18},branch:{font:{family:"Inter",size:"10.5pt"},color:"#bfbfbf",vertical_padding:12,horizontal_padding:30},select_outline:{color:"#e6d845",padding:4,border_radius:9},anchor_markers:{color:"#ffffff",size:3},border_radius:5,horizontal_padding:20},dictionary:{max_width:320,head:{fill_color:"#000",stroke_color:"#000",one_title:{title:{font:{family:"Inter",size:"10.5pt",weight:800},color:"#d8d8d8"}},two_title:{title:{font:{family:"Inter",size:"8pt",weight:600},color:"#d8d8d8",padding:8},subtitle:{font:{family:"Inter",size:"13pt",weight:800},color:"#d8d8d8",line_height:23}},vertical_padding:14},body:{fill_color:"#1f1f1f",stroke_color:"#383838",field_name:{font:{family:"Inter",size:"8pt",weight:600},color:"#b3b3b3",padding:12},field_value:{font:{family:"Inter",size:"10.5pt"},color:"#bfbfbf",line_height:20,padding:22},vertical_padding:18},select_outline:{color:"#e6d845",padding:4,border_radius:9},anchor_markers:{color:"#ffffff",size:3},border_radius:5,horizontal_padding:20},line:{width:5,cap_size:16,color:"#646464",select_color:"#646464"},lineEnding:{radius:6,fill_color:"#fedb22",stroke_color:"#141414",stroke_width:1.5},lineHandle:{radius:6,fill_color:"#fedb22",stroke_color:"#141414",stroke_width:1.5},text:{max_width:320,fill_color:"#000",stroke_color:"#000",text:{font:{family:"Inter",size:"14pt",weight:800},color:"#d8d8d8",line_height:24},border_radius:13,select_outline:{color:"#e6d845",padding:4,border_radius:19},anchor_markers:{color:"#ffffff",size:3},vertical_padding:18,horizontal_padding:20},page:{grid_color:"#1d1d1d",background_color:"#141414",drop_shadow:{color:"rgba(0,0,0,.4)",offset:[3,3]}}})},c544:function(e,t,i){},c609:function(e,t,i){"use strict";i("f0dd")},cb32:function(e,t,i){"use strict";i("9e60")},cbc0:function(e,t,i){"use strict";i.d(t,"f",(function(){return n})),i.d(t,"g",(function(){return a})),i.d(t,"i",(function(){return c})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return g})),i.d(t,"j",(function(){return b})),i.d(t,"k",(function(){return _})),i.d(t,"l",(function(){return v})),i.d(t,"m",(function(){return x})),i.d(t,"a",(function(){return w})),i.d(t,"h",(function(){return j})),i.d(t,"b",(function(){return O})),i.d(t,"o",(function(){return S})),i.d(t,"n",(function(){return k}));var r=i("5368"),s=i("317b"),o=i("1dd9");class n{constructor(e,t,i){var n,a,c,d,h;if(this.id=null!==(n=null===i||void 0===i?void 0:i.id)&&void 0!==n?n:crypto.randomUUID(),this.attrs=null!==(a=null===i||void 0===i?void 0:i.attrs)&&void 0!==a?a:o["j"].False,this.setAlignment(o["a"].Free),this.setCursor(o["c"].Default),this.setInheritAlignment(o["h"].True),this.setSemanticRole(s["f"].None),this.children=[],this.factory=e,this.template=t,this.boundingBox=new l,this.boundingBox.xMid=null!==(c=null===i||void 0===i?void 0:i.x)&&void 0!==c?c:0,this.boundingBox.yMid=null!==(d=null===i||void 0===i?void 0:i.y)&&void 0!==d?d:0,this.props=new r["i"](this,null!==(h=null===t||void 0===t?void 0:t.properties)&&void 0!==h?h:{},null===i||void 0===i?void 0:i.properties),null===i||void 0===i?void 0:i.children)for(let r=0;r<i.children.length;r++)this.addChild(i.children[r],r,!1)}get root(){let e=this;while(e.parent)e=e.parent;return e}*getSubtree(e){let t=new Set([this.id]),i=[this];while(0!=i.length){let r=i.shift();if(e&&!e(r)||(yield r),!(r instanceof d))for(let e of r.children)t.has(e.id)||(t.add(e.id),i.push(e))}}addChild(e,t=this.children.length,i=!0){if(-1!==this.children.indexOf(e))throw new a(`Object already has a child with the id '${e.id}'.`,this);e.parent=this,this.children.splice(t,0,e),i&&this.updateLayout(c.ChildAdded)}removeChild(e,t=!0,i=!0){let r=this.children.indexOf(e);if(-1===r)throw new a(`'${e.id}' is not a child of '${this.id}'.`,e);if(i&&e.hasExternalAttachments())throw new a(`'${e.id}' still maintains external attachments.`,e);e.parent=void 0,this.children.splice(r,1),t&&this.updateLayout(c.ChildDeleted)}reorderChild(e,t){let i=this.children.findIndex(t=>t.id===e),r=this.children[i];if(!r)throw new a(`Object has no child with the id '${e}'.`);this.children.splice(i,1),this.children.splice(t,0,r)}hasExternalAttachments(){let e=new Map;for(let t of this.getSubtree())(t instanceof d||t instanceof h)&&e.set(t.id,t);for(let t of e.values())if(t instanceof h){if(t.isAttached()&&!e.has(t.anchor.id))return!0}else if(t instanceof d)for(let i of t.children)if(!e.has(i.id))return!0;return!1}getIndexInParent(){var e,t;return null!==(t=null===(e=this.parent)||void 0===e?void 0:e.children.indexOf(this))&&void 0!==t?t:-1}getObjectAt(e,t){let i=void 0,r=void 0;for(let s=this.children.length-1;0<=s;s--){let n=this.children[s];if(!(n instanceof h&&n.isAttached())&&(r=n.getObjectAt(e,t),r&&(!i||r.hasHigherPriorityThan(i))&&(i=r,i.getPriority()===o["l"].High)))break}return i}moveTo(e,t,i=!0){this.moveBy(e-this.boundingBox.xMid,t-this.boundingBox.yMid,i)}moveBy(e,t,i=!0){this.boundingBox.xMin+=e,this.boundingBox.xMid+=e,this.boundingBox.xMax+=e,this.boundingBox.yMin+=t,this.boundingBox.yMid+=t,this.boundingBox.yMax+=t;let r=!0;for(let s of this.children)s instanceof h&&s.isAttached()||(r=!1,s.moveBy(e,t));r&&this.updateLayout(c.Movement,i)}recalculateLayout(){let e=!0;for(let t of this.children)e=!1,t.recalculateLayout();e&&this.updateLayout(c.Initialization)}updateLayout(e,t=!0){var i;let r=this.boundingBox;r.xMin=1/0,r.yMin=1/0,r.xMax=-1/0,r.yMax=-1/0;let s=o["a"].Free;for(let o of this.children)r.xMin=Math.min(r.xMin,o.boundingBox.xMin),r.yMin=Math.min(r.yMin,o.boundingBox.yMin),r.xMax=Math.max(r.xMax,o.boundingBox.xMax),r.yMax=Math.max(r.yMax,o.boundingBox.yMax),s=Math.max(s,o.getAlignment());r.xMid=Math.floor((r.xMin+r.xMax)/2),r.yMid=Math.floor((r.yMin+r.yMax)/2),this.isAlignmentInherited()&&this.setAlignment(s),t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}getAlignment(e=this.attrs){return e&o["b"]}getCursor(e=this.attrs){return e&o["e"]}isHovered(e=this.attrs){return(e&o["g"])!==o["f"].Off}isHoveredOrSelected(e=this.attrs){return 0<(e&(o["o"]|o["g"]))}isAlignmentInherited(e=this.attrs){return(e&o["i"])===o["h"].True}hasUserSetPosition(e=this.attrs){return(e&o["k"])===o["j"].True}getPositionSetByUser(e=this.attrs){return e&o["k"]}getPriority(e=this.attrs){return e&o["m"]}hasHigherPriorityThan(e){return this.getPriority()>e.getPriority()}isSelected(e=this.attrs){return(e&o["o"])===o["n"].True}getSemanticRole(e=this.attrs){return e&o["p"]}hasRole(e,t=this.attrs){return(t&o["p"])===e}setAlignment(e){this.attrs=this.attrs&~o["b"]|e}setCursor(e){this.attrs=this.attrs&~o["e"]|e}setHover(e){this.attrs=this.attrs&~o["g"]|e}setInheritAlignment(e){this.attrs=this.attrs&~o["i"]|e}setPositionSetByUser(e){this.attrs=this.attrs&~o["k"]|e}setPriority(e){this.attrs=this.attrs&~o["m"]|e}setSelect(e){this.attrs=this.attrs&~o["o"]|e}setSemanticRole(e){this.attrs=this.attrs&~o["p"]|e}toExport(){return{id:this.id,x:this.boundingBox.xMid,y:this.boundingBox.yMid,attrs:this.getPositionSetByUser(),template:this.template.id,children:this.children.map(e=>e.id),properties:this.props.toRawValue()}}}class a extends Error{constructor(e,t){super(e),this.subject=t}}class l{constructor(){this.xMin=0,this.yMin=0,this.xMid=0,this.yMid=0,this.xMax=0,this.yMax=0}}const c={Initialization:1,Movement:2,ChildAdded:4,ChildDeleted:8,PropUpdate:16};class d extends n{constructor(e,t,i){var r;super(e,t,i),this.radius=t.radius,this.template=t,this.lineTemplates=t.line_templates,this.angle=null!==(r=null===i||void 0===i?void 0:i.angle)&&void 0!==r?r:s["a"].DEG_0}addChild(e,t=this.children.length){if(e.isAttached())throw new a(`'${e.id}' is already anchored.`,e);e.anchor=this,this.children.splice(t,0,e)}removeChild(e){let t=this.children.indexOf(e);if(-1===t)throw new a(`'${e.id}' is not attached to the '${this.id}'.`,e);e.anchor=void 0,this.children.splice(t,1)}hasAttachments(){return 0<this.children.length}getObjectAt(e,t){let i=void 0,r=void 0;for(let l=this.children.length-1;0<=l;l--)if(r=this.children[l].getObjectAt(e,t),r&&(!i||r.hasHigherPriorityThan(i))&&(i=r,i.getPriority()===o["l"].High))break;let s=this.radius,n=e-this.boundingBox.xMid,a=t-this.boundingBox.yMid;return i&&i.getPriority()>o["l"].Normal?i:n*n+a*a<s*s?this:void 0}moveBy(e,t,i=!0){this.boundingBox.xMin+=e,this.boundingBox.xMid+=e,this.boundingBox.xMax+=e,this.boundingBox.yMin+=t,this.boundingBox.yMid+=t,this.boundingBox.yMax+=t;for(let r of this.children)r.isAttached(this)?r.moveTo(this.boundingBox.xMid,this.boundingBox.yMid):console.warn(`'${r.id}' incorrectly attached to anchor.`);this.updateLayout(c.Movement,i)}updateLayout(e,t=!0){var i;let r=this.boundingBox;r.xMin=r.xMid-this.radius,r.yMin=r.yMid-this.radius,r.xMax=r.xMid+this.radius,r.yMax=r.yMid+this.radius,t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}toExport(){return Object.assign(Object.assign({},super.toExport()),{angle:this.angle})}makeLine(){let e=this.lineTemplates[this.angle],t=this.factory.createObject(e);if(t instanceof g)return t;throw new a(`Template '${e}' is not a line.`,t)}}class h extends n{constructor(e,t,i){super(e,t,i),this.anchor=void 0}isAttached(e){return e?this.anchor===e:void 0!==this.anchor}getIndexInAnchor(){var e,t;return null!==(t=null===(e=this.anchor)||void 0===e?void 0:e.children.indexOf(this))&&void 0!==t?t:-1}}class u extends h{constructor(e,t,i){super(e,t,i)}moveBy(e,t,i=!0,r=!1){var s;r?super.moveBy(e,t,i):null===(s=this.parent)||void 0===s||s.moveChild(this.id,e,t,i)}}class p extends n{constructor(e,t,i){super(e,t,i)}moveBy(e,t,i=!0,r=!1){var s;r?super.moveBy(e,t,i):null===(s=this.parent)||void 0===s||s.moveChild(this.id,e,t,i)}}class g extends n{constructor(e,t,i){super(e,t,i),this.style=t.style,this.template=t,this.hitboxWidth=t.hitbox_width}get srcEnding(){return this.children.at(0)}get trgEnding(){return this.children.at(-1)}addChild(e,t=this.children.length,i=!0){if(!(e instanceof u||e instanceof p)){let t=u.name,i=p.name;throw new a(`Child must be of type '${t}' or '${i}.'`,e)}super.addChild(e,t,i)}reorderChild(e,t,i=!0){throw new a("Line objects cannot be reordered.",this)}isAnchored(){for(let e of this.children)if(e instanceof u&&e.isAttached())return!0;return!1}setSelect(e){super.setSelect(e);let t=this.isSelected()?o["l"].High:o["l"].Normal;for(let i of this.children)i.setPriority(t)}}class y extends n{constructor(e,t,i){super(e,t,i),this.anchorCache=[],this._objectCache=new Map([[this.id,this]])}lookup(e){return this._objectCache.get(e)}updateLayout(e){let{ChildAdded:t,ChildDeleted:i,Initialization:r}=c;if(super.updateLayout(e),e&(r|t|i)){this._objectCache.clear(),this.anchorCache.splice(0,this.anchorCache.length);for(let e of this.getSubtree())e instanceof d&&this.anchorCache.push(e),this._objectCache.set(e.id,e)}}}var f=i("a80d");class b extends u{constructor(e,t,i){super(e,t,i),this.setCursor(o["c"].Pointer),this.setSemanticRole(t.role),this.template=t,this.style=t.style,this.updateLayout(c.Initialization)}getObjectAt(e,t){let i=e-this.boundingBox.xMid,r=t-this.boundingBox.yMid,s=this.style.radius;return i*i+r*r<s*s?this:void 0}updateLayout(e,t=!0){var i;let r=this.boundingBox;r.xMin=r.xMid-this.style.radius,r.yMin=r.yMid-this.style.radius,r.xMax=r.xMid+this.style.radius,r.yMax=r.yMid+this.style.radius,t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}createView(e){return new f["j"](this,e)}}class _ extends p{constructor(e,t,i){super(e,t,i),this.setCursor(o["c"].Move),this.setSemanticRole(t.role),this.template=t,this.style=t.style,this.updateLayout(c.Initialization)}getObjectAt(e,t){let i=e-this.boundingBox.xMid,r=t-this.boundingBox.yMid,s=this.style.radius;return i*i+r*r<s*s?this:void 0}updateLayout(e,t=!0){var i;let r=this.boundingBox;r.xMin=r.xMid-this.style.radius,r.yMin=r.yMid-this.style.radius,r.xMax=r.xMid+this.style.radius,r.yMax=r.yMid+this.style.radius,t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}createView(e){return new f["k"](this,e)}}var m=i("13c3");class v extends g{constructor(e,t,i){if(super(e,t,i),this.hitboxes=[[],[],[]],this.setCursor(o["c"].Move),this.setSemanticRole(t.role),this.template=t,!this.children.length){let i=this.boundingBox.xMid,r=this.boundingBox.yMid,s=t.line_ending_template.source,o=t.line_handle_template,n=t.line_ending_template.target;this.addChild(e.createObject(s),0,!1),this.addChild(e.createObject(o),1,!1),this.addChild(e.createObject(n),2,!1);for(let e of this.children)e.moveTo(i,r);this.children[0].moveBy(-100,50),this.children[2].moveBy(100,-50)}this.updateLayout(c.Initialization)}getObjectAt(e,t){if(this.isAnchored()){let i=super.getObjectAt(e,t);if(i)return i;for(let r=0;r<this.hitboxes.length;r++)if(Object(m["l"])(e,t,this.hitboxes[r]))return 1===r?this.children[r]:this}else{if(this.isSelected()){let i=super.getObjectAt(e,t);if(i)return i}for(let i of this.hitboxes)if(Object(m["l"])(e,t,i))return this}}moveChild(e,t,i,r=!0){let s=this.children.find(t=>t.id===e);if(!s)return;s instanceof b&&s.moveBy(t,i,r,!0);let[o,n,a]=this.children,l=o.boundingBox.xMid,c=o.boundingBox.yMid,d=a.boundingBox.xMid,h=a.boundingBox.yMid,u=n.boundingBox.xMid,p=n.boundingBox.yMid,g=(l+d)/2-u,y=(c+h)/2-p;n.hasUserSetPosition()?s===n&&n.moveBy(t,0,r,!0):n.moveBy(g,0,r,!0),n.moveBy(0,y,r,!0)}updateLayout(e,t=!0){let[i,r,s]=this.children.map(e=>e.boundingBox),n=this.hitboxWidth;this.hitboxes[0]=Object(m["k"])(i.xMid,i.yMid,r.xMid,i.yMid,n),this.hitboxes[1]=Object(m["k"])(r.xMid,i.yMid,r.xMid,s.yMid,n),this.hitboxes[2]=Object(m["k"])(r.xMid,s.yMid,s.xMid,s.yMid,n),this.children[1].setCursor(o["c"].Col_Resize),super.updateLayout(e,t)}createView(e){return new f["l"](this,e)}}class x extends g{constructor(e,t,i){if(super(e,t,i),this.hitboxes=[[],[],[]],this.setCursor(o["c"].Move),this.setSemanticRole(t.role),this.template=t,!this.children.length){let i=this.boundingBox.xMid,r=this.boundingBox.yMid,s=t.line_ending_template.source,o=t.line_handle_template,n=t.line_ending_template.target;this.addChild(e.createObject(s),0,!1),this.addChild(e.createObject(o),1,!1),this.addChild(e.createObject(n),2,!1);for(let e of this.children)e.moveTo(i,r);this.children[0].moveBy(-50,100),this.children[2].moveBy(50,-100)}this.updateLayout(c.Initialization)}getObjectAt(e,t){if(this.isAnchored()){let i=super.getObjectAt(e,t);if(i)return i;for(let r=0;r<this.hitboxes.length;r++)if(Object(m["l"])(e,t,this.hitboxes[r]))return 1===r?this.children[r]:this}else{if(this.isSelected()){let i=super.getObjectAt(e,t);if(i)return i}for(let i of this.hitboxes)if(Object(m["l"])(e,t,i))return this}}moveChild(e,t,i,r=!0){let s=this.children.find(t=>t.id===e);if(!s)return;s instanceof b&&s.moveBy(t,i,r,!0);let[o,n,a]=this.children,l=o.boundingBox.xMid,c=o.boundingBox.yMid,d=a.boundingBox.xMid,h=a.boundingBox.yMid,u=n.boundingBox.xMid,p=n.boundingBox.yMid,g=(l+d)/2-u,y=(c+h)/2-p;n.hasUserSetPosition()?s===n&&n.moveBy(0,i,r,!0):n.moveBy(0,y,r,!0),n.moveBy(g,0,r,!0)}updateLayout(e,t=!0){let[i,r,s]=this.children.map(e=>e.boundingBox),n=this.hitboxWidth;this.hitboxes[0]=Object(m["k"])(i.xMid,i.yMid,i.xMid,r.yMid,n),this.hitboxes[1]=Object(m["k"])(i.xMid,r.yMid,s.xMid,r.yMid,n),this.hitboxes[2]=Object(m["k"])(s.xMid,r.yMid,s.xMid,s.yMid,n),this.children[1].setCursor(o["c"].Row_Resize),super.updateLayout(e,t)}createView(e){return new f["m"](this,e)}}class w extends d{constructor(e,t,i){super(e,t,i),this.setSemanticRole(t.role),this.template=t,this.style=t.style,this.updateLayout(c.Initialization)}updateLayout(e,t=!0){var i;let r=this.boundingBox;r.xMin=r.xMid-this.radius,r.yMin=r.yMid-this.radius,r.xMax=r.xMid+this.radius,r.yMax=r.yMid+this.radius,t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}createView(e){return new f["a"](this,e)}}class j extends n{constructor(e,t,i){if(super(e,t,i),this.setInheritAlignment(o["h"].False),this.setAlignment(o["a"].Grid),this.setCursor(o["c"].Move),this.layout={},this.setSemanticRole(t.role),this.template=t,this.style=t.style,!this.children.length){let i=t.anchor_template,r=[s["a"].DEG_90,s["a"].DEG_0];for(let t,s=0;s<12;s++)t=e.createObject(i),t.angle=r[Math.floor(s/3)%2],this.addChild(t,s,!1)}this.props.onUpdate(()=>{this.updateLayout(c.PropUpdate)}),this.updateLayout(c.Initialization)}getObjectAt(e,t){let i=super.getObjectAt(e,t);if(i)return i;let r=this.boundingBox;return r.xMin<=e&&e<=r.xMax&&r.yMin<=t&&t<=r.yMax?this:void 0}updateLayout(e,t=!0){var i,r,s;let o=this.props.toHashValue(),n=this.layout.contentHash!==o,a=e&c.Initialization;if(a||n){let{max_width:t,head:s,body:n,horizontal_padding:a}=this.style,l=n.field_name,c=n.field_value,d=[],h=1,u=Object(m["n"])(this.template.id).toLocaleUpperCase(),p=this.props.isDefined()?this.props.toString():"",g=""!==p,y=this.hasFields(),f=(g?s.two_title:s.one_title).title,b=t;b=Math.max(b,f.font.measureWidth(u));for(let e of this.props.value.keys())b=Math.max(b,n.field_name.font.measureWidth(e));let _,v=null,x=0,w=h+a,j=h+s.vertical_padding,O={font:f.font,color:f.color,text:[]};if(d.push(O),v=f.font.measure(u),x=Math.max(x,v.width),j+=v.ascent,O.text.push({x:w,y:j,t:u}),j+=v.descent+(null!==(i=f.padding)&&void 0!==i?i:0),g){let e=s.two_title.subtitle,t={font:e.font,color:e.color,text:[]};d.push(t);let i=e.font.wordWrap(p,b);v=e.font.measure(i[0]),x=Math.max(x,v.width),j+=v.ascent,t.text.push({x:w,y:j,t:i[0]});for(let r=1;r<i.length;r++)v=e.font.measure(i[r]),x=Math.max(x,v.width),j+=e.line_height,t.text.push({x:w,y:j,t:i[r]})}if(j+=s.vertical_padding,y){let e={font:l.font,color:l.color,text:[]},t={font:c.font,color:c.color,text:[]};d.push(e),d.push(t),j+=h,_=Math.round(j),j+=n.vertical_padding;for(let[i,s]of this.props.value){if(!s.isDefined())continue;if(null!==(r=s.descriptor.is_visible)&&void 0!==r&&!r)continue;if(i===this.props.primaryKey)continue;i=i.toLocaleUpperCase(),v=l.font.measure(i),x=Math.max(x,v.width),j+=v.ascent,e.text.push({x:w,y:j,t:i}),j+=v.descent+n.field_name.padding;let o=c.font.wordWrap(s.toString(),b);v=c.font.measure(o[0]),x=Math.max(x,v.width),j+=v.ascent,t.text.push({x:w,y:j,t:o[0]});for(let e=1;e<o.length;e++)v=c.font.measure(o[e]),x=Math.max(x,v.width),j+=c.line_height,t.text.push({x:w,y:j,t:o[e]});j+=n.field_value.padding}j-=n.field_value.padding,j+=n.vertical_padding}else _=Math.round(j+h);let S=Math.round(x+2*(a+h)),k=Math.round(j+h),M=this.boundingBox,B=Math.round(M.xMid-S/2),D=Math.round(M.yMid-k/2),T=Math.round(M.xMid+S/2),C=Math.round(M.yMid+k/2),P=(M.xMid-B)/2,E=(M.yMid-D)/2,A=[M.xMid-P,D,M.xMid,D,M.xMid+P,D,T,M.yMid-E,T,M.yMid,T,M.yMid+E,M.xMid+P,C,M.xMid,C,M.xMid-P,C,B,M.yMid+E,B,M.yMid,B,M.yMid-E];for(let e=0;e<A.length;e+=2)this.children[e/2].moveTo(A[e],A[e+1],!1);super.updateLayout(e,!1),this.layout={contentHash:o,dx:B-M.xMin,dy:D-M.yMin,width:S,height:k,headerHeight:_,text:d}}t&&(null===(s=this.parent)||void 0===s||s.updateLayout(e))}hasFields(){var e;for(let[t,i]of this.props.value)if(t!==this.props.primaryKey&&(null===(e=i.descriptor.is_visible)||void 0===e||e)&&i.isDefined())return!0;return!1}createView(e){return new f["i"](this,e)}}class O extends n{constructor(e,t,i){if(super(e,t,i),this.setInheritAlignment(o["h"].False),this.setAlignment(o["a"].Grid),this.setCursor(o["c"].Move),this.layout={},this.setSemanticRole(t.role),this.template=t,this.style=t.style,!this.children.length){let i,r=t.anchor_template,o=[s["a"].DEG_90,s["a"].DEG_0];for(let t=0;t<9;t++)i=e.createObject(r),i.angle=o[Math.floor(t/3)%2],this.addChild(i,t,!1);for(let t of this.template.branches)i=e.createObject(t.anchor_template),i.angle=s["a"].DEG_90,this.addChild(i,this.children.length,!1)}this.props.onUpdate(()=>{this.updateLayout(c.PropUpdate)}),this.updateLayout(c.Initialization)}getObjectAt(e,t){let i=super.getObjectAt(e,t);if(i)return i;let r=this.boundingBox;return r.xMin<=e&&e<=r.xMax&&r.yMin<=t&&t<=r.yMax?this:void 0}updateLayout(e,t=!0){var i,r;let s=this.props.toHashValue(),o=this.layout.contentHash!==s,n=e&c.Initialization;if(n||o){let{max_width:t,head:r,body:o,branch:n,horizontal_padding:a}=this.style,l=o.field_name,c=o.field_value,d=[],h=[],u=1,p=Object(m["n"])(this.template.id).toLocaleUpperCase(),g=this.props.isDefined()?this.props.toString():"",y=""!==g,f=this.hasFields(),b=(y?r.two_title:r.one_title).title,_=0;for(let e of this.template.branches)_+=n.horizontal_padding,_+=n.font.measureWidth(e.text),_+=n.horizontal_padding+u;_-=u;let v=t;v=Math.max(v,b.font.measureWidth(p));for(let e of this.props.value.keys())v=Math.max(v,o.field_name.font.measureWidth(e));v=Math.max(v,_);let x,w=null,j=0,O=u+a,S=u+r.vertical_padding,k={font:b.font,color:b.color,text:[]};if(d.push(k),w=b.font.measure(p),j=Math.max(j,w.width),S+=w.ascent,k.text.push({x:O,y:S,t:p}),S+=w.descent+(null!==(i=b.padding)&&void 0!==i?i:0),y){let e=r.two_title.subtitle,t={font:e.font,color:e.color,text:[]};d.push(t);let i=e.font.wordWrap(g,v);w=e.font.measure(i[0]),j=Math.max(j,w.width),S+=w.ascent,t.text.push({x:O,y:S,t:i[0]});for(let r=1;r<i.length;r++)w=e.font.measure(i[r]),j=Math.max(j,w.width),S+=e.line_height,t.text.push({x:O,y:S,t:i[r]})}if(S+=r.vertical_padding,f){let e={font:l.font,color:l.color,text:[]},t={font:c.font,color:c.color,text:[]};d.push(e),d.push(t),S+=u,x=Math.round(S),S+=o.vertical_padding;for(let[i,r]of this.props.value){if(!r.isDefined())continue;if(i===this.props.primaryKey)continue;i=i.toLocaleUpperCase(),w=l.font.measure(i),j=Math.max(j,w.width),S+=w.ascent,e.text.push({x:O,y:S,t:i}),S+=w.descent+o.field_name.padding;let s=c.font.wordWrap(r.toString(),v);w=c.font.measure(s[0]),j=Math.max(j,w.width),S+=w.ascent,t.text.push({x:O,y:S,t:s[0]});for(let e=1;e<s.length;e++)w=c.font.measure(s[e]),j=Math.max(j,w.width),S+=c.line_height,t.text.push({x:O,y:S,t:s[e]});S+=o.field_value.padding}S-=o.field_value.padding,S+=o.vertical_padding}else x=Math.round(S+u);let M={font:n.font,color:n.color,text:[]};d.push(M),S+=u,j=Math.max(j+2*a,_);let B=0,D=0,T=0,C=u;this.template.branches.length;for(let e of this.template.branches)w=n.font.measure(e.text),T=n.vertical_padding+w.ascent,C+=n.horizontal_padding,M.text.push({x:C,y:S+T,t:e.text}),T+=w.descent+n.vertical_padding,C+=w.width,C+=n.horizontal_padding,B=Math.round(C)+.5,D=Math.max(D,T),h.push({x0:B,y0:0,x1:B,y1:1e5}),C+=u;h.pop();for(let e of h)e.y0=S,e.y1=S+D;S+=D;let P=Math.round(j+2*u),E=Math.round(S+u),A=this.boundingBox,L=Math.round(A.xMid-P/2),H=Math.round(A.yMid-E/2),I=Math.round(A.xMid+P/2),F=Math.round(A.yMid+E/2),z=(A.xMid-L)/2,V=(A.yMid-H)/2,R=[A.xMid-z,H,A.xMid,H,A.xMid+z,H,I,A.yMid-V,I,A.yMid,I,A.yMid+V,L,A.yMid+V,L,A.yMid,L,A.yMid-V,A.xMid-z,F,A.xMid+z,F];for(let e=0;e<R.length;e+=2)this.children[e/2].moveTo(R[e],R[e+1],!1);super.updateLayout(e,!1),this.layout={contentHash:s,dx:L-A.xMin,dy:H-A.yMin,width:P,height:E,headerHeight:x,text:d,lines:h}}t&&(null===(r=this.parent)||void 0===r||r.updateLayout(e))}hasFields(){for(let[e,t]of this.props.value)if(e!==this.props.primaryKey&&t.isDefined())return!0;return!1}createView(e){return new f["b"](this,e)}}class S extends n{constructor(e,t,i){if(super(e,t,i),this.setInheritAlignment(o["h"].False),this.setAlignment(o["a"].Grid),this.setCursor(o["c"].Move),this.layout={},this.setSemanticRole(t.role),this.template=t,this.style=t.style,!this.children.length){let i=t.anchor_template,r=[s["a"].DEG_90,s["a"].DEG_0];for(let t,s=0;s<12;s++)t=e.createObject(i),t.angle=r[Math.floor(s/3)%2],this.addChild(t,s,!1)}this.props.onUpdate(()=>{this.updateLayout(c.PropUpdate)}),this.updateLayout(c.Initialization)}getObjectAt(e,t){let i=super.getObjectAt(e,t);if(i)return i;let r=this.boundingBox;return r.xMin<=e&&e<=r.xMax&&r.yMin<=t&&t<=r.yMax?this:void 0}updateLayout(e,t=!0){var i;let r=Object(m["g"])(this.props.toString()),s=this.layout.contentHash!==r,o=e&c.Initialization;if(o||s){let{max_width:t,text:i,vertical_padding:s,horizontal_padding:o}=this.style,n=1,a=[],l=i.font.wordWrap(this.props.toString(),t),c=i.font.measure(l[0]),d=c.width,h=n+o,u=n+s+c.ascent;a.push({x:h,y:u,t:l[0]});for(let e=1;e<l.length;e++)c=i.font.measure(l[e]),d=Math.max(d,c.width),u+=i.line_height,a.push({x:h,y:u,t:l[e]});u+=s+n,h+=d+h;let p=Math.round(h),g=Math.round(u),y=this.boundingBox,f=Math.round(y.xMid-p/2),b=Math.round(y.yMid-g/2),_=Math.round(y.xMid+p/2),m=Math.round(y.yMid+g/2),v=(y.xMid-f)/2,x=(y.yMid-b)/2,w=[y.xMid-v,b,y.xMid,b,y.xMid+v,b,_,y.yMid-x,_,y.yMid,_,y.yMid+x,y.xMid+v,m,y.xMid,m,y.xMid-v,m,f,y.yMid+x,f,y.yMid,f,y.yMid-x];for(let e=0;e<w.length;e+=2)this.children[e/2].moveTo(w[e],w[e+1],!1);super.updateLayout(e,!1),this.layout={contentHash:r,dx:f-y.xMin,dy:b-y.yMin,width:p,height:g,text:a}}t&&(null===(i=this.parent)||void 0===i||i.updateLayout(e))}createView(e){return new f["o"](this,e)}}class k extends y{constructor(e,t,i){super(e,t,i),this.setSemanticRole(t.role),this.template=t,this.grid=t.grid,this.style=t.style,this.updateLayout(c.Initialization)}static createDummy(){return new this(s["d"].createDummy(),{id:"",name:"",type:s["g"].Page,role:s["f"].None,grid:[10,10],style:{grid_color:"#1d1d1d",background_color:"#141414",drop_shadow:{color:"rgba(0,0,0,.4)",offset:[3,3]}}})}createView(e){return new f["n"](this,e)}}},cd49:function(e,t,i){"use strict";i.r(t);var r=i("7a23");const s={class:"frame center"},o={class:"frame right"},n={class:"frame bottom"};function a(e,t,i,a,l,c){const d=Object(r["y"])("AppTitleBar"),h=Object(r["y"])("BlockDiagram"),u=Object(r["y"])("EditorSidebar"),p=Object(r["y"])("AppFooterBar"),g=Object(r["y"])("AppHotkeyBox");return Object(r["r"])(),Object(r["d"])(g,{id:"main"},{default:Object(r["E"])(()=>[Object(r["i"])(d,{id:"app-title-bar"}),Object(r["g"])("div",{id:"app-body",ref:"body",style:Object(r["q"])(e.gridLayout)},[Object(r["g"])("div",s,[Object(r["i"])(h,{id:"block-diagram"})]),Object(r["g"])("div",o,[Object(r["g"])("div",{class:"resize-handle",onPointerdown:t[0]||(t[0]=t=>e.startResize(t,e.Handle.Right))},null,32),Object(r["i"])(u,{id:"app-sidebar"})]),Object(r["g"])("div",n,[Object(r["i"])(p,{id:"app-footer-bar"})])],4)]),_:1})}var l=i("9ab4");class c{constructor(){this._errors=[],this._warnings=[]}run(e){this.reset(),this.validate(e)}validate(e){}getWarnings(){return this._warnings}getErrors(){return this._errors}addWarning(e,t){this._warnings.push({object:e.id,reason:t})}addError(e,t){this._errors.push({object:e.id,reason:t})}inValidState(){return 0===this._errors.length}reset(){this._errors=[],this._warnings=[]}}var d=i("24a6");class h extends c{validate(e){let t=d["w"].toGraph(e),i=new Map;for(let r of t.nodes)this.checkNode(r),i.set(r.id,r);for(let r of t.edges)this.checkEdge(r)}checkEdge(e){0!==e.prev.length&&0!==e.next.length||this.addWarning(e,"Edges should be connected on both ends.")}checkNode(e){for(const[t,i]of e.data.value)e.template.properties&&this.checkProperty(e,t,i)}checkProperty(e,t,i){switch(i.type){case d["u"].Int:case d["u"].Float:case d["u"].String:case d["u"].Date:case d["u"].Enum:i.descriptor.is_required&&!i.isDefined()&&this.addError(e,"Missing required field: "+t);break;case d["u"].Dictionary:if(i instanceof d["k"])for(let[t,r]of i.value)this.checkProperty(e,t,r);break;case d["u"].List:if(i instanceof d["o"])for(let[r,s]of i.value)s.descriptor.is_required&&!s.isDefined()&&this.addError(e,`Empty item in list: ${t}.`);break}}}var u=h;class p{publish(e){return""}}const g="fb9c968a-745b-4ade-9b25-c324172197f4",y="https://center-for-threat-informed-defense.github.io/attack-flow/stix/attack-flow-schema-2.0.0.json",f="2.0.0",b="2022-08-02T19:34:35.143Z",_=b,m={source_name:"Documentation",description:"Documentation for Attack Flow",url:"https://center-for-threat-informed-defense.github.io/attack-flow"},v={source_name:"GitHub",description:"Source code repository for Attack Flow",url:"https://github.com/center-for-threat-informed-defense/attack-flow"},x="MITRE Engenuity Center for Threat-Informed Defense",w=new Set(["attack-flow","attack-action","attack-asset","attack-condition","attack-operator"]),j=new Map([["action","attack-action"],["asset","attack-asset"],["condition","attack-condition"],["or","attack-operator"],["and","attack-operator"]]);class O extends p{publish(e){var t;const i=d["w"].toGraph(e),r=this.createStixBundle(),s=new Map,o=new Map,n=new Map;for(const c of i.nodes){const e=this.exportNodeObject(c);r.objects.push(e),s.set(e.id,e),o.set(e.id,new Array),n.set(c.id,e.id)}for(const c of i.edges){const e=n.get(c.prev[0]),i=n.get(c.next[0]);if(!e||!i)throw new Error("The endpoints for this edge do not exist: "+c);null===(t=o.get(e))||void 0===t||t.push(i)}for(const c of s.values()){const e=new Array,t=o.get(c.id);if(!t)throw new Error("Cannot look up children of STIX node: id="+c.id);for(const r of t)e.push(s.get(r));const i=this.handleChildren(c,e);r.objects.push(...i)}const a=this.createStixObj("identity");a.name="John Doe",a.identity_class="individual",a.contact_information="johndoe@mitre.org",r.objects.splice(2,0,a);const l=this.createStixObj("attack-flow");return l.name="Placeholder name",l.scope="other",l.description="Placeholder description.",l.created_by_ref=a.id,l.start_refs=this.findFlowRoots(s,o),r.objects.splice(2,0,l),JSON.stringify(r,null,2)}exportNodeObject(e){const t=e.template.id,i=this.createStixObj(t,e.id);return"or"===e.template.id?i.operator="OR":"and"===e.template.id&&(i.operator="AND"),this.mergeDictionaryProperty(i,e.data),i}mergeDictionaryProperty(e,t){for(let[i,r]of t.value)switch(r.type){case d["u"].Dictionary:r instanceof d["k"]&&(e[i]={},this.mergeDictionaryProperty(e[i],r));break;case d["u"].List:r instanceof d["o"]&&r.isDefined()&&(e[i]=[],this.mergeListProperty(e[i],r));break;default:r.isDefined()&&(e[i]=r.toRawValue());break}}mergeListProperty(e,t){for(let i of t.value.values())switch(i.type){case d["u"].Dictionary:i instanceof d["k"]&&(e.push({}),this.mergeDictionaryProperty(e.at(-1),i));break;case d["u"].List:i instanceof d["o"]&&i.isDefined()&&(e.push([]),this.mergeListProperty(e.at(-1),i));break;default:i.isDefined()&&e.push(i.toRawValue())}}handleChildren(e,t){const i=[];for(const r of t){let t=null;switch(e.type){case"attack-action":t=this.handleActionChild(e,r);break;case"attack-asset":t=this.handleAssetChild(e,r);break;case"attack-condition":t=this.handleConditionChild(e,r);break;case"attack-operator":t=this.handleOperatorChild(e,r);break;default:t=this.handleDefaultChild(e,r)}t&&i.push(t)}return i}handleActionChild(e,t){let i=null;switch(t.type){case"process":e.command_ref?i=this.createSro(e,t):e.command_ref=t.id;break;case"attack-asset":e.asset_refs||(e.asset_refs=[]),e.asset_refs.push(t.id);break;case"attack-action":case"attack-operator":case"attack-condition":e.effect_refs||(e.effect_refs=[]),e.effect_refs.push(t.id);break;default:i=this.createSro(e,t)}return i}handleAssetChild(e,t){let i=null;return e.object_ref?i=this.createSro(e,t):e.object_ref=t.id,i}handleConditionChild(e,t){let i=null;switch(t.type){case"attack-action":case"attack-operator":case"attack-condition":e.on_true_refs||(e.on_true_refs=[]),e.on_true_refs.push(t.id);break;default:i=this.createSro(e,t)}return i}handleOperatorChild(e,t){let i=null;switch(t.type){case"attack-action":case"attack-operator":case"attack-condition":e.effect_refs||(e.effect_refs=[]),e.effect_refs.push(t.id);break;default:i=this.createSro(e,t)}return i}handleDefaultChild(e,t){let i=this.createSro(e,t);return i}createStixBundle(){const e=this.createStixObj("bundle"),t=this.createExtensionAuthorSdo(),i=this.createExtensionSdo(t.id);return e.objects=[i,t],e}createExtensionSdo(e){const t=this.createStixObj("extension-definition",g);return t.name="Attack Flow",t.description="Extends STIX 2.1 with features to create Attack Flows.",t.created=b,t.modified=_,t.created_by_ref=e,t.schema=y,t.version=f,t.extension_types=["new-sdo"],t.external_references=[m,v],t}createExtensionAuthorSdo(){const e=this.createStixObj("identity",g);return e.create_by_ref=e.id,e.name=x,e.identity_class="organization",e.created=b,e.modified=_,e}createStixObj(e,t=null){var i;let r=null!==(i=j.get(e))&&void 0!==i?i:e,s=null!==t&&void 0!==t?t:crypto.randomUUID(),o=(new Date).toISOString(),n={type:r,id:`${r}--${s}`,spec_version:"2.1",created:o,modified:o};if(w.has(r)){let e={};e["extension-definition--"+g]={extension_type:"new-sdo"},n.extensions=e}return n}createSro(e,t,i="related-to"){const r=crypto.randomUUID(),s=(new Date).toISOString();return{type:"relationship",id:"relationship--"+r,spec_version:"2.1",created:s,modified:s,relationship_type:i,source_ref:e.id,target_ref:t.id}}findFlowRoots(e,t){const i=new Set;for(const r of e.values())"attack-action"!=r.type&&"attack-condition"!=r.type||i.add(r.id);for(const r of t.values())for(const e of r)i.delete(e);return new Array(...i)}}var S=O,k=i("c40c");const M={file_type_name:"Attack Flow",file_type_extension:"afb",is_web_hosted:!1,schema:{page_template:"attack_flow_page",templates:[{id:"attack_flow_page",name:"Attack Flow",type:d["z"].Page,role:d["x"].None,grid:[10,10],properties:{name:{type:d["u"].String,value:"Untitled Document",is_primary:!0},description:{type:d["u"].String},scope:{type:d["u"].Enum,options:{type:d["u"].List,form:{type:d["u"].String},value:[["incident","Incident"],["campaign","Campaign"],["threat-actor","Threat Actor"],["malware","Malware"],["other","Other"]]},value:"incident"},author:{type:d["u"].Dictionary,form:{name:{type:d["u"].String,is_primary:!0},identity_class:{type:d["u"].Enum,options:{type:d["u"].List,form:{type:d["u"].String},value:[["individual","Individual"],["group","Group"],["system","System"],["organization","Organization"],["class","Class"],["unknown","Unknown"]]}},contact_information:{type:d["u"].String}}}},style:k["b"].Page()},{id:"true_anchor",name:"True Anchor",type:d["z"].AnchorPoint,role:d["x"].None,radius:10,line_templates:{[d["b"].DEG_0]:"@__builtin__line_horizontal_elbow",[d["b"].DEG_90]:"@__builtin__line_vertical_elbow"},style:k["b"].AnchorPoint()},{id:"false_anchor",name:"False Anchor",type:d["z"].AnchorPoint,role:d["x"].None,radius:10,line_templates:{[d["b"].DEG_0]:"@__builtin__line_horizontal_elbow",[d["b"].DEG_90]:"@__builtin__line_vertical_elbow"},style:k["b"].AnchorPoint()},{id:"action",name:"Action",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},tactic_id:{type:d["u"].String},tactic_ref:{type:d["u"].String},technique_id:{type:d["u"].String},technique_ref:{type:d["u"].String},execution_start:{type:d["u"].Date},execution_end:{type:d["u"].Date},description:{type:d["u"].String},confidence:{type:d["u"].Enum,options:{type:d["u"].List,form:{type:d["u"].Dictionary,form:{text:{type:d["u"].String,is_primary:!0},value:{type:d["u"].Int}}},value:[["speculative",{text:"Speculative",value:0}],["very-doubtful",{text:"Very Doubtful",value:10}],["doubtful",{text:"Doubtful",value:30}],["even-odds",{text:"Even Odds",value:50}],["probable",{text:"Probable",value:70}],["very-probable",{text:"Very Probable",value:90}],["certain",{text:"Certain",value:100}]]},value:"probable"}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Blue)})},{id:"asset",name:"Asset",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Orange)})},{id:"condition",name:"Condition",type:d["z"].BranchBlock,role:d["x"].Node,properties:{description:{type:d["u"].String,is_primary:!0,is_required:!0},pattern:{type:d["u"].String},pattern_type:{type:d["u"].String},pattern_version:{type:d["u"].String}},branches:[{text:"True",anchor_template:"true_anchor"},{text:"False",anchor_template:"false_anchor"}],anchor_template:"@__builtin__anchor",style:k["b"].BranchBlock({head:Object.assign({},k["a"].Green)})},{id:"or",name:"Operator: OR",type:d["z"].TextBlock,role:d["x"].Node,properties:{text:{type:d["u"].String,value:"AND",is_primary:!0,is_visible:!1,is_editable:!1}},anchor_template:"@__builtin__anchor",style:k["b"].TextBlock(Object.assign(Object.assign({},k["a"].Red),{horizontal_padding:35}))},{id:"and",name:"Operator: AND",type:d["z"].TextBlock,role:d["x"].Node,properties:{text:{type:d["u"].String,value:"AND",is_primary:!0,is_visible:!1,is_editable:!1}},anchor_template:"@__builtin__anchor",style:k["b"].TextBlock(Object.assign(Object.assign({},k["a"].Red),{horizontal_padding:35}))},{id:"attack_pattern",name:"Attack Pattern",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},aliases:{type:d["u"].List,form:{type:d["u"].String}},kill_chain_phases:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"campaign",name:"Campaign",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},aliases:{type:d["u"].List,form:{type:d["u"].String}},first_seen:{type:d["u"].Date},last_seen:{type:d["u"].Date},objective:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"course_of_action",name:"Course of Action",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},action_type:{type:d["u"].String},os_execution_envs:{type:d["u"].List,form:{type:d["u"].String}},action_bin:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"grouping",name:"Grouping",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0},description:{type:d["u"].String},context:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"identity",name:"Identity",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_required:!0,is_primary:!0},description:{type:d["u"].String},roles:{type:d["u"].List,form:{type:d["u"].String}},identity_class:{type:d["u"].String,is_required:!0},sectors:{type:d["u"].List,form:{type:d["u"].String}},contact_information:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"indicator",name:"Indicator",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0},description:{type:d["u"].String},indicator_types:{type:d["u"].List,form:{type:d["u"].String,is_required:!0}},pattern:{type:d["u"].String,is_required:!0},pattern_type:{type:d["u"].String,is_required:!0},patter_version:{type:d["u"].String},valid_from:{type:d["u"].Date,is_required:!0},valid_until:{type:d["u"].Date},kill_chain_phases:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"infrastructure",name:"Infrastructure",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},infrastructure_types:{type:d["u"].List,form:{type:d["u"].String,is_required:!0}},aliases:{type:d["u"].List,form:{type:d["u"].String}},kill_chain_phases:{type:d["u"].List,form:{type:d["u"].String}},first_seen:{type:d["u"].Date},last_seen:{type:d["u"].Date}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"intrusion_set",name:"Intrusion Set",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},aliases:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},first_seen:{type:d["u"].Date},last_seen:{type:d["u"].Date},goals:{type:d["u"].List,form:{type:d["u"].String}},resource_level:{type:d["u"].String},primary_motivation:{type:d["u"].String},secondary_motivations:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"location",name:"Location",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0},description:{type:d["u"].String},latitude:{type:d["u"].Float,min:-90,max:90},longitude:{type:d["u"].Float,min:-180,max:180},precision:{type:d["u"].Float},region:{type:d["u"].String},country:{type:d["u"].String},administrative_area:{type:d["u"].String},city:{type:d["u"].String},street_address:{type:d["u"].String},postal_code:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"malware",name:"Malware",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0},description:{type:d["u"].String},malware_types:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},is_family:{type:d["u"].String,is_required:!0},aliases:{type:d["u"].List,form:{type:d["u"].String}},kill_chain_phases:{type:d["u"].List,form:{type:d["u"].String}},first_seen:{type:d["u"].Date},last_seen:{type:d["u"].Date},os_execution_envs:{type:d["u"].List,form:{type:d["u"].String}},architecture_execution_envs:{type:d["u"].List,form:{type:d["u"].String}},implementation_languages:{type:d["u"].List,form:{type:d["u"].String}},capabilities:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"malware_analysis",name:"Malware",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{product:{type:d["u"].String,is_primary:!0,is_required:!0},version:{type:d["u"].String},configuration_version:{type:d["u"].String},modules:{type:d["u"].List,form:{type:d["u"].String}},analysis_engine_version:{type:d["u"].String},analysis_definition_version:{type:d["u"].String},submitted:{type:d["u"].Date},analysis_started:{type:d["u"].Date},analysis_ended:{type:d["u"].Date},av_result:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"note",name:"Note",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{abstract:{type:d["u"].String,is_primary:!0},content:{type:d["u"].String,is_required:!0},authors:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"observed_data",name:"Observed Data",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{first_observed:{type:d["u"].Date,is_required:!0},last_observed:{type:d["u"].Date,is_required:!0},number_observed:{type:d["u"].Int,min:0,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"opinion",name:"Opinion",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{explanation:{type:d["u"].String,is_primary:!0},authors:{type:d["u"].List,form:{type:d["u"].String}},opinion:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"report",name:"Report",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},report_types:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},published:{type:d["u"].Date,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"threat-actor",name:"Threat Actor",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},threat_actor_types:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},aliases:{type:d["u"].List,form:{type:d["u"].String}},first_seen:{type:d["u"].Date},last_seen:{type:d["u"].Date},roles:{type:d["u"].List,form:{type:d["u"].String}},goals:{type:d["u"].List,form:{type:d["u"].String}},sophistication:{type:d["u"].String},resource_level:{type:d["u"].String},primary_motivation:{type:d["u"].String},secondary_motivation:{type:d["u"].List,form:{type:d["u"].String}},personal_motivations:{type:d["u"].List,form:{type:d["u"].String}}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"tool",name:"Tool",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String},tool_types:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},aliases:{type:d["u"].List,form:{type:d["u"].String}},kill_chain_phases:{type:d["u"].List,form:{type:d["u"].String}},tool_version:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"vulnerability",name:"Vulnerability",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},description:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"artifact",name:"Artifact",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{mime_type:{type:d["u"].String},payload_bin:{type:d["u"].String},url:{type:d["u"].String},hashes:{type:d["u"].String},encryption_algorithm:{type:d["u"].String},decryption_key:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"autonomous_system",name:"Autonomous System",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{number:{type:d["u"].String,is_primary:!0,is_required:!0},name:{type:d["u"].String},rir:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"directory",name:"Directory",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{path:{type:d["u"].String,is_primary:!0,is_required:!0},path_enc:{type:d["u"].String},ctime:{type:d["u"].Date},mtime:{type:d["u"].Date},atime:{type:d["u"].Date}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"domain_name",name:"Domain Name",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"email_address",name:"Email Address",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0},display_name:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"email_message",name:"Email Message",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{is_multipart:{type:d["u"].String,is_required:!0},date:{type:d["u"].String},content_type:{type:d["u"].String},message_id:{type:d["u"].String},subject:{type:d["u"].String,is_primary:!0},received_lines:{type:d["u"].String},additional_header_fields:{type:d["u"].String},body:{type:d["u"].String},body_multipart:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"file",name:"File",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{hashes:{type:d["u"].String},size:{type:d["u"].String},name:{type:d["u"].String,is_primary:!0},name_enc:{type:d["u"].String},magic_number_hex:{type:d["u"].String},mime_type:{type:d["u"].String},ctime:{type:d["u"].Date},mtime:{type:d["u"].Date},atime:{type:d["u"].Date}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"ipv4_addr",name:"IPv4 Address",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"ipv6_addr",name:"IPv6 Address",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"mac_addr",name:"MAC Address",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"mutex",name:"Mutex",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"network_traffic",name:"Network Traffic",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{start:{type:d["u"].Date},end:{type:d["u"].Date},is_active:{type:d["u"].String},src_port:{type:d["u"].Int,min:0,max:65535},dst_port:{type:d["u"].Int,min:0,max:65535},protocols:{type:d["u"].List,form:{type:d["u"].String},is_required:!0},src_byte_count:{type:d["u"].Int,min:0},dst_byte_count:{type:d["u"].Int,min:0},src_packets:{type:d["u"].String},dst_packets:{type:d["u"].String},ipfix:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"process",name:"Process",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{is_hidden:{type:d["u"].String},pid:{type:d["u"].Int,min:0},created_time:{type:d["u"].Date},cwd:{type:d["u"].String},command_line:{type:d["u"].String,is_required:!0},environment_variables:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"software",name:"Software",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{name:{type:d["u"].String,is_primary:!0,is_required:!0},cpe:{type:d["u"].String},languages:{type:d["u"].List,form:{type:d["u"].String}},vendor:{type:d["u"].String},version:{type:d["u"].String}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"url",name:"URL",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{value:{type:d["u"].String,is_required:!0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"user_account",name:"User Account",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{user_id:{type:d["u"].String},credential:{type:d["u"].String},account_login:{type:d["u"].String},account_type:{type:d["u"].String},display_name:{type:d["u"].String,is_primary:!0,is_required:!0},is_service_account:{type:d["u"].String},is_privileged:{type:d["u"].String},can_escalate_privs:{type:d["u"].String},is_disabled:{type:d["u"].String},account_created:{type:d["u"].Date},account_expires:{type:d["u"].Date},credential_last_changed:{type:d["u"].Date},account_first_login:{type:d["u"].Date},account_last_login:{type:d["u"].Date}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"windows_registry_key",name:"Windows Registry Key",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{key:{type:d["u"].String,is_primary:!0,is_required:!0},value:{type:d["u"].List,form:{type:d["u"].String}},modified_time:{type:d["u"].Date},number_of_subkeys:{type:d["u"].Int,min:0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})},{id:"x509_certificate",name:"X509 Certificate",type:d["z"].DictionaryBlock,role:d["x"].Node,properties:{subject:{type:d["u"].String,is_primary:!0,is_required:!0},is_self_signed:{type:d["u"].String},hashes:{type:d["u"].String},version:{type:d["u"].String},serial_number:{type:d["u"].String},signature_algorithm:{type:d["u"].String},issuer:{type:d["u"].String},validity_not_before:{type:d["u"].Date},validity_not_after:{type:d["u"].Date},subject_public_key_algorithm:{type:d["u"].String},subject_public_key_modulus:{type:d["u"].String},subject_public_key_exponent:{type:d["u"].Int,min:0}},anchor_template:"@__builtin__anchor",style:k["b"].DictionaryBlock({head:Object.assign({},k["a"].Gray)})}]},help_links:[{text:"Attack Flow Website",url:"https://center-for-threat-informed-defense.github.io/attack-flow/"},{text:"Builder Help",url:"https://center-for-threat-informed-defense.github.io/attack-flow/builder/"},{text:"GitHub Repository",url:"https://github.com/center-for-threat-informed-defense/attack-flow"},{text:"MITRE ATT&CK Framework",url:"https://attack.mitre.org/"}],validator:u,publisher:S};var B=M,D=i("a2be"),T=i("5502");class C{constructor(e){this._context=e}}class P extends C{constructor(e,t){super(e);let i=t.children.filter(e=>e.isSelected()),r=e.settings.edit.clone_offset,s=t.factory.cloneObjects(...i);for(let o of s)o.moveBy(r[0],r[1]);this._objects=s}execute(){this._context.clipboard=this._objects}}class E{static downloadTextFile(e,t,i="txt"){let r=new Blob([t],{type:"octet/stream"}),s=window.URL.createObjectURL(r);this._aLink.href=s,this._aLink.download=`${e}.${i}`,this._aLink.click(),window.URL.revokeObjectURL(s)}static downloadImageFile(e,t){t.toBlob(t=>{if(!t)return;let i=window.URL.createObjectURL(t);this._aLink.href=i,this._aLink.download=e+".png",this._aLink.click(),window.URL.revokeObjectURL(i)},"image/octet-stream")}static openTextFileDialog(){let e=document.createElement("input");e.type="file";let t=new Promise(t=>{e.addEventListener("change",e=>{let i=e.target.files[0],r=new FileReader;r.onload=e=>{var r;t({filename:i.name,contents:null===(r=e.target)||void 0===r?void 0:r.result})},r.readAsText(i)})});return e.click(),t}static fullscreen(e=document.body){let t=e;t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}}E._aLink=document.createElement("a");var A=i("9224");class L{constructor(e,t){this.id=e.id,this.page=e,this.trigger=Object(r["v"])(0),this.view={x:0,y:0,k:1,w:0,h:0},this.location=Object(r["v"])(null!==t&&void 0!==t?t:{x:0,y:0,k:1}),this._undoStack=[],this._redoStack=[],B.validator&&(this._validator=new B.validator,this._validator.run(e))}static createDummy(){return Object(r["o"])(new this(d["r"].createDummy()))}execute(e){var t;if(e.page!==this.page.id)throw new Error("Command is not configured to operate on this page.");e.execute()&&(this._redoStack=[],this._undoStack.push(e)),null===(t=this._validator)||void 0===t||t.run(this.page),this.trigger.value++}undo(){this._undoStack.length&&(this._undoStack.at(-1).undo(),this._redoStack.push(this._undoStack.pop()))}canUndo(){return 0<this._undoStack.length}redo(){this._redoStack.length&&(this._redoStack.at(-1).execute(),this._undoStack.push(this._redoStack.pop()))}canRedo(){return 0<this._redoStack.length}isValid(){var e,t;return null===(t=null===(e=this._validator)||void 0===e?void 0:e.inValidState())||void 0===t||t}getValidationErrors(){var e,t;return null!==(t=null===(e=this._validator)||void 0===e?void 0:e.getErrors())&&void 0!==t?t:[]}getValidationWarnings(){var e,t;return null!==(t=null===(e=this._validator)||void 0===e?void 0:e.getWarnings())&&void 0!==t?t:[]}static createNew(e){return Object(l["a"])(this,void 0,void 0,(function*(){let t=yield d["i"].create(e),i=t.createObject(e.page_template);return Object(r["o"])(new L(i))}))}static fromFile(e){return Object(l["a"])(this,void 0,void 0,(function*(){let t=JSON.parse(e),i=yield d["i"].create(t.schema),s=new Map;for(let e of t.objects)s.set(e.id,e);let o=s.get(t.id),n=function e(t,i,r,o){if(!r.has(t.id)){let n=[];for(let l of t.children)n.push(e(s.get(l),i,r,o));let a=o.createObject(Object.assign(Object.assign({},t),{children:n}));r.set(a.id,a)}return r.get(t.id)}(o,s,new Map,i);return n.recalculateLayout(),Object(r["o"])(new L(n,t.location))}))}toFile(){let e=this.view,t={x:(e.w/2-e.x)/e.k,y:(e.h/2-e.y)/e.k,k:e.k},i={version:A.version,id:this.page.id,schema:this.page.factory.getSchema(),objects:[...this.page.getSubtree()].map(e=>e.toExport()),location:t};return JSON.stringify(i)}}class H extends C{constructor(e,t){super(e),this._editor=t}static fromNew(e){return Object(l["a"])(this,void 0,void 0,(function*(){let t=structuredClone(B.schema),i=yield L.createNew(t);return new H(e,i)}))}static fromFile(e,t){return Object(l["a"])(this,void 0,void 0,(function*(){let i=yield L.fromFile(t);return new H(e,i)}))}static fromFileSystem(e){return Object(l["a"])(this,void 0,void 0,(function*(){let t=(yield E.openTextFileDialog()).contents,i=yield L.fromFile(t);return new H(e,i)}))}execute(){this._context.pages.clear(),this._context.pages.set(this._editor.id,this._editor),this._context.activePage=this._editor}}class I extends C{constructor(e,t){super(e),this._settings=t}execute(){this._context.settings=this._settings}}class F extends C{constructor(e,t){super(e),this._url=t}execute(){window.open(this._url,"_blank")}}class z extends C{constructor(e,t){super(e);let i=e.pages.get(t);if(!i)throw new Error(`Page '${t}' not found.`);if(!i.isValid())throw new Error(`Page '${t}' is not valid.`);if(!this._context.publisher)throw new Error("App is not configured with a publisher.");this._editor=i}execute(){E.downloadTextFile(this._editor.page.props.toString(),this._context.publisher.publish(this._editor.page),"json")}}var V=i("28e0");class R extends C{constructor(e,t){super(e);let i=e.pages.get(t);if(!i)throw new Error(`Page '${t}' not found.`);this._editor=i}execute(){let e=this._context.settings.view.diagram,t=this._context.settings.file.image_export,i=new V["a"](this._editor.page,t.padding,e.display_grid,e.display_shadows,e.display_debug_mode);E.downloadImageFile(this._editor.page.props.toString(),i.capture())}}class N extends C{constructor(e,t){super(e);let i=e.pages.get(t);if(!i)throw new Error(`Page '${t}' not found.`);this._editor=i}execute(){E.downloadTextFile(this._editor.page.props.toString(),this._editor.toFile(),B.file_type_extension)}}class $ extends C{constructor(e,t){super(e);let i=e.pages.get(t);if(!i)throw new Error(`Page '${t}' not found.`);this._editor=i,this._objects=[...i.page.getSubtree(e=>e.isSelected())]}execute(){let e=this._context.settings.view.diagram,t=this._context.settings.file.image_export,i=new V["a"](this._editor.page,t.padding,e.display_grid,e.display_shadows,e.display_debug_mode);E.downloadImageFile(this._editor.page.props.toString(),i.capture(this._objects))}}class q extends C{constructor(e,t,i){super(e);let r=e.pages.get(t);if(!r)throw new Error(`Page '${t}' not found.`);this._editor=r,this._params=i}execute(){this._editor.view=this._params}}class G extends C{constructor(e,t){super(e),this._highQuality=t}execute(){let{diagram:e}=this._context.settings.view;e.render_high_quality=this._highQuality}}class U extends C{constructor(e){super(e)}execute(){let e=document.body;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}}class W extends C{constructor(e){super(e)}execute(){let{diagram:e}=this._context.settings.view;e.display_debug_mode=!e.display_debug_mode}}class Y extends C{constructor(e){super(e)}execute(){let{diagram:e}=this._context.settings.view;e.display_grid=!e.display_grid}}class K extends C{constructor(e){super(e)}execute(){let{diagram:e}=this._context.settings.view;e.display_shadows=!e.display_shadows}}const X=e=>(Object(r["t"])("data-v-1e6f5773"),e=e(),Object(r["s"])(),e),J=X(()=>Object(r["g"])("span",{class:"logo"},"AFB",-1));function Z(e,t,i,s,o,n){const a=Object(r["y"])("TitleBar");return Object(r["r"])(),Object(r["d"])(a,{class:"app-title-bar-element",menus:e.menus,onSelect:e.onItemSelect},{icon:Object(r["E"])(()=>[J]),_:1},8,["menus","onSelect"])}const Q={class:"icon"},ee=["onMouseenter","onClick"];function te(e,t,i,s,o,n){const a=Object(r["y"])("ContextMenuListing"),l=Object(r["y"])("FocusBox");return Object(r["r"])(),Object(r["d"])(l,{class:"title-bar-control",onUnfocus:e.menuClose},{default:Object(r["E"])(()=>[Object(r["g"])("li",Q,[Object(r["x"])(e.$slots,"icon",{},void 0,!0)]),(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.menus,i=>(Object(r["r"])(),Object(r["f"])("li",{key:i.text,class:Object(r["p"])({focused:i.text===e.focusedMenu}),onMouseenter:t=>e.menuEnter(i.text),onClick:t=>e.menuOpen(i.text)},[Object(r["g"])("p",null,Object(r["A"])(i.text),1),i.text===e.focusedMenu?(Object(r["r"])(),Object(r["d"])(a,{key:0,class:"menu-listing",sections:i.sections,onSelect:e.menuSelect,onClick:t[0]||(t[0]=Object(r["G"])(()=>{},["stop"]))},null,8,["sections","onSelect"])):Object(r["e"])("",!0)],42,ee))),128))]),_:3},8,["onUnfocus"])}var ie=i("e0ac");const re=e=>(Object(r["t"])("data-v-03d00514"),e=e(),Object(r["s"])(),e),se=["onMouseenter"],oe={class:"item"},ne={class:"text"},ae=re(()=>Object(r["g"])("span",{class:"more-arrow"},null,-1)),le={key:0,class:"submenu"},ce=["onClick"],de=["href"],he={class:"check"},ue={class:"text"},pe={key:0,class:"shortcut"},ge={key:0,class:"section-divider"};function ye(e,t,i,s,o,n){const a=Object(r["y"])("ContextMenuListing",!0);return Object(r["r"])(),Object(r["f"])("div",{class:"context-menu-listing-control",style:Object(r["q"])(e.offset),onContextmenu:t[1]||(t[1]=Object(r["G"])(()=>{},["prevent"]))},[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.sections,(i,s)=>(Object(r["r"])(),Object(r["f"])("div",{class:"section",key:i.id},[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(i.items,i=>(Object(r["r"])(),Object(r["f"])(r["a"],{key:i.text},[i.type===e.MenuType.Submenu?(Object(r["r"])(),Object(r["f"])("li",{key:0,class:Object(r["p"])({disabled:i.disabled}),onMouseenter:t=>e.submenuEnter(i),onMouseleave:t[0]||(t[0]=(...t)=>e.submenuLeave&&e.submenuLeave(...t))},[Object(r["g"])("a",oe,[Object(r["g"])("span",ne,Object(r["A"])(i.text),1),ae]),i.text===e.focusedSubMenu?(Object(r["r"])(),Object(r["f"])("div",le,[Object(r["i"])(a,{sections:i.sections,onSelect:e.onChildItemSelect},null,8,["sections","onSelect"])])):Object(r["e"])("",!0)],42,se)):(Object(r["r"])(),Object(r["f"])("li",{key:1,class:Object(r["p"])({disabled:i.disabled}),onClick:t=>e.onItemClick(i)},[Object(r["g"])("a",{class:"item",href:i.disabled?null:i.link,target:"_blank"},[Object(r["F"])(Object(r["g"])("span",he,"✓",512),[[r["C"],i.value]]),Object(r["g"])("span",ue,Object(r["A"])(i.text),1),i.shortcut?(Object(r["r"])(),Object(r["f"])("span",pe,Object(r["A"])(e.formatShortcut(i.shortcut)),1)):Object(r["e"])("",!0)],8,de)],10,ce))],64))),128)),s<e.sections.length-1?(Object(r["r"])(),Object(r["f"])("a",ge)):Object(r["e"])("",!0)]))),128))],36)}var fe;(function(e){e[e["Item"]=0]="Item",e[e["Toggle"]=1]="Toggle",e[e["Submenu"]=2]="Submenu"})(fe||(fe={}));const be={Control:"Ctrl",Escape:"Esc",ArrowLeft:"←",ArrowUp:"↑",ArrowRight:"→",ArrowDown:"↓",Delete:"Del"};var _e=Object(r["k"])({name:"ContextMenuListing",props:{sections:{type:Array,required:!0},forceInsideWindow:{type:Boolean,default:!0}},data(){return{xOffset:0,yOffset:0,leaveTimeout:500,leaveTimeoutId:0,focusedSubMenu:null,MenuType:fe}},computed:{offset(){return{marginTop:this.yOffset+"px",marginLeft:this.xOffset+"px"}}},methods:{submenuEnter(e){clearTimeout(this.leaveTimeoutId),e.disabled||(this.focusedSubMenu=e.text)},submenuLeave(){this.leaveTimeoutId=setTimeout(()=>{this.focusedSubMenu=null},this.leaveTimeout)},onItemClick(e){e.disabled||this.$emit("select",e.data,!e.keepMenuOpenOnSelect)},onChildItemSelect(e,t){this.$emit("select",e,t),t&&(this.focusedSubMenu=null)},formatShortcut(e){return e?e.split("+").map(e=>e in be?be[e]:e).join("+"):e}},emits:["select"],mounted(){if(!this.forceInsideWindow)return;let e=window.innerWidth,t=window.innerHeight,{top:i,left:r,bottom:s,right:o}=this.$el.getBoundingClientRect();this.xOffset=o>e?-Math.min(r,o-e):0,this.yOffset=s>t?-Math.min(i,s-t):0}}),me=(i("44e9"),i("6b0d")),ve=i.n(me);const xe=ve()(_e,[["render",ye],["__scopeId","data-v-03d00514"]]);var we=xe,je=Object(r["k"])({name:"TitleBar",props:{menus:{type:Array,default:[]}},data(){return{focusedMenu:null}},emits:["select"],methods:{menuOpen(e){this.focusedMenu=e},menuEnter(e){null!==this.focusedMenu&&(this.focusedMenu=e)},menuClose(){this.focusedMenu=null},menuSelect(e,t){this.$emit("select",e),t&&(this.focusedMenu=null)}},components:{FocusBox:ie["a"],ContextMenuListing:we}});i("2c3e");const Oe=ve()(je,[["render",te],["__scopeId","data-v-63eba18e"]]);var Se=Oe,ke=Object(r["k"])({name:"AppTitleBar",computed:Object.assign(Object.assign({},Object(T["b"])("ContextMenuStore",["fileMenu","editMenu","layoutMenu","viewMenu","helpMenu"])),{menus(){return[this.fileMenu,this.editMenu,this.layoutMenu,this.viewMenu,this.helpMenu]}}),methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{onItemSelect(e){return Object(l["a"])(this,void 0,void 0,(function*(){try{let t=e();if(t instanceof Promise){let e=yield t;this.execute(e)}else this.execute(t)}catch(t){console.error(t)}}))}}),components:{TitleBar:Se}});i("219f");const Me=ve()(ke,[["render",Z],["__scopeId","data-v-1e6f5773"]]);var Be=Me;function De(e,t,i,s,o,n){const a=Object(r["y"])("HotkeyBox");return Object(r["r"])(),Object(r["d"])(a,{class:"app-hotkey-box-element",hotkeys:e.hotkeys,global:!0,onFire:e.onHotkeyFired},{default:Object(r["E"])(()=>[Object(r["x"])(e.$slots,"default")]),_:3},8,["hotkeys","onFire"])}const Te={class:"hotkey-box-container",tabindex:"0"};function Ce(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",Te,[Object(r["x"])(e.$slots,"default",{},void 0,!0)])}class Pe{constructor(e,t){this._boundAdvanceKeyState=this.advanceKeyState.bind(this),this._boundReverseKeyState=this.reverseKeyState.bind(this),this._callback=e,this._callLoop=void 0,this._container=null,this._hotkeyIdMap=new Map,this._keyState=".",this._recognitionDelay=t}observe(e){this._container=e,this._container.addEventListener("keydown",this._boundAdvanceKeyState),this._container.addEventListener("keyup",this._boundReverseKeyState)}disconnect(){var e,t;null===(e=this._container)||void 0===e||e.removeEventListener("keydown",this._boundAdvanceKeyState),null===(t=this._container)||void 0===t||t.removeEventListener("keyup",this._boundReverseKeyState)}setHotkeys(e){this._hotkeyIdMap=new Map;for(let t of e){if(""===t.shortcut)continue;let e=this.keySequenceToHotKeyId(t.shortcut);for(let t of this._hotkeyIdMap.keys())if(t.startsWith(e)||e.startsWith(t))throw new Ee(`Overlapping key sequences ('${t}' and '${e}') are not allowed.`);this._hotkeyIdMap.set(e,t)}}isHotkeyActive(e,t=!0){let i=this.keySequenceToHotKeyId(e);return t?this._keyState===i:this._keyState.includes(i)}advanceKeyState(e){let t=e.key.toLocaleLowerCase();if(!this._keyState.endsWith(`.${t}.`)&&(clearTimeout(this._callLoop),this._keyState+=t+".","INPUT"!==e.target.tagName))if(this._hotkeyIdMap.has(this._keyState)){let t=this._hotkeyIdMap.get(this._keyState);t.allowBrowserBehavior||e.preventDefault(),this.triggerHotkey(t)}else e.preventDefault()}reverseKeyState(e){clearTimeout(this._callLoop);let t=e.key.toLocaleLowerCase();this._keyState=this._keyState.replace(`.${t}.`,".")}triggerHotkey(e){e.data&&!e.disabled&&(this._callLoop=setTimeout(()=>{if(this._callback(e.data),!e.repeat)return;let t=function(){this._callback(e.data),this._callLoop=setTimeout(t,e.repeat.interval)}.bind(this);this._callLoop=setTimeout(t,e.repeat.delay)},this._recognitionDelay))}keySequenceToHotKeyId(e){let t=e.toLocaleLowerCase().replace(/\s+/g,"").split("+").join(".");return`.${t}.`}}class Ee extends Error{constructor(e){super(e)}}var Ae=Object(r["k"])({name:"HotkeyBox",provide(){return{isHotkeyActive:(e,t=!0)=>this.observer.isHotkeyActive(e,t)}},props:{hotkeys:{type:Array,default:[]},global:{type:Boolean,default:!1}},data(){return{observer:Object(r["o"])(new Pe((e,t)=>this.$emit("fire",e,t),0))}},emits:["fire"],watch:{hotkeys(){this.observer.setHotkeys(this.hotkeys)}},mounted(){this.observer.observe(this.global?document.body:this.$el),this.observer.setHotkeys(this.hotkeys)},unmounted(){this.observer.disconnect()}});i("cb32");const Le=ve()(Ae,[["render",Ce],["__scopeId","data-v-5e99f3da"]]);var He=Le,Ie=Object(r["k"])({name:"AppHotkeyBox",computed:Object.assign(Object.assign({},Object(T["b"])("HotkeyStore",["nativeHotkeys","fileHotkeys","editHotKeys","layoutHotkeys","viewHotkeys"])),{hotkeys(){return[...this.nativeHotkeys,...this.fileHotkeys,...this.editHotKeys,...this.layoutHotkeys,...this.viewHotkeys]}}),methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{onHotkeyFired(e){return Object(l["a"])(this,void 0,void 0,(function*(){try{let t=e();if(t instanceof Promise){let e=yield t;this.execute(e)}else this.execute(t)}catch(t){console.error(t)}}))}}),components:{HotkeyBox:He}});const Fe=ve()(Ie,[["render",De]]);var ze,Ve=Fe;function Re(e,t,i,s,o,n){const a=Object(r["y"])("ContextMenu");return Object(r["r"])(),Object(r["f"])("div",{class:"block-diagram-element",style:Object(r["q"])(e.cursorStyle)},[e.menu.show?(Object(r["r"])(),Object(r["d"])(a,{key:0,class:"block-diagram-menu",style:Object(r["q"])(e.menuStyle),sections:e.menuOptions,onSelect:e.onItemSelect,onUnfocus:e.closeContextMenu},null,8,["style","sections","onSelect","onUnfocus"])):Object(r["e"])("",!0)],4)}class Ne{constructor(e){this.page=e}}Ne.NullPage="$__null_page";class $e extends Ne{constructor(e,t,i,r){super(t.root.id),this._object=e,this._parent=t,this._source=i,this._target=r}execute(){this._parent.addChild(this._object);let{xMid:e,yMid:t}=this._source.boundingBox;if(this._object.srcEnding.moveTo(e,t),this._source.addChild(this._object.srcEnding),this._target){let{xMid:e,yMid:t}=this._target.boundingBox;this._object.trgEnding.moveTo(e,t),this._target.addChild(this._object.trgEnding)}return!0}undo(){this._object.setHover(d["m"].Off),this._object.setSelect(d["v"].False),this._source.removeChild(this._object.srcEnding),this._target&&this._target.removeChild(this._object.trgEnding),this._parent.removeChild(this._object)}}class qe extends Ne{constructor(e,t){super(t.root.id),this._object=e,this._parent=t}execute(){return this._parent.addChild(this._object),!0}undo(){this._object.setHover(d["m"].Off),this._object.setSelect(d["v"].False),this._parent.removeChild(this._object,!0,!1)}}class Ge extends Ne{constructor(e,t){if(e.root.id!==t.root.id)throw new d["j"]("Objects must originate from the same root.");super(e.root.id),this._object=t,this._anchor=e}execute(){return this._anchor.addChild(this._object),!0}undo(){this._anchor.removeChild(this._object)}}class Ue extends Ne{constructor(e){let t=e.root;if(!t)throw new Error("Property does not have a root.");super(t.object.root.id),this._id=null,this._property=e,this._subproperty=d["t"].create(e,e.descriptor.form)}execute(){return this._id=this._property.addProperty(this._subproperty),!0}undo(){this._id&&this._property.removeProperty(this._id)}}class We extends Ne{constructor(){super(Ne.NullPage),this._commands=[]}add(e){if(this.page!==Ne.NullPage&&this.page!==e.page)throw new d["j"]("Commands must operate on the same page.");this.page=e.page,this._commands.push(e)}execute(){let e=0,t=this._commands.length,i=!1;try{for(;e<t;e++){let t=this._commands[e].execute();i||(i=t)}}catch(r){for(e--;0<=e;e--)this._commands[e].undo();throw r}return i}undo(){let e=this._commands.length-1;for(let t=e;0<=t;t--)this._commands[t].undo()}}class Ye extends Ne{constructor(e){let t=e[0].root.id;for(let r=1;r<e.length;r++)if(t!==e[r].root.id)throw new d["j"]("Objects must originate from the same root.");super(t),this._links=[],this._items=[];for(let r of e){if(!r.parent)throw new d["j"]("Object must have a parent.",r);this._items.push({index:r.getIndexInParent(),parent:r.parent,object:r})}let i=new Map;for(let r of this._items)for(let e of r.object.getSubtree())(e instanceof d["g"]||e instanceof d["h"])&&i.set(e.id,e);for(let r of i.values())if(r instanceof d["h"])r.isAttached()&&!i.has(r.anchor.id)&&this._links.push({index:r.getIndexInAnchor(),anchor:r.anchor,object:r});else if(r instanceof d["g"])for(let e of r.children)i.has(e.id)||this._links.push({index:e.getIndexInAnchor(),anchor:r,object:e})}execute(){for(let e of this._links)e.anchor.removeChild(e.object);for(let e of this._items)e.parent.removeChild(e.object,!0,!1);return!0}undo(){for(let e of this._items)e.parent.addChild(e.object,e.index);for(let e of this._links)e.anchor.addChild(e.object,e.index)}}class Ke extends Ne{constructor(e){super(e.root.id),this._object=e}execute(){let e=this._object;while(e)e.setHover(d["m"].Off),e=e.parent;return!1}undo(){}}class Xe extends Ne{constructor(e){super(e.root.id),this._object=e}execute(){return this._object.setSelect(d["v"].False),!1}undo(){}}class Je extends We{constructor(e){super();let t=e.children.filter(e=>e.isSelected());for(let i of t)i.isHovered()&&this.add(new Ke(i)),this.add(new Xe(i));this.add(new Ye(t))}}class Ze extends We{constructor(e,t){super(),this._context=e;let i=t.children.filter(e=>e.isSelected());this._objects=t.factory.cloneObjects(...i),this.add(new Je(t))}execute(){return this._context.clipboard=this._objects,super.execute()}}class Qe extends Ne{constructor(e,t){let i=e.root;if(!i)throw new Error("Property does not have a root.");let r=e.value.get(t);if(!r)throw new Error(`Subproperty '${t}' does not exist.`);super(i.object.root.id),this._id=t,this._index=e.indexOf(t),this._property=e,this._subproperty=r}execute(){return this._property.removeProperty(this._id),!0}undo(){this._property.addProperty(this._subproperty,this._id,this._index)}}class et extends Ne{constructor(e){if(!e.isAttached())throw new d["j"]("Object must be attached to an anchor.",e);super(e.root.id),this._object=e,this._anchor=e.anchor,this._index=e.getIndexInAnchor()}execute(){return this._anchor.removeChild(this._object),!0}undo(){this._anchor.addChild(this._object,this._index)}}class tt extends We{constructor(e,t){super();let i=t.children.filter(e=>e.isSelected());for(let o of i)this.add(new Xe(o));let r=e.settings.edit.clone_offset,s=t.factory.cloneObjects(...i);for(let o of s)o.moveBy(r[0],r[1]),o.setSelect(d["v"].True),this.add(new qe(o,t))}}class it extends Ne{constructor(e){super(e.root.id),this._object=e}execute(){this._object.setHover(d["m"].Direct);let e=this._object.parent;while(e)e.setHover(d["m"].Indirect),e=e.parent;return!1}undo(){}}class rt extends Ne{constructor(e){super(e.root.id),this._object=e}execute(){return this._object.setSelect(d["v"].True),!1}undo(){}}class st extends We{constructor(e){super();for(let t of e.getSubtree(e=>e.isSelected()))this.add(new Xe(t))}}class ot extends Ne{constructor(e,t){let i=t[0].root;for(let b=1;b<t.length;b++)if(i.id!==t[b].root.id)throw new d["j"]("Objects must originate from the same root.");let r=e.pages.get(i.id);if(!r)throw new Error("Objects must be managed by an editor.");super(i.id),this._editor=r;let s=1/0,o=1/0,n=-1/0,a=-1/0;for(let d of t)s=Math.min(s,d.boundingBox.xMin),o=Math.min(o,d.boundingBox.yMin),n=Math.max(n,d.boundingBox.xMax),a=Math.max(a,d.boundingBox.yMax);let l=n-s,c=a-o,h=Math.round((s+n)/2),u=Math.round((o+a)/2),p=l/r.view.w,g=c/r.view.h,y=Math.max(p,g),f=Math.min(.9/y,1.5);this._location={x:h,y:u,k:f}}execute(){return this._editor.location.value=this._location,!1}undo(){}}class nt extends We{constructor(e,t){super();let i=t.children.filter(e=>e.isSelected());if(!i.length)return;let r=[];for(let s of i){let e=d["w"].getNextGraphLinks(s);if(s.hasRole(d["x"].Node))for(let t of e){let e=d["w"].getNextGraphLinks(t);e.length?r=r.concat(e):r.push(t)}else r=r.concat(e)}this.add(new st(t));for(let s of r)this.add(new rt(s));r.length&&this.add(new ot(e,r))}}class at extends We{constructor(e,t){super();let i=t.children.filter(e=>e.isSelected());if(!i.length)return;let r=[];for(let s of i){let e=d["w"].getPrevGraphLinks(s);if(s.hasRole(d["x"].Node))for(let t of e){let e=d["w"].getPrevGraphLinks(t);e.length?r=r.concat(e):r.push(t)}else r=r.concat(e)}this.add(new st(t));for(let s of r)this.add(new rt(s));r.length&&this.add(new ot(e,r))}}class lt extends We{constructor(e,t){super();let i=t.children.filter(e=>e.isSelected());i.length&&this.add(new ot(e,i))}}class ct extends Ne{constructor(e,t,i){super(e.root.id),this._object=e,this._dx=t,this._dy=i}execute(){return this._object.moveBy(this._dx,this._dy),!0}undo(){this._object.moveBy(-this._dx,-this._dy)}}class dt extends Ne{constructor(e,t,i){super(e.root.id),this._object=e,this._lx=e.boundingBox.xMid,this._ly=e.boundingBox.yMid,this._nx=t,this._ny=i}execute(){return this._object.moveTo(this._nx,this._ny),!0}undo(){this._object.moveTo(this._lx,this._ly)}}class ht extends We{constructor(e,t){super(),this._context=e,this.add(new st(t));let i=t.factory.cloneObjects(...e.clipboard);for(let r of i)r.setSelect(d["v"].True),this.add(new qe(r,t))}execute(){let e=this._context.settings.edit.clone_offset;for(let t of this._context.clipboard)t.moveBy(e[0],e[1]);return super.execute()}}class ut extends Ne{constructor(e,t){super(t);let i=e.pages.get(t);if(!i)throw new Error(`'${t}' is not a page.`);this._editor=i}execute(){return this._editor.redo(),!1}undo(){}}class pt extends Ne{constructor(e,t){if(!e.parent)throw new d["j"]("Object must have a parent.",e);switch(super(e.root.id),this._object=e,this._parent=e.parent,this._prevIndex=e.getIndexInParent(),t){case ze.Top:this._nextIndex=e.children.length;break;case ze.OneAbove:this._nextIndex=this._prevIndex+1;break;case ze.OneBelow:this._nextIndex=this._prevIndex-1;break;case ze.Bottom:this._nextIndex=0;break}}execute(){return this._parent.reorderChild(this._object.id,this._nextIndex),!0}undo(){this._parent.reorderChild(this._object.id,this._prevIndex)}}(function(e){e[e["Top"]=0]="Top",e[e["OneAbove"]=2]="OneAbove",e[e["OneBelow"]=3]="OneBelow",e[e["Bottom"]=4]="Bottom"})(ze||(ze={}));class gt extends We{constructor(e,t){super();let i=e.children.filter(e=>e.isSelected());switch(t){case ze.Top:case ze.OneAbove:for(let e=i.length-1;0<=e;e--)this.add(new pt(i[e],t));break;case ze.Bottom:case ze.OneBelow:for(let e=0;e<i.length;e++)this.add(new pt(i[e],t));break}}}class yt extends Ne{constructor(e,t){super(t.id);let i=e.pages.get(t.id);if(!i)throw new Error(`Page '${t.id}' does not have an editor.`);this._editor=i}execute(){return this._editor.location.value={x:0,y:0,k:1},!1}undo(){}}class ft extends We{constructor(e){super();for(let t of e.children)this.add(new rt(t))}}class bt extends Ne{constructor(e,t){let i=e.toRawValue(),r=e.root;if(!r)throw new Error("Property does not have a root.");super(r.object.root.id),this._property=e,this._lastValue=null!==i?new Date(i):i,this._nextValue=t}execute(){return this._property.setValue(this._nextValue),!0}undo(){this._property.setValue(this._lastValue)}}class _t extends Ne{constructor(e,t){let i=e.root;if(!i)throw new Error("Property does not have a root.");super(i.object.root.id),this._property=e,this._lastValue=e.toRawValue(),this._nextValue=t}execute(){return this._property.setValue(this._nextValue),!0}undo(){this._property.setValue(this._lastValue)}}class mt extends Ne{constructor(e,t){let i=e.root;if(!i)throw new Error("Property does not have a root.");super(i.object.root.id),this._property=e,this._lastValue=e.toRawValue(),this._nextValue=t}execute(){return this._property.setValue(this._nextValue),!0}undo(){this._property.setValue(this._lastValue)}}class vt extends Ne{constructor(e,t){let i=e.root;if(!i)throw new Error("Property does not have a root.");super(i.object.root.id),this._property=e,this._lastValue=e.toRawValue(),this._nextValue=t}execute(){return this._property.setValue(this._nextValue),!0}undo(){this._property.setValue(this._lastValue)}}class xt extends We{constructor(e,t,i,r,s){super();let o=e.pages.get(t.root.id);if(!o)throw new Error(`'${t.id}' must belong to an existing editor.`);let n=t.factory.createObject(i),a=o.view;if(void 0===r)r=Math.round((a.w/2-a.x)/a.k);else{let{xMid:e,xMin:t}=n.boundingBox;r=(r-a.x)/a.k+e-t}if(void 0===s)s=Math.round((a.h/2-a.y)/a.k);else{let{yMid:e,yMin:t}=n.boundingBox;s=(s-a.y)/a.k+e-t}n.getAlignment()===d["a"].Grid&&(r=Object(d["B"])(r,o.page.grid[0]),s=Object(d["B"])(s,o.page.grid[1])),n.moveTo(r,s),this.add(new qe(n,t))}}class wt extends Ne{constructor(e,t){super(t);let i=e.pages.get(t);if(!i)throw new Error(`'${t}' is not a page.`);this._editor=i}execute(){return this._editor.undo(),!1}undo(){}}class jt extends We{constructor(e){super();for(let t of e.getSubtree(this.isDirectlyHovered))this.add(new Ke(t))}isDirectlyHovered(e){return(e.attrs&d["n"])===d["m"].Direct}}class Ot extends Ne{constructor(e){super(e.root.id),this._object=e}execute(){return this._object.setPositionSetByUser(d["s"].True),!0}undo(){this._object.setPositionSetByUser(d["s"].False)}}class St extends Ne{constructor(e,t,i){super(t.id);let r=e.pages.get(t.id);if(!r)throw new Error(`Page '${t.id}' does not have an editor.`);this._editor=r;let s=r.view.k,o=(r.view.w/2-r.view.x)/s,n=(r.view.h/2-r.view.y)/s;this._location={x:o,y:n,k:s+i}}execute(){return this._editor.location.value=this._location,!1}undo(){}}function kt(e,t,i,s,o,n){const a=Object(r["y"])("ContextMenuListing"),l=Object(r["y"])("FocusBox");return Object(r["r"])(),Object(r["d"])(l,{style:Object(r["q"])(e.offset),class:"context-menu-control",onUnfocus:t[1]||(t[1]=t=>e.$emit("unfocus")),onContextmenu:t[2]||(t[2]=Object(r["G"])(()=>{},["prevent"]))},{default:Object(r["E"])(()=>[Object(r["i"])(a,{sections:e.sections,onSelect:t[0]||(t[0]=t=>e.$emit("select",t)),forceInsideWindow:!1},null,8,["sections"])]),_:1},8,["style"])}var Mt=Object(r["k"])({name:"ContextMenu",props:{sections:{type:Array,required:!0}},data(){return{xOffset:0,yOffset:0}},computed:{offset(){return{marginTop:this.yOffset+"px",marginLeft:this.xOffset+"px"}}},emits:["select","unfocus"],mounted(){let e=window.innerWidth,t=window.innerHeight,{bottom:i,right:r}=this.$el.getBoundingClientRect();this.xOffset=r>e?-(this.$el.clientWidth-1):0,this.yOffset=i>t?-(this.$el.clientHeight-1):0},components:{FocusBox:ie["a"],ContextMenuListing:we}});i("856c");const Bt=ve()(Mt,[["render",kt],["__scopeId","data-v-6a0233c2"]]);var Dt=Bt,Tt=Object(r["k"])({name:"BlockDiagram",setup(){return{isHotkeyActive:Object(r["n"])("isHotkeyActive")}},data(){return{cursor:d["d"].Default,diagram:Object(r["o"])(new d["c"]),menu:{x:0,y:0,show:!1},view:{x:0,y:0,k:1,w:0,h:0}}},computed:Object.assign(Object.assign(Object.assign(Object.assign({},Object(T["d"])("ApplicationStore",{ctx(e){return e},editor(e){return e.activePage},camera(e){return e.activePage.location.value},pageUpdate(e){return e.activePage.trigger.value},displayGrid(e){return e.settings.view.diagram.display_grid},displayShadows(e){return e.settings.view.diagram.display_shadows},displayDebugMode(e){return e.settings.view.diagram.display_debug_mode},renderHighQuality(e){return e.settings.view.diagram.render_high_quality},disableShadowsAt(e){return e.settings.view.diagram.disable_shadows_at},multiselectHotkey(e){return e.settings.hotkeys.select.many}})),Object(T["b"])("ApplicationStore",["hasSelection"])),Object(T["b"])("ContextMenuStore",["deleteMenu","clipboardMenu","duplicateMenu","layeringMenu","jumpMenu","undoRedoMenu","selectAllMenu","zoomMenu","diagramViewMenu"])),{cursorStyle(){return{cursor:d["e"][this.cursor]}},menuStyle(){return{top:this.menu.y+"px",left:this.menu.x+"px"}},menuOptions(){return this.hasSelection?[this.deleteMenu,this.clipboardMenu,this.duplicateMenu,this.layeringMenu,this.jumpMenu]:[this.undoRedoMenu,this.createMenu,this.selectAllMenu,this.zoomMenu,this.diagramViewMenu]},createMenu(){let e=this.editor.page.factory,t=[];for(let r of e.getBlockTemplates())t.push({text:r.name,type:fe.Item,data:()=>new xt(this.ctx,this.editor.page,r.id,this.menu.x,this.menu.y)});let i=[];for(let r of e.getLineTemplates())i.push({text:r.name,type:fe.Item,data:()=>new xt(this.ctx,this.editor.page,r.id,this.menu.x,this.menu.y)});return{id:"create_options",items:[{text:"Create",type:fe.Submenu,sections:[{id:"blocks",items:t},{id:"lines",items:i}]}]}}}),methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{onItemSelect(e){return Object(l["a"])(this,void 0,void 0,(function*(){try{let t=e();if(t instanceof Promise){let e=yield t;this.execute(e)}else this.execute(t)}catch(t){console.error(t)}this.closeContextMenu()}))},openContextMenu(e,t){requestAnimationFrame(()=>{this.menu.show=!0,this.menu.x=e,this.menu.y=t})},closeContextMenu(){this.menu.show=!1},onObjectHover(e,t){this.cursor=t,this.execute(new jt(this.editor.page)),e&&this.execute(new it(e))},onObjectClick(e,t,i,r){let s=this.isHotkeyActive(this.multiselectHotkey);s||t.isSelected()||this.execute(new st(this.editor.page)),this.execute(new rt(t)),e.button===d["p"].Right&&this.openContextMenu(i,r)},onCanvasClick(e,t,i){this.execute(new st(this.editor.page)),e.button===d["p"].Right&&this.openContextMenu(t,i)},onObjectMove(e,t,i){let r=new We;for(let s of e)s.hasUserSetPosition()||r.add(new Ot(s)),r.add(new ct(s,t,i));this.execute(r)},onObjectAttach(e,t){let{xMid:i,yMid:r}=t.boundingBox,s=new We;e.isAttached()&&s.add(new et(e)),s.add(new dt(e,i,r)),s.add(new Ge(t,e)),this.execute(s)},onObjectDetach(e,t,i){let r=new We;r.add(new et(e)),r.add(new ct(e,t,i)),this.execute(r)},onLineCreate(e,t,i,r){this.execute(new $e(e,t,i,r)),this.execute(new st(this.editor.page)),this.execute(new rt(e))},onViewTransform(e,t,i,r,s){this.view={x:e,y:t,k:i,w:r,h:s},this.execute(new q(this.ctx,this.editor.id,Object.assign({},this.view)))}}),watch:{editor(){this.diagram.setPage(Object(r["o"])(this.editor.page)),this.diagram.updateView(),this.diagram.setCameraLocation(this.camera,0),this.execute(new q(this.ctx,this.editor.id,Object.assign({},this.view)))},camera(){this.diagram.setCameraLocation(this.camera)},pageUpdate(){this.diagram.updateView(),this.diagram.render()},displayGrid(){this.diagram.setGridDisplay(this.displayGrid),this.diagram.render()},displayShadows(){this.diagram.setShadowsDisplay(this.displayShadows),this.diagram.render()},displayDebugMode(){this.diagram.setDebugDisplay(this.displayDebugMode),this.diagram.render()},renderHighQuality(){this.diagram.setSsaaScale(this.renderHighQuality?2:1),this.diagram.render()},disableShadowsAt(){this.diagram.setShadowsDisableAt(this.disableShadowsAt),this.diagram.render()}},mounted(){this.diagram.on("object-hover",this.onObjectHover),this.diagram.on("object-click",this.onObjectClick),this.diagram.on("canvas-click",this.onCanvasClick),this.diagram.on("object-move",this.onObjectMove),this.diagram.on("object-attach",this.onObjectAttach),this.diagram.on("object-detach",this.onObjectDetach),this.diagram.on("view-transform",this.onViewTransform),this.diagram.on("line-create",this.onLineCreate),this.diagram.setGridDisplay(this.displayGrid),this.diagram.setShadowsDisplay(this.displayShadows),this.diagram.setDebugDisplay(this.displayDebugMode),this.diagram.setSsaaScale(this.renderHighQuality?2:1),this.diagram.setShadowsDisableAt(this.disableShadowsAt),this.diagram.setPage(Object(r["o"])(this.editor.page)),this.diagram.inject(this.$el),this.diagram.updateView(),this.diagram.setCameraLocation(this.camera,0)},unmounted(){this.diagram.destroy()},components:{ContextMenu:Dt}});i("760f");const Ct=ve()(Tt,[["render",Re],["__scopeId","data-v-3e2ee7b8"]]);var Pt=Ct;const Et=e=>(Object(r["t"])("data-v-783f2534"),e=e(),Object(r["s"])(),e),At={class:"app-footer-bar-element"},Lt={class:"info left"},Ht={class:"selected"},It=Et(()=>Object(r["g"])("span",null,"Selected:",-1)),Ft={class:"info right"},zt={key:0,class:"page-check valid"},Vt=Et(()=>Object(r["g"])("span",null,"✓",-1)),Rt={key:1,class:"page-check invalid"},Nt=Et(()=>Object(r["g"])("span",null,"⚠",-1));function $t(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",At,[Object(r["g"])("div",Lt,[Object(r["g"])("p",Ht,[It,Object(r["h"])(" "+Object(r["A"])(e.hasSelection),1)])]),Object(r["g"])("div",Ft,[e.isValid?(Object(r["r"])(),Object(r["f"])("div",zt,[Vt,Object(r["h"])(" Valid "+Object(r["A"])(e.fileName),1)])):(Object(r["r"])(),Object(r["f"])("div",Rt,[Nt,Object(r["h"])(" Invalid "+Object(r["A"])(e.fileName),1)]))])])}var qt=Object(r["k"])({name:"AppFooterBar",data(){return{fileName:B.file_type_name}},computed:Object.assign({},Object(T["b"])("ApplicationStore",["hasSelection","isValid"]))});i("75a4");const Gt=ve()(qt,[["render",$t],["__scopeId","data-v-783f2534"]]);var Ut=Gt;function Wt(e,t,i,s,o,n){const a=Object(r["y"])("PropertyEditor"),l=Object(r["y"])("AccordionPane"),c=Object(r["y"])("ValidatorProblems"),d=Object(r["y"])("AccordionBox");return Object(r["r"])(),Object(r["d"])(d,{class:"editor-tabs-element"},{default:Object(r["E"])(()=>[Object(r["i"])(l,{name:"Properties",units:3},{default:Object(r["E"])(()=>[Object(r["i"])(a,{class:"properties-pane",property:e.selected},{"no-props":Object(r["E"])(()=>[Object(r["h"])(" The selected object has no properties. ")]),"no-prop":Object(r["E"])(()=>[Object(r["h"])(" Select a single object to edit its properties. ")]),_:1},8,["property"])]),_:1}),Object(r["i"])(l,{name:"Problems",units:1},{default:Object(r["E"])(()=>[Object(r["i"])(c,{class:"validator-problems-pane"})]),_:1})]),_:1})}var Yt=i("1b79"),Kt=Object(r["k"])({name:"AccordionBox",data(){return{track:Object(r["o"])(new D["a"]),panes:[],activePane:0,onResizeObserver:null}},props:{collapseHeight:{type:Number,default:30}},computed:{boxStyle(){let e=this.panes.map(e=>e.activeHeight+this.collapseHeight+"px").join(" ");return{gridTemplateRows:e}}},methods:{onCollapse(e,t){this.panes[t].collapsed?this.uncollapsePane(t):this.collapsePane(t)},collapsePane(e){let t=this.panes;this.cacheHeights();let i=t.reduce((e,t)=>e+t.cachedHeight,0),r=this.getAvailableHeight(),s=i-t[e].cachedHeight;if(t[e].collapsed=!0,t[e].activeHeight=0,t[e].uncollapsedHeight=t[e].cachedHeight,s<r){let i=r-s,o=Math.min(i,t[e].cachedHeight);for(let e=t.length-1;0<=e;e--)if(!t[e].collapsed){t[e].activeHeight+=o;break}}this.cacheHeights()},uncollapsePane(e){let t=this.panes,i=t[e].uncollapsedHeight;this.cacheHeights();let r=t.reduce((e,t)=>e+t.cachedHeight,0),s=this.getAvailableHeight();0===r&&(t[e].activeHeight+=s,i-=Math.min(i,s));for(let o=t.length-1;0<=o;o--){if(t[o].collapsed)continue;let r=t[o].cachedHeight-t[o].minHeight,s=Math.min(r,i);t[o].activeHeight-=s,t[e].activeHeight+=s,i-=s}t[e].activeHeight=Math.max(t[e].activeHeight,t[e].minHeight),t[e].collapsed=!1,this.cacheHeights()},startDrag(e,t){this.cacheHeights(),this.activePane=t,this.track.capture(e,this.onDrag),document.addEventListener("pointerup",this.stopDrag,{once:!0})},onDrag(e,t){let i=this.panes;if(0!==t.movementY)if(i.forEach(e=>e.activeHeight=e.cachedHeight),t.deltaY<0){let e=-1;for(let t=this.activePane;t<i.length;t++)if(!i[t].collapsed){e=t;break}if(-1===e)return;let r=Math.abs(t.deltaY);for(let t=this.activePane-1;0<=t;t--){if(i[t].collapsed)continue;let e=i[t].cachedHeight-i[t].minHeight,s=Math.min(e,r);i[t].activeHeight=i[t].cachedHeight-s,r-=s}let s=Math.abs(t.deltaY)-r;i[e].activeHeight=i[e].cachedHeight+s}else{let e=-1;for(let t=this.activePane-1;0<=t;t--)if(!i[t].collapsed){e=t;break}if(-1===e)return;let r=t.deltaY;for(let t=this.activePane;t<i.length;t++){if(i[t].collapsed)continue;let e=i[t].cachedHeight-i[t].minHeight,s=Math.min(e,r);i[t].activeHeight=i[t].cachedHeight-s,r-=s}let s=t.deltaY-r;i[e].activeHeight=i[e].cachedHeight+s}},stopDrag(e){this.track.release(e),this.cacheHeights()},refit(){let e=this.panes,t=e.reduce((e,t)=>e+t.cachedHeight,0),i=this.getAvailableHeight();if(0!==t)if(t<=i){let r=e.map(e=>e.cachedHeight/t);for(let t=0;t<e.length;t++)e[t].activeHeight=i*r[t]}else{let r=e.reduce((e,t)=>e+(t.collapsed?0:t.minHeight),0),s=t-Math.max(r,i),o=t-r,n=0!==o?s/o:1;for(let t=0;t<e.length;t++){if(e[t].collapsed)continue;let i=(e[t].cachedHeight-e[t].minHeight)*n;e[t].activeHeight=e[t].cachedHeight-i}}},reset(){var e,t,i,r,s,o;if(!this.$slots.default)return;let n=[],a=[];for(let d of this.$slots.default())a.push(null!==(t=null===(e=d.props)||void 0===e?void 0:e.units)&&void 0!==t?t:1),n.push({minHeight:null!==(r=null===(i=d.props)||void 0===i?void 0:i.minHeight)&&void 0!==r?r:100,activeHeight:0,cachedHeight:0,uncollapsedHeight:0,collapsed:null!==(o=null===(s=d.props)||void 0===s?void 0:s.collapsed)&&void 0!==o&&o});let l=this.getAvailableHeight(),c=a.reduce((e,t)=>e+t);for(let d=0;d<n.length;d++){let e=n[d],t=l*(a[d]/c);e.cachedHeight=Math.max(e.minHeight,t)}this.panes=n,this.refit();for(let d=0;d<this.panes.length;d++)this.panes[d].collapsed&&this.collapsePane(d)},getAvailableHeight(){let e=this.$el.clientHeight;if(this.$slots.default){let t=this.$slots.default().length;return e-t*this.collapseHeight}return e},cacheHeights(){for(let e of this.panes)e.cachedHeight=e.activeHeight}},mounted(){this.onResizeObserver=new ResizeObserver(()=>this.refit()),this.onResizeObserver.observe(this.$el),this.reset()},unmounted(){this.onResizeObserver.disconnect()},render(){var e,t,i;let s=[];if(this.$slots.default){let o=this.$slots.default();for(let n=0;n<o.length;n++){let a=o[n],l=Object(r["m"])("div",{class:"accordion-box-handle",onPointerup:e=>this.stopDrag(e),onPointerdown:e=>this.startDrag(e,n)}),c=Object(r["m"])("div",{class:"accordion-box-head",style:{height:this.$props.collapseHeight+"px"},onClick:e=>this.onCollapse(e,n)},[Object(r["m"])(Yt["a"],{class:"collapse-arrow",collapsed:null===(e=this.panes[n])||void 0===e?void 0:e.collapsed}),Object(r["m"])("p",null===(t=a.props)||void 0===t?void 0:t.name.toLocaleUpperCase())]),d=Object(r["m"])("div",{class:"accordion-box-body"},a),h=Object(r["m"])("div",{class:["accordion-box",{collapsed:null===(i=this.panes[n])||void 0===i?void 0:i.collapsed}]},[l,c,d]);s.push(h)}}return Object(r["m"])("div",{class:"accordion-box-container",style:this.boxStyle},s)}});i("9a52");const Xt=ve()(Kt,[["__scopeId","data-v-39ee0bdf"]]);var Jt=Xt;const Zt={class:"accordion-pane-container"};function Qt(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",Zt,[Object(r["x"])(e.$slots,"default",{},void 0,!0)])}var ei=Object(r["k"])({name:"AccordionPane",props:{name:{type:String,required:!0},units:{type:Number,default:1},minHeight:{type:Number,default:100},collapsed:{type:Boolean,default:!1}}});i("c609");const ti=ve()(ei,[["render",Qt],["__scopeId","data-v-22255fa2"]]);var ii=ti;const ri={class:"object-editor-element"},si={key:1,class:"no-prop"},oi={key:1,class:"no-prop"};function ni(e,t,i,s,o,n){const a=Object(r["y"])("DictionaryFieldContents"),l=Object(r["y"])("ScrollBox");return Object(r["r"])(),Object(r["f"])("div",ri,[e.property?(Object(r["r"])(),Object(r["f"])(r["a"],{key:0},[e.hasEditableProperties?(Object(r["r"])(),Object(r["d"])(l,{key:0,alwaysShowScrollBar:!0,scrollColor:"#1f1f1f"},{default:Object(r["E"])(()=>[Object(r["i"])(a,{class:"contents",property:e.property,onChange:e.onChange,onCreate:e.onCreate,onDelete:e.onDelete},null,8,["property","onChange","onCreate","onDelete"])]),_:1})):(Object(r["r"])(),Object(r["f"])("p",si,[Object(r["x"])(e.$slots,"no-props",{},void 0,!0)]))],64)):(Object(r["r"])(),Object(r["f"])("p",oi,[Object(r["x"])(e.$slots,"no-prop",{},void 0,!0)]))])}var ai=i("6f01"),li=i("69ee"),ci=Object(r["k"])({name:"PropertyEditor",props:{property:{type:Object,default:void 0}},computed:{hasEditableProperties(){var e;if(!this.property)return!1;for(let t of this.property.value.values())if(null===(e=t.descriptor.is_visible)||void 0===e||e)return!0;return!1}},methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{onChange(e,t){switch(e.type){case d["u"].Int:case d["u"].Float:e instanceof d["q"]&&this.execute(new mt(e,t));break;case d["u"].String:e instanceof d["y"]&&this.execute(new vt(e,t));break;case d["u"].Date:e instanceof d["f"]&&this.execute(new bt(e,t));break;case d["u"].Enum:e instanceof d["l"]&&this.execute(new _t(e,t));break}},onCreate(e){switch(e.type){case d["u"].List:e instanceof d["o"]&&this.execute(new Ue(e));break}},onDelete(e,t){switch(e.type){case d["u"].List:e instanceof d["o"]&&this.execute(new Qe(e,t));break}}}),components:{ScrollBox:ai["a"],DictionaryFieldContents:li["a"]}});i("41de");const di=ve()(ci,[["render",ni],["__scopeId","data-v-5d47093b"]]);var hi=di;const ui=e=>(Object(r["t"])("data-v-511f70e2"),e=e(),Object(r["s"])(),e),pi={class:"validator-problems-element"},gi={class:"content"},yi=["onClick"],fi=ui(()=>Object(r["g"])("span",{class:"icon"},"",-1)),bi={class:"message"},_i=["onClick"],mi=ui(()=>Object(r["g"])("span",{class:"icon"},"",-1)),vi={class:"message"};function xi(e,t,i,s,o,n){const a=Object(r["y"])("ScrollBox");return Object(r["r"])(),Object(r["f"])("div",pi,[0<e.getValidationErrors.length||0<e.getValidationWarnings.length?(Object(r["r"])(),Object(r["d"])(a,{key:0,class:"scrollbox",alwaysShowScrollBar:!0,scrollColor:"#1f1f1f"},{default:Object(r["E"])(()=>[Object(r["g"])("div",gi,[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.getValidationErrors,t=>(Object(r["r"])(),Object(r["f"])("div",{class:"validation-result error",key:t,onClick:i=>e.focus(t.object)},[fi,Object(r["g"])("p",bi,Object(r["A"])(t.reason),1)],8,yi))),128)),(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["w"])(e.getValidationWarnings,t=>(Object(r["r"])(),Object(r["f"])("div",{class:"validation-result warning",key:t,onClick:i=>e.focus(t.object)},[mi,Object(r["g"])("p",vi,Object(r["A"])(t.reason),1)],8,_i))),128))])]),_:1})):Object(r["e"])("",!0)])}var wi=Object(r["k"])({name:"ValidatorProblems",computed:Object.assign(Object.assign({},Object(T["d"])("ApplicationStore",{ctx(e){return e},editor(e){return e.activePage}})),Object(T["b"])("ApplicationStore",["getValidationErrors","getValidationWarnings"])),methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{focus(e){let t=this.editor.page.lookup(e);t&&(this.execute(new st(this.editor.page)),this.execute(new rt(t)),this.execute(new lt(this.ctx,this.editor.page)))}}),components:{ScrollBox:ai["a"]}});i("6220");const ji=ve()(wi,[["render",xi],["__scopeId","data-v-511f70e2"]]);var Oi=ji,Si=Object(r["k"])({name:"EditorSidebar",computed:Object.assign(Object.assign(Object.assign({},Object(T["d"])("ApplicationStore",{page(e){return e.activePage.page}})),Object(T["b"])("ApplicationStore",["hasSelection","getSelection"])),{selected(){return 0===this.hasSelection?this.page.props:1===this.hasSelection?this.getSelection[0].props:void 0}}),components:{AccordionBox:Jt,AccordionPane:ii,PropertyEditor:hi,ValidatorProblems:Oi}});i("872d");const ki=ve()(Si,[["render",Wt],["__scopeId","data-v-09fcd1e8"]]);var Mi=ki;const Bi={None:0,Right:1};var Di=Object(r["k"])({name:"App",setup(){return{body:Object(r["v"])(null)}},data(){return{Handle:Bi,bodyWidth:-1,bodyHeight:-1,frameSize:{[Bi.Right]:325},minFrameSize:{[Bi.Right]:310},drag:{handle:Bi.None,track:Object(r["o"])(new D["a"])},onResizeObserver:null}},computed:Object.assign(Object.assign({},Object(T["d"])("ApplicationStore",{context(e){return e}})),{gridLayout(){let e=this.frameSize[Bi.Right];return{gridTemplateColumns:`minmax(0, 1fr) ${e}px`}}}),methods:Object.assign(Object.assign({},Object(T["c"])("ApplicationStore",["execute"])),{startResize(e,t){let i=this.frameSize[t];this.drag.handle=t,this.drag.track.capture(e,(e,t)=>{this.onResize(i,t)}),document.addEventListener("pointerup",this.stopResize,{once:!0})},onResize(e,t){switch(this.drag.handle){default:case Bi.None:break;case Bi.Right:this.setRightFrameSize(e-t.deltaX);break}},stopResize(e){this.drag.handle=Bi.None,this.drag.track.release(e)},setRightFrameSize(e){let t=this.bodyWidth,i=this.minFrameSize[Bi.Right];this.frameSize[Bi.Right]=Object(d["A"])(e,i,t)}}),created(){return Object(l["a"])(this,void 0,void 0,(function*(){let e;e=B.is_web_hosted?yield(yield fetch("./settings.json")).json():i("14d9"),this.execute(new I(this.context,e)),this.execute(yield H.fromNew(this.context))}))},mounted(){this.bodyWidth=this.body.clientWidth,this.bodyHeight=this.body.clientHeight,this.onResizeObserver=new ResizeObserver(()=>{this.bodyWidth=this.body.clientWidth,this.bodyHeight=this.body.clientHeight,this.setRightFrameSize(this.frameSize[Bi.Right])}),this.onResizeObserver.observe(this.body)},unmounted(){var e;null===(e=this.onResizeObserver)||void 0===e||e.disconnect()},components:{AppHotkeyBox:Ve,AppTitleBar:Be,BlockDiagram:Pt,AppFooterBar:Ut,EditorSidebar:Mi}});i("ddce");const Ti=ve()(Di,[["render",a]]);var Ci=Ti;const Pi={file:{image_export:{padding:0}},edit:{clone_offset:[0,0]},view:{diagram:{display_grid:!0,display_shadows:!0,display_debug_mode:!1,render_high_quality:!0,disable_shadows_at:0}},hotkeys:{file:{new_file:"",open_file:"",save_file:"",save_image:"",save_select_image:"",publish_file:"",open_library:"",save_library:""},edit:{undo:"",redo:"",cut:"",copy:"",paste:"",delete:"",duplicate:"",select_all:""},layout:{selection_to_front:"",selection_to_back:"",bring_selection_forward:"",send_selection_backward:"",align_left:"",align_center:"",align_right:"",align_top:"",align_middle:"",align_bottom:"",group:"",ungroup:"",open_group:"",close_group:""},view:{toggle_grid:"",toggle_shadows:"",reset_view:"",zoom_in:"",zoom_out:"",fullscreen:"",jump_to_selection:"",jump_to_parents:"",jump_to_children:"",toggle_debug_view:""},select:{many:""}}},Ei=B.publisher?new B.publisher:void 0,Ai=L.createDummy();var Li={namespaced:!0,state:{settings:Pi,clipboard:[],publisher:Ei,pages:new Map([[Ai.id,Ai]]),activePage:Ai},getters:{hasClipboardContents(e){return 0<e.clipboard.length},hasSelection(e){let t=[...e.activePage.page.getSubtree(e=>e.isSelected())];return(e.activePage.trigger.value,t).length},getSelection(e){let t=[...e.activePage.page.getSubtree(e=>e.isSelected())];return e.activePage.trigger.value,t},isValid(e){let t=e.activePage;return(e.activePage.trigger.value,t).isValid()},getValidationErrors(e){let t=e.activePage;return(e.activePage.trigger.value,t).getValidationErrors()},getValidationWarnings(e){let t=e.activePage;return(e.activePage.trigger.value,t).getValidationWarnings()}},mutations:{execute(e,t){if(t instanceof Ne){if(t.page===Ne.NullPage)return;let i=e.pages.get(t.page);if(!i)throw new Error(`'${t.page}' is not a page.`);i.execute(t)}else t.execute()}}},Hi={namespaced:!0,getters:{fileMenu(e,t,i){let r=i.ApplicationStore,s=[t.openFileMenu,t.saveFileMenu,r.publisher?t.publishFileMenu:null].filter(Boolean);return{text:"File",type:fe.Submenu,sections:s}},openFileMenu(e,t,i){let r=i.ApplicationStore,s=r.settings.hotkeys.file;return{id:"open_file_options",items:[{text:"New File",type:fe.Item,data:()=>H.fromNew(r),shortcut:s.new_file},{text:"Open File...",type:fe.Item,data:()=>H.fromFileSystem(r),shortcut:s.open_file}]}},saveFileMenu(e,t,i,r){let s=i.ApplicationStore,o=s.settings.hotkeys.file,n=s.activePage.page;return{id:"save_file_options",items:[{text:"Save",type:fe.Item,data:()=>new N(s,n.id),shortcut:o.save_file},{text:"Save as Image",type:fe.Item,data:()=>new R(s,n.id),shortcut:o.save_image},{text:"Save Selection as Image",type:fe.Item,data:()=>new $(s,n.id),shortcut:o.save_select_image,disabled:!r["ApplicationStore/hasSelection"]}]}},publishFileMenu(e,t,i,r){let s=i.ApplicationStore,o=s.settings.hotkeys.file,n=s.activePage.page;return{id:"publish_options",items:[{text:"Publish "+B.file_type_name,type:fe.Item,data:()=>new z(s,n.id),shortcut:o.publish_file,disabled:!r["ApplicationStore/isValid"]}]}},editMenu(e,t){return{text:"Edit",type:fe.Submenu,sections:[t.undoRedoMenu,t.clipboardMenu,t.deleteMenu,t.duplicateMenu,t.createMenu,t.selectAllMenu]}},undoRedoMenu(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.edit;return{id:"undo_redo_options",items:[{text:"Undo",type:fe.Item,data:()=>new wt(r,s.id),shortcut:o.undo,disabled:!r.activePage.canUndo()},{text:"Redo",type:fe.Item,data:()=>new ut(r,s.id),shortcut:o.redo,disabled:!r.activePage.canRedo()}]}},clipboardMenu(e,t,i,r){let s=i.ApplicationStore,o=s.activePage.page,n=s.settings.hotkeys.edit,a=s.clipboard.length,l=r["ApplicationStore/hasSelection"];return{id:"clipboard_options",items:[{text:"Cut",type:fe.Item,data:()=>new Ze(s,o),shortcut:n.cut,disabled:!l},{text:"Copy",type:fe.Item,data:()=>new P(s,o),shortcut:n.copy,disabled:!l},{text:"Paste",type:fe.Item,data:()=>new ht(s,o),shortcut:n.paste,disabled:!a}]}},deleteMenu(e,t,i,r){let s=i.ApplicationStore,o=s.activePage.page,n=s.settings.hotkeys.edit,a=r["ApplicationStore/hasSelection"];return{id:"delete_options",items:[{text:"Delete",type:fe.Item,data:()=>new Je(o),shortcut:n.delete,disabled:!a}]}},duplicateMenu(e,t,i,r){let s=i.ApplicationStore,o=s.activePage.page,n=s.settings.hotkeys.edit,a=r["ApplicationStore/hasSelection"];return{id:"duplicate_options",items:[{text:"Duplicate",type:fe.Item,data:()=>new tt(s,o),shortcut:n.duplicate,disabled:!a}]}},selectAllMenu(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.edit;return{id:"select_options",items:[{text:"Select All",type:fe.Item,data:()=>new ft(s),shortcut:o.select_all}]}},createMenu(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=[];for(let a of s.factory.getBlockTemplates())o.push({text:a.name,type:fe.Item,data:()=>new xt(r,s,a.id)});let n=[];for(let a of s.factory.getLineTemplates())n.push({text:a.name,type:fe.Item,data:()=>new xt(r,s,a.id)});return{id:"create_options",items:[{text:"Create",type:fe.Submenu,sections:[{id:"blocks",items:o},{id:"lines",items:n}]}]}},layoutMenu(e,t){return{text:"Layout",type:fe.Submenu,sections:[t.layeringMenu]}},layeringMenu(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.layout;return{id:"layering_options",items:[{text:"To Front",type:fe.Item,data:()=>new gt(s,ze.Top),shortcut:o.selection_to_front},{text:"To Back",type:fe.Item,data:()=>new gt(s,ze.Bottom),shortcut:o.selection_to_back},{text:"Bring Forward",type:fe.Item,data:()=>new gt(s,ze.OneAbove),shortcut:o.bring_selection_forward},{text:"Send Backward",type:fe.Item,data:()=>new gt(s,ze.OneBelow),shortcut:o.send_selection_backward}]}},viewMenu(e,t){return{text:"View",type:fe.Submenu,sections:[t.diagramViewMenu,t.diagramRenderMenu,t.zoomMenu,t.jumpMenu,t.fullscreenMenu,t.developerViewMenu]}},diagramViewMenu(e,t,i){let r=i.ApplicationStore,s=r.settings.hotkeys.view,{display_grid:o,display_shadows:n}=r.settings.view.diagram;return{id:"diagram_view_options",items:[{text:"Grid",type:fe.Toggle,data:()=>new Y(r),shortcut:s.toggle_grid,value:o,keepMenuOpenOnSelect:!0},{text:"Shadows",type:fe.Toggle,data:()=>new K(r),shortcut:s.toggle_shadows,value:n,keepMenuOpenOnSelect:!0}]}},diagramRenderMenu(e,t,i){let r=i.ApplicationStore,s=r.settings.view.diagram.render_high_quality;return{id:"diagram_render_quality",items:[{text:"Rendering – High Quality",type:fe.Toggle,data:()=>new G(r,!0),value:s,keepMenuOpenOnSelect:!0},{text:"Rendering – Fast",type:fe.Toggle,data:()=>new G(r,!1),value:!s,keepMenuOpenOnSelect:!0}]}},zoomMenu(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.view;return{id:"zoom_options",items:[{text:"Reset View",type:fe.Item,data:()=>new yt(r,s),shortcut:o.reset_view},{text:"Zoom In",type:fe.Item,data:()=>new St(r,s,.25),shortcut:o.zoom_in},{text:"Zoom Out",type:fe.Item,data:()=>new St(r,s,-.25),shortcut:o.zoom_out}]}},jumpMenu(e,t,i,r){let s=i.ApplicationStore,o=s.activePage.page,n=s.settings.hotkeys.view,a=r["ApplicationStore/hasSelection"];return{id:"jump_options",items:[{text:"Zoom to Selection",type:fe.Item,data:()=>new lt(s,o),shortcut:n.jump_to_selection,disabled:!a},{text:"Jump to Parents",type:fe.Item,data:()=>new at(s,o),shortcut:n.jump_to_parents,disabled:!a},{text:"Jump to Children",type:fe.Item,data:()=>new nt(s,o),shortcut:n.jump_to_children,disabled:!a}]}},fullscreenMenu(e,t,i){let r=i.ApplicationStore,s=r.settings.hotkeys.view;return{id:"fullscreen_options",items:[{text:"Fullscreen",type:fe.Item,data:()=>new U(r),shortcut:s.fullscreen}]}},developerViewMenu(e,t,i){let r=i.ApplicationStore,s=r.settings.hotkeys.view,{display_debug_mode:o}=r.settings.view.diagram;return{id:"developer_view_options",items:[{text:"Debug Mode",type:fe.Toggle,data:()=>new W(r),shortcut:s.toggle_debug_view,value:o,keepMenuOpenOnSelect:!0}]}},helpMenu(e,t,i){let r=i.ApplicationStore,s=B.help_links,o=s.map(e=>({text:e.text,type:fe.Item,data:()=>new F(r,e.url)}));return{text:"Help",type:fe.Submenu,sections:[{id:"help_links",items:o}]}}}},Ii={namespaced:!0,getters:{nativeHotkeys(){return[{shortcut:"Control+R",allowBrowserBehavior:!0},{shortcut:"Control+Shift+R",allowBrowserBehavior:!0}]},fileHotkeys(e,t,i,r){let s=i.ApplicationStore,o=s.activePage.page,n=s.settings.hotkeys.file,a=r["ApplicationStore/isValid"];return[{data:()=>H.fromNew(s),shortcut:n.new_file},{data:()=>H.fromFileSystem(s),shortcut:n.open_file},{data:()=>new N(s,o.id),shortcut:n.save_file},{data:()=>new R(s,o.id),shortcut:n.save_image},{data:()=>new $(s,o.id),shortcut:n.save_select_image},{data:()=>new z(s,o.id),shortcut:n.publish_file,disabled:!s.publisher||!a}]},editHotKeys(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.edit,n={delay:400,interval:50};return[{data:()=>new wt(r,s.id),shortcut:o.undo,repeat:n},{data:()=>new ut(r,s.id),shortcut:o.redo,repeat:n},{data:()=>new Ze(r,s),shortcut:o.cut},{data:()=>new P(r,s),shortcut:o.copy},{data:()=>new ht(r,s),shortcut:o.paste},{data:()=>new Je(s),shortcut:o.delete},{data:()=>new tt(r,s),shortcut:o.duplicate},{data:()=>new ft(s),shortcut:o.select_all}]},layoutHotkeys(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.layout;return[{data:()=>new gt(s,ze.Top),shortcut:o.selection_to_front},{data:()=>new gt(s,ze.OneBelow),shortcut:o.selection_to_back},{data:()=>new gt(s,ze.OneAbove),shortcut:o.bring_selection_forward},{data:()=>new gt(s,ze.Bottom),shortcut:o.send_selection_backward}]},viewHotkeys(e,t,i){let r=i.ApplicationStore,s=r.activePage.page,o=r.settings.hotkeys.view;return[{data:()=>new Y(r),shortcut:o.toggle_grid},{data:()=>new K(r),shortcut:o.toggle_shadows},{data:()=>new yt(r,s),shortcut:o.reset_view},{data:()=>new St(r,s,.25),shortcut:o.zoom_in},{data:()=>new St(r,s,-.25),shortcut:o.zoom_out},{data:()=>new lt(r,s),shortcut:o.jump_to_selection},{data:()=>new at(r,s),shortcut:o.jump_to_parents},{data:()=>new nt(r,s),shortcut:o.jump_to_children},{data:()=>new U(r),shortcut:o.fullscreen},{data:()=>new W(r),shortcut:o.toggle_debug_view}]}}},Fi=Object(T["a"])({modules:{ApplicationStore:Li,ContextMenuStore:Hi,HotkeyStore:Ii}});i("0da8"),i("2975");Object(r["c"])(Ci).use(Fi).mount("#app")},d288:function(e,t,i){},ddce:function(e,t,i){"use strict";i("1608")},e0ac:function(e,t,i){"use strict";var r=i("7a23");function s(e,t,i,s,o,n){return Object(r["r"])(),Object(r["f"])("div",{onPointerdown:t[0]||(t[0]=t=>e.$emit("focus")),class:"focus-box-container"},[Object(r["x"])(e.$slots,"default")],32)}var o=Object(r["k"])({name:"FocusBox",data(){return{onFocusOut:function(e){this.$el==e.target||this.$el.contains(e.target)||this.$emit("unfocus")}.bind(this)}},emits:["focus","unfocus"],mounted(){setTimeout(()=>{document.body.addEventListener("pointerdown",this.onFocusOut)},0)},unmounted(){document.body.removeEventListener("pointerdown",this.onFocusOut)}}),n=i("6b0d"),a=i.n(n);const l=a()(o,[["render",s]]);t["a"]=l},e16f:function(e,t,i){},ec4a:function(e,t,i){},ede2:function(e,t,i){},f0dd:function(e,t,i){},f636:function(e,t,i){},f9d8:function(e,t,i){}});
//# sourceMappingURL=app.ae1229f4.js.map